import{r as a,j as e}from"./react-0y0TMjPH.js";import{i as js}from"./i18next-C9BCMqqX.js";import{i as ys,u as L}from"./react-i18next-Cj8jRc02.js";import{R as vs}from"./react-dom-DuepeMfV.js";import{u as De,L as ws,a as Ae,b as Cs,O as Ss,N as nt,B as ks}from"./react-router-C5FnWpKf.js";import{H as Ps,a as de}from"./react-helmet-async-CfOZNsWd.js";import{u as Se,a as Pe,B as D,S as R,T as P,s as Ne,b as N,A as me,c as Q,D as ae,L as Ct,C as $s,F as ke,d as X,I as Te,e as U,f as fe,g as re,M as q,h as Ge,i as ne,P as be,j as $e,k as ye,l as Fs,m as ce,n as it,o as rt,p as Rs,q as Is,r as Ve,t as Os,v as Ts,w as Es,x as Ds,y as ue,z as Je,E as As,G as _e,H as te,J as Ns,K as pe,N as M,O as St,Q as kt,R as Pt,U as $t,V as Bs,W as Ft,X as Rt,Y as It,Z as Ot,_ as Ls,$ as Ws,a0 as ot,a1 as Fe,a2 as Us,a3 as zs,a4 as Ms,a5 as qs,a6 as Hs,a7 as Gs,a8 as Vs,a9 as at,aa as Js,ab as je}from"./@mui-DstKdecA.js";import{f as Ke,a as Ks,i as Ys,b as Zs,e as lt,c as Xs,d as Qs}from"./date-fns-D55auSU5.js";import{P as O}from"./prop-types-DbZxDtkw.js";import{n as en}from"./numeral-BcFNWGFB.js";import{A as Ye}from"./react-apexcharts-Bk9Uq_lg.js";import{T as tn,a as ct}from"./mui-tiptap-editor-DSYCiUGO.js";import"./@emotion-DHsFM_5h.js";import{C as sn}from"./react-material-ui-carousel-CxHPwi93.js";import{i as Tt,d as nn,_ as dt}from"./lodash-Ut1L3YWE.js";import{w as rn}from"./websocket-DmycC6Mv.js";import{c as on}from"./sha256-uint8array-DNUmUZDr.js";import{I as an}from"./@iconify-CCxzdQ0d.js";import{S as ln}from"./mui-color-input-CI6pG8ZQ.js";import{S as cn}from"./simplebar-react-NHSmGlUQ.js";import"./index-SjdquZsd.js";import"./use-sync-external-store-BWv41aIa.js";import"./scheduler-JQZBVqKX.js";import"./react-fast-compare-DWMO5ktf.js";import"./invariant-C4ZvFgAq.js";import"./shallowequal-lsI3Sh_b.js";import"./clsx-B-dksMZM.js";import"./react-transition-group-CXfzJOIs.js";import"./@babel-B5c2X20U.js";import"./@popperjs-B_2vCoY7.js";import"./react-is-Rj29YxKv.js";import"./apexcharts-Dt_f9Qlw.js";import"./@tiptap-CATLvD8O.js";import"./prosemirror-state-BLwXW4Ka.js";import"./prosemirror-model-CRZLy2j9.js";import"./orderedmap-C4TimWWB.js";import"./prosemirror-transform-C09io-ca.js";import"./tippy.js-T2NbCdtq.js";import"./linkifyjs-DVrXeg1a.js";import"./prosemirror-view-CBcoWX2f.js";import"./prosemirror-tables-Db2HToAo.js";import"./prosemirror-keymap-CKVplV9_.js";import"./w3c-keyname-DEtA-KhA.js";import"./prosemirror-dropcursor-3jZb0A5n.js";import"./prosemirror-gapcursor-CsD_MK6O.js";import"./prosemirror-history-CP70DM9h.js";import"./rope-sequence-Cxv9J64N.js";import"./prosemirror-commands-CQrOMeus.js";import"./prosemirror-schema-list-cRCmABXK.js";import"./lowlight-CKerfWIg.js";import"./highlight.js-zs_0r-Pv.js";import"./hoist-non-react-statics-BTNdDy0I.js";import"./stylis-BqmD5Vow.js";import"./framer-motion-Dwg0l9Ek.js";import"./tslib-H4WKM-B6.js";import"./hey-listen-C7trtNGA.js";import"./style-value-types-BvDThebE.js";import"./popmotion-DD-FLiDx.js";import"./framesync-BEUTIEb0.js";import"./es5-ext-B-aRoSt4.js";import"./simplebar-core-Dgrngn7n.js";import"./lodash-es-BFDc8I3u.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var mo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fo(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function bo(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var s=t.default;if(typeof s=="function"){var n=function i(){var r=!1;try{r=this instanceof i}catch{}return r?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};n.prototype=s.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}const dn={English:"English",Spanish:"Spanish",German:"German",_consumption_:"Current Consumption",_perShelly_:"per Shelly",Running:"Running",Connected:"Connected",_welcome_:"Welcome back 游녦",Filters:"Filters",_sortby_:"Sort by",Submit:"Submit",Clear:"Clear",Alias:"Alias",Model:"Model",Generation:"Generation",_byminute_:"By Minute",_byhour_:"By Hour",_byday_:"By Day",_bymonth_:"By Month",_byyear_:"By Year",_notconnected_:"Disconnected!",_getinvolved_:"Get involved!",_gotogithub_:"Go to Github",_opensource_:"Open Source AGPL License",Home:"Home",Profile:"Profile",Security:"Security",Settings:"Settings",Logout:"Logout",_forgotpw_:"Forgot Password?",_wrongpw_:"Wrong Password!",_usernotexists_:"EMail not found!",_resetpw_:"Password was reset.",_notresetpw_:"Password was not reset.",Password:"Password",Email:"Email",Firstname:"Firstname",Lastname:"Lastname",Role:"Role",_newuser_:"New User",_editprofile_:"Your Profile",_edituserprofile_:"Edit User",_editsecurity_:"Your Access",_editsettings:"Your Settings",_searchuser_:"Search User",Users:"Users",_rowsperpage_:"Rows per page:",of:"of",_morethan_:"more than",Login:"Login",Save:"Save",_userupdated_:"User was updated",_usernotupdated_:"Could not update user",_usercreated_:"User was created",_usernotcreated_:"Could not create user",_blogpostcreated_:"Post was saved",_blogpostnotcreated_:"Could not save post",_blogpostupdated_:"Post was updated",_blogpostnotupdated_:"Could not update post",Delete:"Delete",Edit:"Edit",_reallydelete_:"Really Delete?",_userdeleted_:"User deleted",_usernotdeleted:"Couldn't delete user",_emailexists_:"Email already exists",_aliasexists_:"Alias already exists",Read:"Read",Unread:"Unread",Notifications:"Notifications",_unreadmessages_:"You have {{totalUnRead}} new messages",_markallasread_:"Mark all as read",Brightness:"Brightness",White:"White",Control:"Controls",_newpost_:"New Post",Title:"Title",Content:"Content",_editpost_:"Edit Post","_editor-preview_":"Preview","_editor-bold_":"Bold","_editor-italic_":"Italic","_editor-strike_":"Strikethrough","_editor-underline_":"Underline","_editor-link_":"Link","_editor-bulletlist_":"Bullet List","_editor-orderedlist_":"Ordered List","_editor-alignleft_":"Align left","_editor-aligncenter_":"Align Center","_editor-alignright_":"Align Right","_editor-alignjustify_":"Align Justify","_editor-blockquote_":"Blockquote","_editor-codeblock_":"Codeblock","_editor-undo_":"Undo","_editor-redo_":"Redo","_editor-normaltext_":"Normal","_editor-h1_":"Heading1","_editor-h2_":"Heading2","_editor-h3_":"Heading3","_editor-h4_":"Heading4","_editor-h5_":"Heading5","_editor-h6_":"Heading6","_editor-insertlink_":"Insert Link","_editor-invalidlink_":"Invalid Link","_editor-color_":"Text Color","_editor-placeholder_":"Write your post",_notfound_:"Not found",_noresultsfor_:"No results found for",selected:"selected",_assigndevices_:"Shelly assingment",_devicesupdated_:"Assignment saved",_devicesnotupdated:"Error saving Assignment",_firmwarestable_:"Update to stable Version",_firmwarebeta_:"Update to Beta Version",Reboot:"Reboot",Name:"Name",Uptime:"Uptime",_betapending_:"Beta pending",_stablepending_:"Stable pending",_rebootpending_:"Reboot pending",_required_:"requiered",_notrequired_:"not required",_wifiupdated_:"Successfully updated WiFi settings ({{successful}} of {{total}})",_wifinotupdated_:"Could not update all ({{successful}} of {{total}})",_wifiwarming_:"Warning: Changing WiFi settings can disconnect the device!",_acceptrisk_:"I accept the risk",_updateavailable_:"Only {{checked}} of {{selected}} need an {{type}} update",_noupdateavailable_:"No {{type}} updates available for the selected devices"},un={translation:dn},pn={English:"Englisch",Spanish:"Spanisch",German:"Deutsch",_consumption_:"Aktueller Verbrauch",_perShelly_:"per Shelly",Running:"Laufen",Connected:"Verbunden",_welcome_:"Willkommen zur칲ck 游녦",Filters:"Filter",_sortby_:"Sortierung",Submit:"Anwenden",Clear:"L칬schen",Alias:"Alias",Model:"Model",Generation:"Generation",_byminute_:"Per Minute",_byhour_:"Per Stunde",_byday_:"Per Tag",_bymonth_:"Per Monat",_byyear_:"Per Jahr",_notconnected_:"Getrennt!",_getinvolved_:"Helf mit!",_gotogithub_:"Besuch das Github Projekt",_opensource_:"Open Source AGPL Lizenz",Home:"Home",Profile:"Profil",Security:"Sicherheit",Settings:"Einstellungen",Logout:"Logout",_forgotpw_:"Passwort vergessen?",_wrongpw_:"Falsches Passwort!",_usernotexists_:"Email nicht gefunden!",_resetpw_:"Passwort wurde zur칲ck gesetzt.",_notresetpw_:"Passwort wurde nicht zur칲ck gesetzt.",Password:"Passwort",Email:"Email",Firstname:"Vorname",Lastname:"Nachname",Role:"Rolle",_newuser_:"Neuer Benutzer",_editprofile_:"Dein Profil",_edituserprofile_:"Benutzer bearbeiten",_editsecurity_:"Deine Zugangsdaten",_editsettings:"Deine Einstellungen",_searchuser_:"Benutzer suchen",Users:"Benutzer",_rowsperpage_:"Zeilen per Seite:",of:"von",_morethan_:"mehr als",Login:"Anmelden",Save:"Speichern",_userupdated_:"User aktualisiert",_usernotupdated_:"Fehler bei der Aktualisierung ",_usercreated_:"Benutzer wurde angelegt",_usernotcreated_:"Benutzer konnte nicht angelegt werden",_blogpostcreated_:"Post wurde gespeichert",_blogpostnotcreated_:"Post konnte nicht gespeichert werden",_blogpostupdated_:"Post wurde aktualisiert",_blogpostnotupdated_:"Fehler bei der Aktualisierung",Delete:"L칬schen",Edit:"Bearbeiten",_reallydelete_:"Wirklich L칬schen?",_userdeleted_:"Benutzer wurde gel칬scht",_usernotdeleted:"Benutzer konnte nicht gel칬scht werden",_emailexists_:"Email existiert bereits",_aliasexists_:"Alias existiert bereits",Read:"Gelesen",Unread:"Ungelesen",Notifications:"Nachrichten",_unreadmessages_:"Du hast {{totalUnRead}} neue Meldungen",_markallasread_:"Alle als gelesen markieren",Brightness:"Helligkeit",White:"Wei",Control:"Einstellung",_newpost_:"Neuer Post",Title:"Titel",Content:"Inhalt",_editpost_:"Post bearbeiten","_editor-preview_":"Vorschau","_editor-bold_":"Fett","_editor-italic_":"Kursiv","_editor-strike_":"Durchgestrichen","_editor-underline_":"Unterstrichen","_editor-link_":"Link","_editor-bulletlist_":"Aufz칛hlung","_editor-orderedlist_":"Numerierung","_editor-alignleft_":"Links Ausrichten","_editor-aligncenter_":"Mittig Ausrichten","_editor-alignright_":"Rechts Ausrichten","_editor-alignjustify_":"Gleichm칛ig Ausrichten","_editor-blockquote_":"Zitat","_editor-codeblock_":"Codeblock","_editor-undo_":"Zur칲ck","_editor-redo_":"Wiederherstellen","_editor-normaltext_":"Normal","_editor-h1_":"칖berschrift1","_editor-h2_":"칖berschrift2","_editor-h3_":"칖berschrift3","_editor-h4_":"칖berschrift4","_editor-h5_":"칖berschrift5","_editor-h6_":"칖berschrift6","_editor-insertlink_":"Link Einf칲gen","_editor-invalidlink_":"Ung칲ltiger Link","_editor-color_":"Textfarbe","_editor-placeholder_":"Schreib deinen Post",_notfound_:"Nicht gefunden",_noresultsfor_:"Keine Resultate gefunden f칲r",selected:"ausgew칛hlt",_assigndevices_:"Shelly zuordnen",_devicesupdated_:"Zuordnung gespeichert",_devicesnotupdated:"Fehler bei der Zuordnung",_firmwarestable_:"Aktualisiere auf stablile Version",_firmwarebeta_:"Aktualisiere auf Beta Version",Reboot:"Neustart",Name:"Name",Uptime:"Laufzeit",_betapending_:"Beta ausstehend",_stablepending_:"Stable ausstehend",_rebootpending_:"Neustart ausstehend",_required_:"notwendig",_notrequired_:"nicht notwendig",_wifiupdated_:"WiFi settings erfolgreich aktualisiert ({{successful}} von {{total}})",_wifinotupdated_:"Nicht alle aktualisiert ({{successful}} von {{total}})",_wifiwarming_:"Achtung: Das 츿ndern der WiFi Einstellungen kann das Ger칛t trennen!",_acceptrisk_:"Ich akzeptiere das Risiko",_updateavailable_:"Nur {{checked}} von {{selected}} werden auf {{type}} aktualisiert.",_noupdateavailable_:"Keine {{type}} Updates f칲r die ausgew칛hlten Ger칛te verf칲gbar"},hn={translation:pn},xn={English:"Ingl칠s",Spanish:"Espa침ol",German:"Aleman",_consumption_:"Consumo Actual",_perShelly_:"por Shelly",Running:"Corriendo",Connected:"Connectado",_welcome_:"Bienvenido de nuevo 游녦",Filters:"Filtrar",_sortby_:"Clasificaci칩n",Submit:"Entregar",Clear:"Borrar",Alias:"Alias",Model:"Modelo",Generation:"Generaci칩n",_byminute_:"por Minuto",_byhour_:"por Hora",_byday_:"por Dia",_bymonth_:"por Mes",_byyear_:"por A침o",_notconnected_:"Desconnectado!",_getinvolved_:"Participar!",_gotogithub_:"Ir a Github",_opensource_:"Open Source AGPL Licencia",Home:"Home",Profile:"Perfil",Security:"Securidad",Settings:"Ajustes",Logout:"Cerrar sesi칩n",_forgotpw_:"Contrase침a olvidado?",_wrongpw_:"Contrase침a incorrecto!",_usernotexists_:"Correo electr칩nico incorrecto!",_resetpw_:"Contrase침a restablecida.",_notresetpw_:"Contrase침a no esta restablecida.",Password:"Contrase침a",Email:"Correo electr칩nico",Firstname:"Nombre",Lastname:"Apellido",Role:"Rol",_newuser_:"Nuevo Usuario",_editprofile_:"Tu Perfil",_edituserprofile_:"Editar usuario",_editsecurity_:"Tu Acceso",_editsettings:"Tu Adjusto",_searchuser_:"Busca Usuario",Users:"Usuarios",_rowsperpage_:"Filas por p치gina:",of:"de",_morethan_:"mas de",Login:"Acceso",Save:"Guardar",_userupdated_:"Usuario actualizada",_usernotupdated_:"No pudo actualizar el usuario",_usercreated_:"Usario creado",_usernotcreated_:"No se pudo crear el usuario",_blogpostcreated_:"Post creado",_blogpostnotcreated_:"No se pudo crear el post",_blogpostupdated_:"Post actualizada",_blogpostnotupdated_:"No pudo actualizar el post",Delete:"Borrar",Edit:"Editar",_reallydelete_:"Realmente Borrar?",_userdeleted_:"Usuario eliminado",_usernotdeleted:"No se pudo eliminar el usuario",_emailexists_:"El correo electr칩nico ya existe",_aliasexists_:"Alias ya existe",Read:"Ya le칤",Unread:"No le칤do",_unreadmessages_:"Tienes {{totalUnRead}} nuevos mensajes",_markallasread_:"Marcar todo como le칤do",Brightness:"Brillo",White:"Blanco",Control:"Ajustes",_newpost_:"Nuevo Post",Title:"Titulo",Content:"Contenido",_editpost_:"Editar Post","_editor-preview_":"Previsi칩n","_editor-bold_":"Gordo","_editor-italic_":"It치lico","_editor-strike_":"Tachado","_editor-underline_":"Testado","_editor-link_":"Enlace","_editor-bulletlist_":"Enumeraci칩n","_editor-orderedlist_":"Numeraci칩n","_editor-alignleft_":"Alinear Izquierda","_editor-aligncenter_":"Alinear Central","_editor-alignright_":"Alinear Derecha","_editor-alignjustify_":"Alinear Igualmente","_editor-blockquote_":"Cita","_editor-codeblock_":"Codeblock","_editor-undo_":"Atr치s","_editor-redo_":"Rehacer","_editor-normaltext_":"Normal","_editor-h1_":"Sobrescritura1","_editor-h2_":"Sobrescritura2","_editor-h3_":"Sobrescritura3","_editor-h4_":"Sobrescritura4","_editor-h5_":"Sobrescritura5","_editor-h6_":"Sobrescritura6","_editor-insertlink_":"Entrar Enlace","_editor-invalidlink_":"Enlace Invalido","_editor-color_":"Color del texto","_editor-placeholder_":"Escribir tu post",_notfound_:"No encontrado",_noresultsfor_:"No se encontraron resultados para",selected:"seleccionado",_assigndevices_:"Relacionar Shelly",_devicesupdated_:"Relacion guardada",_devicesnotupdated:"Error al guardar",_firmwarestable_:"Actualizar a la versi칩n estable",_firmwarebeta_:"Actualizar a la versi칩n beta",Reboot:"Reanudar",Name:"Nombre",Uptime:"Duraci칩n",_betapending_:"Beta pendiente",_stablepending_:"Stable pendiente",_rebootpending_:"Reboot pendiente",_required_:"necesario",_notrequired_:"no es necesario",_wifiupdated_:"Configuraci칩n WiFi actualizada ({{successful}} de {{total}})",_wifinotupdated_:"No todos eran actualizadas ({{successful}} de {{total}})",_wifiwarming_:"Advertencia: 춰Cambiar la configuraci칩n de WiFi puede desconectar el dispositivo!",_acceptrisk_:"Accepto el riesgo",_updateavailable_:"Solo {{checked}} de {{selected}} dispositivos necesita actualizaci칩n {{type}}",_noupdateavailable_:"No hay {{type}} actualizaciones para los dispositivos seleccionados"},gn={translation:xn},Ie=[{value:"en",label:"English"},{value:"de",label:"German"},{value:"es",label:"Spanish"}],mn=()=>{const t=localStorage.getItem("i18nLanguage");if(t!==null)return console.log(`Using last selected language ${t}`),t;if(typeof navigator.language<"u"){const s=navigator.language.substring(0,2);if(typeof Ie.find(n=>n.value===s)<"u")return console.log(`Using browser language ${s}`),navigator.language.substring(0,2)}return console.log("Using browser language en"),"en"};js.use(ys).init({resources:{en:{...un},de:{...hn},es:{...gn}},lng:mn()});const fn="modulepreload",bn=function(t){return"/"+t},ut={},he=function(s,n,i){let r=Promise.resolve();if(n&&n.length>0){let h=function(d){return Promise.all(d.map(x=>Promise.resolve(x).then(c=>({status:"fulfilled",value:c}),c=>({status:"rejected",reason:c}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");r=h(n.map(d=>{if(d=bn(d),d in ut)return;ut[d]=!0;const x=d.endsWith(".css"),c=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${c}`))return;const p=document.createElement("link");if(p.rel=x?"stylesheet":fn,x||(p.as="script"),p.crossOrigin="",p.href=d,u&&p.setAttribute("nonce",u),document.head.appendChild(p),x)return new Promise((f,_)=>{p.addEventListener("load",f),p.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return r.then(l=>{for(const u of l||[])u.status==="rejected"&&o(u.reason);return s().catch(o)})},Ue=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),m=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,t=>(+t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+t/4).toString(16)),ie=(t,s)=>t<s?t:t%s===0?s:t%s;function pt(t){return on().update(t).digest("hex")}function _n(t,s,n,i){if(typeof n>"u"||n==="")throw new Error("Failed to authenticate!  Please supply a password!");if(typeof s>"u"||s.auth_type!=="digest")throw new Error("The message contains no authentication information");const r={nonce:t.nonce,nc:s.nc,realm:s.realm,algorithm:s.algorithm};return jn(r,n,i)}function jn(t,s,n){t.username=n,t.cnonce=String(Math.floor(Math.random()*1e9));let i=pt(`${t.username}:${t.realm}:${s}`);return i+=`:${t.nonce}`,i+=`:1:${t.cnonce}`,t.response=pt(i),t}const Et=(t,s)=>{typeof document<"u"&&document.addEventListener(t,s)},Dt=(t,s)=>{typeof document<"u"&&document.removeEventListener(t,s)},le=(t,s)=>{const n=new CustomEvent(t,{detail:s});typeof document<"u"&&document.dispatchEvent(n)},ze=[{ip:"192.168.68.20",cname:"Test",password:"test",online:!0,name:"PlusRGBWPM",gen:2,fw_id:"20250924-062733/1.7.1-gd336f31",id:"shellyplusrgbwpm-30c92257d20c",image:"/assets/images/devices/PlusRGBWPM.png",wsmessages:{NotifyStatus:{src:"shellyplusrgbwpm-30c92257d20c",dst:"ws",method:"NotifyStatus",params:{ts:1763563860,"rgbw:0":{aenergy:{by_minute:[0,0,0],minute_ts:1763563860,total:3102}}}},NotifyEvent:{src:"shellyplusrgbwpm-30c92257d20c",dst:"ws",method:"NotifyEvent",params:{ts:176356359465e-2,events:[{component:"sys",event:"scheduled_restart",time_ms:997,ts:176356359465e-2}]}},NotifyFullStatus:{src:"shellyplusrgbwpm-30c92257d20c",dst:"request",method:"NotifyFullStatus",params:{ble:{},cloud:{connected:!0},"input:0":{id:0,state:null},"input:1":{id:1,state:null},"input:2":{id:2,state:null},"input:3":{id:3,state:null},mqtt:{connected:!1},plusrgbwpm:{},"rgbw:0":{id:0,source:"init",output:!1,rgb:[255,255,255],brightness:10,white:0,temperature:{tC:48.2,tF:118.7},aenergy:{total:3102,by_minute:[0,0,0],minute_ts:1763563800},apower:0,current:0,voltage:24.6},"script:1":{id:1,running:!0,mem_used:784,mem_peak:1652,mem_free:22974,cpu:0},"script:2":{id:2,running:!0,mem_used:1414,mem_peak:3192,mem_free:22974,cpu:0},sys:{mac:"30C92257D20C",restart_required:!1,time:"15:50",unixtime:1763563834,last_sync_ts:1763563717,uptime:121,ram_size:249200,ram_free:119908,ram_min_free:112248,fs_size:393216,fs_free:98304,cfg_rev:255,kvs_rev:4,schedule_rev:0,webhook_rev:0,btrelay_rev:0,available_updates:{},reset_reason:4,utc_offset:3600},wifi:{sta_ip:"192.168.68.20",status:"got ip",ssid:"Tropired2709",bssid:"32:16:9d:2f:f7:ca",rssi:-47},ws:{connected:!0},ts:1763563833}}},scripts:[{id:1,name:"Example",enable:!0,running:!0,logmessages:[{ts:1763563688,msg:"Looks like with Firmware 1.7.0 messages without prefix can also be captured\0"},{ts:1763563744,msg:"Example (#1): Please participate and help the project become better!\0"},{ts:1763563744,msg:"Looks like with Firmware 1.7.0 messages without prefix can also be captured\0"},{ts:1763563774,msg:"Example (#1): Please participate and help the project become better!\0"},{ts:1763563774,msg:"Looks like with Firmware 1.7.0 messages without prefix can also be captured\0"},{ts:1763563804,msg:"Example (#1): Please participate and help the project become better!\0"},{ts:1763563804,msg:"Looks like with Firmware 1.7.0 messages without prefix can also be captured\0"},{ts:1763563834,msg:"Example (#1): Please participate and help the project become better!\0"},{ts:1763563834,msg:"Looks like with Firmware 1.7.0 messages without prefix can also be captured\0"},{ts:1763563864,msg:"Example (#1): Please participate and help the project become better!\0"},{ts:1763563864,msg:"Looks like with Firmware 1.7.0 messages without prefix can also be captured\0"}]},{id:2,name:"Watchdog",enable:!0,running:!0,logmessages:[{ts:1763563864,msg:'Watchdog (#2): result: {"id":1,"running":true,"mem_used":784,"mem_peak":1652,"mem_free":22610,"cpu":0}\0'},{ts:1763563864,msg:"Watchdog (#2): error_code: 0\0"},{ts:1763563864,msg:"Watchdog (#2): error_message:\0"},{ts:1763563864,msg:'Watchdog (#2): userdata: {"report":true,"error_msg":"Could not get the status of Script Example","success_msg":"Successfully got\0'},{ts:1763563864,msg:'the status of Script Example","sScriptname":"Example","nScriptIndex":0,"nID":1,"sIP":"192.168.68.20"}\0'},{ts:1763563864,msg:"Watchdog (#2): Successfully got the status of Script Example\0"},{ts:1763563864,msg:"Script 'Example' is running"}]}],kvs:[{key:"ClimateControl",value:"1",display:"Klimakontrolle",style:"color"}],switches:[{deviceIp:"192.168.68.20",deviceId:"shellyplusrgbwpm-30c92257d20c",key:"rgbw:0",id:0,output:!1,brightness:10,white:0,rgb:[255,255,255]}]}],At=a.createContext(),K=()=>a.useContext(At),yn=({children:t})=>{const[s,n]=a.useState(JSON.parse(localStorage.getItem("user"))),[i,r]=a.useState([]),[o,l]=a.useState(null),[u,h]=a.useState(!1),[d,x]=a.useState(.001),c=a.useRef(null),p=a.useRef({}),f=a.useRef({}),_=a.useRef(!1),C=a.useRef(null),j=a.useRef({event:"user reconnect",data:{name:"Shelly Context",channelID:`sc${m()}`,message:"Hello from Shelly Context",user:s}}),y=a.useRef(["user validate","blogposts get public","user resetpw"]),w=a.useCallback((F,g)=>{j.current.data.user!==null&&(g&&(F=.001),_.current=!0,setTimeout(()=>{if(c.current!==null&&c.current.readyState===WebSocket.OPEN){_.current=!1;return}if(F>window.scconfig.RECONNECT_MAX){_.current=!1,console.log("Reconnecting makes no sense! Please reload Page"),le("lastUpdatedAt",null);return}console.log(`Trying to reconnect: ${F}`),x(F+1),w(F+1,!1)},F*window.scconfig.RECONNECT_DELAY*1e3))},[]),b=(F,g)=>{g.forEach(k=>{typeof p.current[k]>"u"?p.current[k]=[F]:p.current[k].push(F)})},T=(F,g)=>{g.forEach(k=>{typeof p.current[k]<"u"&&(p.current[k]=p.current[k].filter(B=>B.subscriptionID!==F))})},I=a.useCallback(F=>{const g=!y.current.includes(F.event);if(g&&(F.data.secret=C.current),c.current!==null&&c.current.readyState===WebSocket.OPEN&&(!g||C.current!==null))c.current.send(JSON.stringify(F));else{const k=m();f.current[k]={msg:F,undefined:void 0},_.current||w(d,!0)}},[w,d]),S=a.useCallback((F,g)=>{if(F.event==="user validate")h(F.data.isTest),l({msg:F,callback:g});else{const B=m();F.data.requestID=B,f.current[B]={msg:F,callback:g}}const k=!y.current.includes(F.event);k&&(F.data.secret=C.current),c.current!==null&&c.current.readyState===WebSocket.OPEN&&(!k||C.current!==null)?c.current.send(JSON.stringify(F)):!_.current&&(c.current===null||c.current.readyState!==WebSocket.OPEN)&&w(d,!0)},[w,d]),E=a.useCallback(F=>{n(F),j.current.data.user=F,console.log(`Connecting the logged in user '${F.alias}'`),c.current.send(JSON.stringify(j.current))},[]),$=a.useCallback(()=>{n(null)},[]);return a.useEffect(()=>{s!==null?localStorage.setItem("user",JSON.stringify(s)):(localStorage.removeItem("user"),j.current.data.user=null,r([]))},[s]),a.useEffect(()=>{if(c.current===null||_&&c.current.readyState!==WebSocket.OPEN){le("lastUpdatedAt","connecting");const F=window.scconfig.WSSURL;console.log(`Creating websocket connection to ${F}`),c.current=new rn.w3cwebsocket(F)}c.current.onerror=F=>console.error(F),c.current.onopen=()=>{_.current=!1,le("lastUpdatedAt",Date.now()),console.log("WebSocket connection opened for Shelly Context!"),o!==null?(console.log("Sending an existing validation request"),c.current.send(JSON.stringify({event:"user validate",data:{source:o.msg.data.source,message:o.msg.data.message,user:{email:o.msg.data.user.email}}}))):j.current.data.user!==null&&(console.log(`Reconnecting the previously logged in user '${j.current.data.user.alias}'`),c.current.send(JSON.stringify(j.current))),Object.entries(f.current).forEach(F=>{const[g,k]=F;if(y.current.includes(k.msg.event)){console.log(`Sending '${k.msg.event}' after opening the websocket`);try{c.current.send(JSON.stringify(k.msg))}catch(B){console.error(B)}}typeof k.callback>"u"&&delete f[g]})},c.current.onmessage=F=>{le("lastUpdatedAt",Date.now());const g=JSON.parse(F.data);if(g!==null)if(g.event==="user validate")o!==null&&typeof g.data.error<"u"&&g.data.error.code===401?(o.msg.data.auth=_n(g.data.error,g.data.error.message,o.msg.data.user.password,o.msg.data.user.email),delete o.msg.data.user.password,delete o.msg.data.error,c.current.send(JSON.stringify(o.msg))):(C.current=g.data.secret,delete g.data.secret,o.callback(g),l(null),console.log(`Deleted the 'user validate' request. Now have ${Object.entries(f.current).length} requests left`));else if(g.event==="user reconnect")if(typeof g.data.secret<"u"){const k=j.current.data.user;console.log(`Just reconnected with user ${k.alias}. There are ${Object.entries(f.current).length} outstanding requests`),C.current=g.data.secret,u?(r(ze),console.log(`Test mode active. Using ${ze.length} test devices`)):(console.log(`Requesting devices of user ${k.alias}.`),c.current.send(JSON.stringify({event:"devices get all",data:{source:"Shelly Context",message:"Shelly Context needs the list of devices",userid:k.roleid!=1?k.userid:null,secret:C.current}}))),Object.entries(f.current).forEach(B=>{const[Y,ee]=B;y.current.includes(g.event)||(ee.msg.data.secret=C.current),console.log(`Sending '${ee.msg.event}' after reconnecting`),c.current.send(JSON.stringify(ee.msg)),typeof ee.callback>"u"&&delete f[Y]})}else console.error("Reconnecting was not possible. Logging out!"),$();else if(g.event==="devices get all"&&typeof g.data.requestID>"u")console.log(`Context received ${g.data.devices.length} devices for user ${s.alias}`),r(g.data.devices);else if(g.event==="ping")c.current.send(JSON.stringify({event:"pong",data:{source:"SC Context",message:g.data.message}}));else if(typeof g.data.requestID<"u"&&typeof f.current[g.data.requestID]<"u"){u&&g.event==="device get"&&(g.data.device=ze[0]);const k=g.data.requestID;delete g.data.requestID,f.current[k].callback(g),delete f.current[k],console.log(`Deleted request '${g.event}' on answer: '${g.data.message}'. Now have ${Object.entries(f.current).length} requests`)}else typeof g.event<"u"?typeof p.current[g.event]<"u"&&p.current[g.event].forEach(k=>{(k.all||g.data.subscriptionID===k.subscriptionID)&&k.callback(g)}):console.error(`Shelly context received an unhandled message ${JSON.stringify(g)} `)},c.current.onclose=F=>{_.current?le("lastUpdatedAt",null):(le("lastUpdatedAt","connecting"),w(d,!0)),c.current?console.log(`WebSocket connection closed by the server for SC Context. Reason: ${F.reason}!`):console.log(`WebSocket connection closed because SC Context was unmounted. Reason: ${F.reason}!`)}},[o,w,d,$]),e.jsx(At.Provider,{value:a.useMemo(()=>({user:s,devices:i,login:E,logout:$,subscribe:b,unsubscribe:T,request:S,send:I}),[s,i,E,$,S,I]),children:t})};function Nt(){const{pathname:t}=De();return a.useMemo(()=>t,[t])}const Bt=a.forwardRef(({href:t,...s},n)=>e.jsx(ws,{ref:n,to:t,...s}));function Ze(t,s,n){const i=Se(),r=Pe(i.breakpoints.up(s));return Pe(i.breakpoints.down(s)),Pe(i.breakpoints.between(s,n)),Pe(i.breakpoints.only(s)),r}const Be=({disabledLink:t=!1,sx:s})=>{const n=e.jsx(D,{component:"img",src:"/assets/logo.svg",sx:{width:40,height:40,...s}});return t?n:e.jsxs(R,{direction:"row",spacing:2,sx:{justifyContent:"flex-start",alignItems:"center"},children:[e.jsx(D,{sx:{display:"contents"},children:n}),e.jsx(P,{variant:"h6",sx:{pt:3},children:"S-Central"})]})},vn=Ne("div")(()=>({flexGrow:1,height:"100%",overflow:"hidden"})),wn=Ne(cn)(({theme:t})=>({maxHeight:"100%","& .simplebar-scrollbar":{"&:before":{backgroundColor:N(t.palette.grey[600],.48)},"&.simplebar-visible:before":{opacity:1}},"& .simplebar-mask":{zIndex:"inherit"}})),Cn=a.forwardRef(({children:t,sx:s,...n},i)=>{const r=typeof navigator>"u"?"SSR":navigator.userAgent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(r)?e.jsx(D,{ref:i,sx:{overflow:"auto",...s},...n,children:t}):e.jsx(vn,{children:e.jsx(wn,{scrollableNodeProps:{ref:i},clickOnTrack:!1,sx:s,...n,children:t})})}),Le=a.memo(Cn),Ee={H_MOBILE:64,H_DESKTOP:80},we={WIDTH:280},Xe=a.forwardRef(({src:t,sx:s,...n},i)=>e.jsx(D,{component:"span",className:"svg-color",ref:i,sx:{width:24,height:24,display:"inline-block",bgcolor:"currentColor",mask:`url(${t}) no-repeat center / contain`,WebkitMask:`url(${t}) no-repeat center / contain`,...s},...n}));Xe.propTypes={src:O.string,sx:O.object};const Re=t=>e.jsx(Xe,{src:`/assets/icons/navbar/${t}.svg`,sx:{width:1,height:1}}),Sn=[{title:"dashboard",path:"/dashboard",icon:Re("ic_analytics"),minRole:"User"},{title:"shellies",path:"/shellies",icon:Re("ic_device"),minRole:"User"},{title:"blog",path:"/blog",icon:Re("ic_blog"),minRole:"User"},{title:"user",path:"/user",icon:Re("ic_user"),minRole:"Admin"}];function kn({openNav:t,onCloseNav:s}){const n=Nt(),{user:i}=K(),{t:r}=L(),o=Ze("up","lg");a.useEffect(()=>{t&&s()},[n]);const l=e.jsxs(D,{sx:{my:3,mx:2.5,py:2,px:2.5,display:"flex",borderRadius:1.5,alignItems:"center",bgcolor:x=>N(x.palette.grey[500],.12)},children:[e.jsx(me,{src:`/assets/images/avatars/avatar_${ie(i.userid,25)}.jpg`,alt:"photoURL"}),e.jsxs(D,{sx:{ml:2},children:[e.jsx(P,{variant:"subtitle2",children:`${i.firstname!==null?i.firstname:i.alias} ${i.lastname!==null?i.lastname:i.alias}`}),e.jsx(P,{variant:"body2",sx:{color:"text.secondary"},children:i.role})]})]}),u=e.jsx(R,{component:"nav",spacing:.5,sx:{px:2},children:Sn.map(x=>x.minRole==="User"||x.minRole==="Admin"&&i.roleid===1?e.jsx(Pn,{item:x},x.title):null)}),h=e.jsx(D,{sx:{px:2.5,pb:3,mt:10},children:e.jsxs(R,{alignItems:"center",spacing:3,sx:{pt:5,borderRadius:2,position:"relative"},children:[e.jsx(D,{sx:{width:100,position:"absolute",top:-50},children:e.jsx(me,{src:"/assets/illustrations/avatar_main.jpg",sx:{width:100,height:100}})}),e.jsxs(D,{sx:{textAlign:"center"},children:[e.jsx(P,{variant:"h6",children:r("_getinvolved_")}),e.jsx(P,{variant:"body2",sx:{color:"text.secondary",mt:1},children:r("_opensource_")})]}),e.jsx(Q,{href:"https://github.com/akreienbring/s-central",target:"_blank",variant:"contained",color:"inherit",children:r("_gotogithub_")})]})}),d=e.jsxs(Le,{sx:{height:1,"& .simplebar-content":{height:1,display:"flex",flexDirection:"column"}},children:[e.jsx(Be,{sx:{mt:3,ml:4}}),l,u,e.jsx(D,{sx:{flexGrow:1}}),h]});return e.jsx(D,{sx:{flexShrink:{lg:0},width:{lg:we.WIDTH}},children:o?e.jsx(D,{sx:{height:1,position:"fixed",width:we.WIDTH,borderRight:x=>`dashed 1px ${x.palette.divider}`},children:d}):e.jsx(ae,{open:t,onClose:s,slotProps:{paper:{sx:{width:we.WIDTH}}},children:d})})}function Pn({item:t}){const s=Nt(),{t:n}=L(),i=t.path===s;return e.jsxs(Ct,{"data-testid":`nav_item_${t.title}`,component:Bt,href:t.path,sx:{minHeight:44,borderRadius:.75,typography:"body2",color:"text.secondary",textTransform:"capitalize",fontWeight:"fontWeightMedium",...i&&{color:"primary.main",fontWeight:"fontWeightSemiBold",bgcolor:r=>N(r.palette.primary.main,.08),"&:hover":{bgcolor:r=>N(r.palette.primary.main,.16)}}},children:[e.jsx(D,{component:"span",sx:{width:24,height:24,mr:2},children:t.icon}),e.jsxs(D,{component:"span",children:[t.title==="user"?n("Users"):t.title," "]})]})}const ht=8;function $n({children:t,sx:s,...n}){const i=Ze("up","lg");return e.jsx(D,{component:"main",sx:{flexGrow:1,minHeight:1,display:"flex",flexDirection:"column",py:`${Ee.H_MOBILE+ht}px`,...i&&{px:2,py:`${Ee.H_DESKTOP+ht}px`,width:`calc(100% - ${we.WIDTH}px)`},...s},...n,children:t})}function Oe(t){const s=t?.color||"#000000",n=t?.blur||6,i=t?.opacity||.8,r=t?.imgUrl;return r?{position:"relative",backgroundImage:`url(${r})`,"&:before":{position:"absolute",top:0,left:0,zIndex:9,content:'""',width:"100%",height:"100%",backdropFilter:`blur(${n}px)`,WebkitBackdropFilter:`blur(${n}px)`,backgroundColor:N(s,i)}}:{backdropFilter:`blur(${n}px)`,WebkitBackdropFilter:`blur(${n}px)`,backgroundColor:N(s,i)}}function Fn(t){const s=t?.direction||"to bottom",n=t?.startColor,i=t?.endColor,r=t?.imgUrl,o=t?.color;return{background:`linear-gradient(${s}, ${n||o}, ${i||o}), url(${r})`,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center center"}}function Rn(t,s){return t?Ke(new Date(t),"dd MMM yyyy"):""}function In(t,s){const n=s;return t?Ke(new Date(t),n):""}function Lt(t,s){return t?Ke(Ks(t),s):""}function On(t){if(t===0||typeof t>"u")return"0";const s=Ys({start:0,end:t*1e3}),n=r=>String(r).padStart(2,"0");return[s.days,s.hours,s.minutes,s.seconds].filter(Boolean).map(n).join(":")}const v=a.forwardRef(({icon:t,width:s=25,sx:n,...i},r)=>e.jsx(D,{ref:r,component:an,className:"component-iconify",icon:t,sx:{width:s,height:s,...n},...i})),Tn=()=>{const[t,s]=a.useState("connecting"),{t:n}=L(),i=Ae(),r=a.useCallback(l=>{l!==null&&s(l.detail)},[]);a.useEffect(()=>(Et("lastUpdatedAt",r),()=>{Dt("lastUpdatedAt")}),[r,t]);const o=()=>{t===null&&(s(void 0),i(0))};return t===0?null:e.jsx(Q,{"data-testid":"info_lastUpdate_button",variant:"contained",color:t!==null&&t!=="connecting"?"success":"error",startIcon:t==="connecting"||t==="loading"?e.jsx($s,{size:25,variant:"indeterminate",color:"common.white"}):e.jsx(v,{icon:"carbon:update-now"}),onClick:o,children:t!==null&&t!=="connecting"&&t!=="loading"?In(t,"HH:mm:ss"):n("_notconnected_")})},En=({type:t,requestResult:s,roles:n,currentUser:i,setRequestResult:r,setCurrentUser:o,handleForgotten:l,handleCurrentUser:u})=>{const{user:h}=K(),[d,x]=a.useState(!1),[c,p]=a.useState(t==="create"?"dashboard":i.home),[f,_]=a.useState(""),[C,j]=a.useState(!1),{t:y}=L(),w=a.useRef(!1),b=a.useRef(i);a.useEffect(()=>{!w.current&&n.length>0&&(_(i.roleid),w.current=!0)},[n,s,i]);const T=()=>{r({success:!0,message:""})},I=({target:$})=>{const F={...i};$.name==="role"?(_($.value),F.role=n[$.value-1].name,F.roleid=$.value):$.name==="home"?(p($.value),F.home=$.value):$.name==="alias"?F[$.name]=$.value.trim():$.name==="test"?x($.checked):F[$.name]=$.value,o(F)},S=$=>{$.preventDefault(),b.current=i,u(i,d)},E=()=>{if(i===null)return!0;let $=!1;return t==="login"&&($=typeof i.email>"u"||i.email.length===0||typeof i.password>"u"||i.password.length===0||!Ue(i.email)),(t==="profile"||t==="settings")&&($=(i.alias===b.current.alias||i.alias.length===0)&&i.roleid===b.current.roleid&&i.firstname===b.current.firstname&&i.lastname===b.current.lastname&&i.home===b.current.home),t==="create"&&($=typeof i.email>"u"||i.email.length===0||!Ue(i.email)||typeof i.alias>"u"||i.alias.length===0),t==="security"&&($=!Ue(i.email)||i.password!==i.password2||typeof i.password>"u"||i.password.length===0||typeof i.password2>"u"||i.password.length2===0),$};return e.jsx("form",{onSubmit:S,children:e.jsx(ke,{fullWidth:!0,size:"subtitle2",children:e.jsxs(R,{spacing:3,sx:{px:3,py:3},children:[(t==="login"||t==="create"||t==="security")&&e.jsx(X,{slotProps:{htmlInput:{"data-testid":"security_email_input"}},required:!0,value:i.email,name:"email",label:y("Email"),onFocus:T,onChange:I}),(t==="login"||t==="security")&&e.jsxs(e.Fragment,{children:[e.jsx(X,{name:"password",required:!0,label:y("Password"),onFocus:T,onChange:I,type:C?"text":"password",slotProps:{htmlInput:{"data-testid":"security_password_input"},input:{endAdornment:e.jsx(Te,{position:"end",children:e.jsx(U,{onClick:()=>j(!C),edge:"end",children:e.jsx(v,{icon:C?"eva:eye-fill":"eva:eye-off-fill"})})})}}}),t==="login"&&e.jsx(fe,{"data-testid":"login_test_checkbox",control:e.jsx(re,{name:"test",checked:d,onChange:I}),label:"Test",sx:{display:"none"}})]}),t==="security"&&e.jsx(X,{required:!0,name:"password2",label:y("Password"),onFocus:T,onChange:I,type:C?"text":"password",slotProps:{htmlInput:{"data-testid":"security_password2_input"},input:{endAdornment:e.jsx(Te,{position:"end",children:e.jsx(U,{onClick:()=>j(!C),edge:"end",children:e.jsx(v,{icon:C?"eva:eye-fill":"eva:eye-off-fill"})})})}}}),(t==="profile"||t==="create")&&e.jsxs(R,{spacing:3,children:[e.jsx(X,{required:!0,value:i.alias,name:"alias",label:y("Alias"),onChange:I,onFocus:T,slotProps:{htmlInput:{"data-testid":"profile_alias_input"}}}),e.jsx(X,{value:i.firstname?i.firstname:"",name:"firstname",label:y("Firstname"),onChange:I,onFocus:T,slotProps:{htmlInput:{"data-testid":"profile_firstname_input"}}}),e.jsx(X,{value:i.lastname?i.lastname:"",name:"lastname",label:y("Lastname"),onChange:I,onFocus:T,slotProps:{htmlInput:{"data-testid":"profile_lastname_input"}}}),e.jsx(X,{disabled:h.userid===i.userid||i.userid===1,required:!0,select:!0,value:f,name:"role",label:y("Role"),onChange:I,onFocus:T,slotProps:{htmlInput:{"data-testid":"profile_role_select"}},children:typeof n<"u"?n.map($=>e.jsx(q,{value:$.id,children:$.name},$.name)):null})]}),(t==="settings"||t==="create")&&e.jsxs(X,{required:!0,select:!0,value:c||"dashboard",name:"home",label:y("Home"),onChange:I,onFocus:T,slotProps:{htmlInput:{"data-testid":"settings_home_select"}},children:[e.jsx(q,{"data-testid":"home_dashboard_option",value:"dashboard",children:"Dashboard"}),e.jsx(q,{"data-testid":"home_shellies_option",value:"shellies",children:"Shellies"})]}),e.jsxs(R,{direction:"row",alignItems:"baseline",justifyContent:"space-between",spacing:1,children:[e.jsx(P,{variant:"subtitle2",color:s.success?"success":"error",children:y(s.message)}),t==="login"&&e.jsx(Ge,{variant:"subtitle2",underline:"hover",color:"primary",style:{cursor:"pointer"},onClick:()=>l(i.email),children:y("_forgotpw_")})]}),t==="login"?e.jsx(Q,{"data-testid":"login_submit_button",disabled:E(),fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"inherit",children:y("Login")}):e.jsx(Q,{"data-testid":"account_save_button",disabled:E(),fullWidth:!0,size:"large",type:"submit",color:"inherit",variant:"outlined",startIcon:e.jsx(v,{icon:"formkit:submit"}),children:y("Save")})]})})})},Qe=({type:t,updateuser:s,handleUsersReceived:n,handleUpdateUser:i})=>{const{login:r,user:o,request:l}=K(),[u,h]=a.useState(()=>t==="profile"||t==="settings"||t==="security"?typeof s>"u"?{alias:o.alias,email:o.email,firstname:o.firstname,lastname:o.lastname,password:o.password,home:o.home,roleid:o.roleid,userid:o.userid,uuid:o.uuid}:s:{alias:"",email:"",firstname:"",lastname:"",password:"",home:"dashboard",roleid:3,test:!1}),[d,x]=a.useState([]),[c,p]=a.useState({success:!0,message:""}),f=Ae(),_=De(),C=a.useCallback(S=>{S.data.success?(h(S.data.user),r(S.data.user),f(`/${S.data.user.home!==null?S.data.user.home:"dashboard"}`)):p({success:!1,message:S.data.message})},[f,r]),j=a.useCallback(S=>{p({success:S.data.success,message:S.data.message}),o.userid===u.userid&&r(u),typeof i<"u"?i(u):_.pathname==="/user"&&le("userUpdated",u)},[o,u,r,i,_]),y=a.useCallback(S=>{p({success:S.data.success,message:S.data.message}),S.data.success&&n(S)},[n]),w=a.useCallback(S=>{x(S.data.roles)},[]),b=a.useCallback(S=>{p({success:S.data.success,message:S.data.message})},[]);a.useEffect(()=>{(t==="profile"||t==="create")&&l({event:"roles get all",data:{source:"Users Form",message:"User Form needs the list of roles"}},w)},[t,w,l]);const T=(S,E)=>{t==="login"?l({event:"user validate",data:{source:"User Form",message:"User Form wants to validate a user",user:S,isTest:E}},C):t==="profile"?l({event:"user profile update",data:{source:"User Form",message:"User Form wants to update a users profile",user:S}},j):t==="create"?l({event:"user create",data:{source:"User Form ",message:"User Form wants to create a new user",user:S}},y):t==="security"?l({event:"user security update",data:{source:"User Form ",message:"User Form  wants to update a users credentials",user:S}},j):t==="settings"&&l({event:"user settings update",data:{source:"User Form ",message:"User Form  wants to update a users settings",user:S}},j)},I=S=>{l({event:"user resetpw",data:{source:"User Form",message:"User Form wants to reset a password",email:S}},b)};return e.jsx(En,{type:t,roles:d,requestResult:c,currentUser:u,setCurrentUser:h,setRequestResult:p,handleForgotten:I,handleCurrentUser:T})};function Wt({title:t,openUpdate:s,type:n,updateuser:i,onCloseUpdate:r,handleUpdateUser:o}){return e.jsxs(ae,{anchor:"right",open:s,onClose:r,slotProps:{paper:{sx:{width:300,border:"none",overflow:"hidden"}}},children:[e.jsxs(R,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{px:1,py:2},children:[e.jsx(P,{variant:"h6",sx:{ml:1},children:t}),e.jsx(U,{"data-testid":"updateuser_close_button",onClick:r,children:e.jsx(v,{icon:"eva:close-fill"})})]}),e.jsx(ne,{}),e.jsx(Qe,{type:n,updateuser:i,handleUpdateUser:o})]})}function Dn(){const[t,s]=a.useState(null),[n,i]=a.useState({open:!1,type:""}),{user:r,logout:o}=K(),{t:l}=L(),u=Ae(),h=_=>{p(),i({open:!0,type:_})},d=()=>{i({open:!1,type:""})},x=()=>{p(),u(`${r.home}`)},c=_=>{s(_.currentTarget)},p=()=>{s(null)},f=_=>l(_==="profile"?"_editprofile_":_==="security"?"_editsecurity_":"_editsettings");return e.jsxs(e.Fragment,{children:[e.jsx(U,{"data-testid":"open_account_popover_button",onClick:c,sx:{width:40,height:40,background:_=>N(_.palette.grey[500],.08),...t&&{background:_=>`linear-gradient(135deg, ${_.palette.primary.light} 0%, ${_.palette.primary.main} 100%)`}},children:e.jsx(me,{src:`/assets/images/avatars/avatar_${ie(r.userid,25)}.jpg`,alt:r.name,sx:{width:36,height:36,border:_=>`solid 2px ${_.palette.background.default}`},children:`${r.firstname!==null?r.firstname:r.alias} ${r.lastname!==null?r.lastname:r.alias}`})}),e.jsxs(be,{open:!!t,anchorEl:t,onClose:p,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},marginThreshold:8,slotProps:{paper:{sx:{p:0,mt:1,ml:.75,width:200}}},children:[e.jsxs(D,{sx:{my:1.5,px:2},children:[e.jsx(P,{variant:"subtitle2",noWrap:!0,children:`${r.firstname!==null?r.firstname:r.alias} ${r.lastname!==null?r.lastname:r.alias}`}),e.jsx(P,{variant:"body2",sx:{color:"text.secondary"},noWrap:!0,children:r.email})]}),e.jsx(ne,{sx:{borderStyle:"dashed"}}),e.jsxs(q,{"data-testid":"accountpopover_home_item",onClick:x,children:[e.jsx($e,{children:e.jsx(v,{icon:"eva:home-fill"})}),e.jsx(ye,{primary:l("Home")})]},"Home"),e.jsxs(q,{"data-testid":"accountpopover_profile_item",onClick:()=>h("profile"),children:[e.jsx($e,{children:e.jsx(v,{icon:"eva:person-fill"})}),e.jsx(ye,{primary:l("Profile")})]},"Profile"),e.jsxs(q,{"data-testid":"accountpopover_security_item",onClick:()=>h("security"),children:[e.jsx($e,{children:e.jsx(v,{icon:"eva:lock-fill"})}),e.jsx(ye,{primary:l("Security")})]},"Security"),e.jsxs(q,{"data-testid":"accountpopover_settings_item",onClick:()=>h("settings"),children:[e.jsx($e,{children:e.jsx(v,{icon:"eva:settings-2-fill"})}),e.jsx(ye,{primary:l("Settings")})]},"Settings"),e.jsx(ne,{sx:{borderStyle:"dashed",m:0}}),e.jsx(Q,{"data-testid":"accountpopover_logout_button",fullWidth:!0,color:"inherit",variant:"outlined",onClick:o,startIcon:e.jsx(v,{icon:"formkit:submit"}),sx:{color:"error.main",width:"80%",ml:2,mb:2},children:l("Logout")})]}),e.jsx(Wt,{title:f(n.type),openUpdate:n.open,type:n.type,onCloseUpdate:d})]})}function An(){const[t,s]=a.useState(null),{t:n,i18n:{changeLanguage:i,language:r}}=L(),[o,l]=a.useState(r),[u,h]=a.useState(0),d=(p,f)=>{l(p),h(f),i(p),localStorage.setItem("i18nLanguage",p),c()},x=p=>{s(p.currentTarget)},c=()=>{s(null)};return e.jsxs(e.Fragment,{children:[e.jsx(U,{"data-testid":"open_language_popover_button",onClick:x,sx:{width:40,height:40,...t&&{bgcolor:"action.selected"}},children:e.jsx("img",{src:`/assets/icons/flags/${o}.svg`,alt:n(Ie[u].label)})}),e.jsx(be,{open:!!t,anchorEl:t,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{p:0,mt:1,ml:.75,width:180}}},children:Ie.map((p,f)=>e.jsxs(q,{selected:p.value===Ie[u].value,onClick:()=>d(p.value,f),sx:{typography:"body2",py:1},children:[e.jsx(D,{component:"img",alt:p.label,src:`/assets/icons/flags/${p.value}.svg`,sx:{width:28,mr:2}}),n(p.label)]},p.value))})]})}function Nn(){const[t,s]=a.useState([]),n=t.filter(b=>b.isUnread===!0).length,[i,r]=a.useState(null),{request:o,subscribe:l,unsubscribe:u,send:h}=K(),d=a.useRef(m()),x=a.useRef(!1),{t:c}=L(),p=a.useCallback(b=>{const{notification:T}=b.data,I=[...t];I.push({id:T.id,type:T.type,title:T.title,description:T.notification,avatar:null,createdAt:new Date(T.ts),isUnread:T.isUnread===1}),s(I)},[t]),f=a.useCallback(b=>{x.current=!0;const T=b.data.notifications.map(I=>({id:I.id,type:I.type,title:I.title,description:I.notification,avatar:null,createdAt:new Date(I.ts),isUnread:I.isUnread===1}));s(T)},[s]);a.useEffect(()=>{const b=d.current;return x.current||o({event:"notifications get all",data:{source:"Notifications Popover",message:"Notifications Popover needs the list of notifications"}},f),l({subscriptionID:d.current,callback:p,all:!0},["notification create"]),()=>{u(b,["notification create"])}},[f,p,l,u,o]);const _=b=>{r(b.currentTarget)},C=()=>{r(null)},j=()=>{const b=[],T=t.map(I=>(I.isUnread=!1,b.push(I.id),I));s(T),h({event:"notification update",data:{source:"Notifications Popover",message:"Notifications Popover wants to update notifications",ids:b}})},y=b=>{const T=[],I=t.map(S=>(b.id===S.id&&(S.isUnread=!1,T.push(S.id)),S));s(I),h({event:"notification update",data:{source:"Notifications Popover",message:"Notifications Popover wants to update notifications",ids:T}})},w=b=>{o({event:"notification delete",data:{source:"Notifications Popover",message:"Notifications Popover wants to delete a notification",ids:[b]}},f)};return e.jsxs(e.Fragment,{children:[e.jsx(U,{"data-testid":"open_notifications_popover_button",color:i?"primary":"default",onClick:_,children:e.jsx(Fs,{badgeContent:n,color:"error",children:e.jsx(v,{width:24,icon:"solar:bell-bing-bold-duotone"})})}),e.jsxs(be,{open:!!i,anchorEl:i,onClose:C,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{mt:1.5,ml:.75,width:360}}},children:[e.jsxs(D,{sx:{display:"flex",alignItems:"center",py:2,px:2.5},children:[e.jsxs(D,{sx:{flexGrow:1},children:[e.jsx(P,{variant:"subtitle1",children:c("Notifications")}),e.jsx(P,{variant:"body2",sx:{color:"text.secondary"},children:c("_unreadmessages_",{totalUnRead:n})})]}),n>0&&e.jsx(ce,{title:c("_markallasread_"),children:e.jsx(U,{color:"primary",onClick:j,children:e.jsx(v,{icon:"eva:done-all-fill"})})})]}),e.jsx(ne,{sx:{borderStyle:"dashed"}}),e.jsxs(Le,{sx:{height:{xs:340,sm:"auto"}},children:[e.jsx(it,{disablePadding:!0,subheader:e.jsx(rt,{disableSticky:!0,sx:{py:1,px:2.5,typography:"overline"},children:c("Unread")}),children:t.filter(b=>b.isUnread===!0).map(b=>e.jsx(xt,{notification:b,handleItemClick:y},m()))}),e.jsx(it,{disablePadding:!0,subheader:e.jsx(rt,{disableSticky:!0,sx:{py:1,px:2.5,typography:"overline"},children:c("Read")}),children:t.filter(b=>b.isUnread===!1).map(b=>e.jsx(xt,{notification:b,handleItemDelete:w},m()))})]})]})]})}function xt({notification:t,handleItemClick:s,handleItemDelete:n}){const{avatar:i,title:r}=Bn(t),{i18n:o}=L(),l=()=>{switch(o.language){case"en":return lt;case"de":return Qs;case"es":return Xs;default:return lt}};return e.jsxs(Ct,{onClick:()=>{t.isUnread&&s(t)},sx:{py:1.5,px:2.5,mt:"1px",...t.isUnread&&{bgcolor:"action.selected"}},children:[e.jsx(Rs,{children:e.jsx(me,{alt:t.title,sx:{bgcolor:"background.neutral"},children:i})}),e.jsxs(R,{direction:"row",spacing:3,alignItems:"start",justifyContent:"space-between",children:[e.jsx(ye,{primary:r,secondary:e.jsxs(P,{variant:"caption",sx:{mt:.5,display:"flex",alignItems:"center",color:"text.disabled"},children:[e.jsx(v,{icon:"eva:clock-outline",sx:{mr:.5,width:16,height:16}}),Zs(t.createdAt,{addSuffix:!0,locale:l()})]}),sx:{maxWidth:200}}),!t.isUnread&&e.jsx(U,{onClick:()=>{n(t.id)},children:e.jsx(v,{icon:"eva:trash-2-outline",sx:{mr:2}})})]})]})}function Bn(t){const s=e.jsxs(e.Fragment,{children:[e.jsxs(P,{variant:"subtitle2",children:[t.title," "]}),e.jsx(P,{component:"span",variant:"body2",style:{whiteSpace:"pre-line"},sx:{color:"text.secondary"},children:t.description})]});return t.type==="script-error"?{avatar:e.jsx("img",{src:"/assets/icons/notification/ic_notification_error.svg"}),title:s}:t.type==="device-offline"?{avatar:e.jsx("img",{src:"/assets/icons/notification/ic_notification_offline.svg"}),title:s}:null}function Ln({onOpenNav:t}){const s=Se(),n=De(),i=Ze("up","lg"),r=e.jsxs(e.Fragment,{children:[!i&&e.jsx(U,{"data-testid":"nav_open_button",onClick:t,sx:{mr:1},children:e.jsx(v,{icon:"eva:menu-2-fill"})}),e.jsx(D,{sx:{flexGrow:1}}),e.jsxs(R,{direction:"row",alignItems:"center",spacing:1,children:[(n.pathname==="/dashboard"||n.pathname==="/shellies")&&e.jsx(Tn,{}),e.jsx(An,{}),e.jsx(Nn,{}),e.jsx(Dn,{})]})]});return e.jsx(Is,{sx:{boxShadow:"none",height:Ee.H_MOBILE,zIndex:s.zIndex.appBar+1,...Oe({color:s.palette.background.default}),transition:s.transitions.create(["height"],{duration:s.transitions.duration.shorter}),...i&&{width:`calc(100% - ${we.WIDTH+1}px)`,height:Ee.H_DESKTOP}},children:e.jsx(Ve,{sx:{height:1,px:{lg:5}},children:r})})}function Wn({children:t}){const[s,n]=a.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(Ln,{onOpenNav:()=>n(!0)}),e.jsxs(D,{sx:{minHeight:1,display:"flex",flexDirection:{xs:"column",lg:"row"}},children:[e.jsx(kn,{openNav:s,onCloseNav:()=>n(!1)}),e.jsx($n,{children:t})]})]})}const gt=a.lazy(()=>he(()=>Promise.resolve().then(()=>pi),void 0)),mt=a.lazy(()=>he(()=>Promise.resolve().then(()=>mi),void 0)),Un=a.lazy(()=>he(()=>Promise.resolve().then(()=>Pi),void 0)),ft=a.lazy(()=>he(()=>Promise.resolve().then(()=>Ii),void 0)),zn=a.lazy(()=>he(()=>Promise.resolve().then(()=>Ei),void 0)),bt=a.lazy(()=>he(()=>Promise.resolve().then(()=>sr),void 0)),Mn=a.lazy(()=>he(()=>Promise.resolve().then(()=>rr),void 0));function qn(){const{user:t}=K();return Cs([{path:"/",element:window.scconfig.LANDING_PAGE==="login"?e.jsx(ft,{}):e.jsx(zn,{})},{element:t?e.jsx(Wn,{children:e.jsx(a.Suspense,{children:e.jsx(Ss,{})})}):e.jsx(nt,{to:"/",replace:!0}),children:!t||t.roleid===1?[{path:"dashboard",element:e.jsx(gt,{}),index:!0},{path:"user",element:e.jsx(Un,{})},{path:"shellies",element:e.jsx(bt,{})},{path:"blog",element:e.jsx(mt,{})}]:[{path:"dashboard",element:e.jsx(gt,{}),index:!0},{path:"shellies",element:e.jsx(bt,{})},{path:"blog",element:e.jsx(mt,{})}]},{path:"login",element:e.jsx(ft,{})},{path:"404",element:e.jsx(Mn,{})},{path:"*",element:e.jsx(nt,{to:"/404",replace:!0})}])}function Hn(){const{pathname:t}=De();return a.useEffect(()=>{window.scrollTo(0,0)},[t]),null}const J={0:"#FFFFFF",100:"#F9FAFB",200:"#F4F6F8",300:"#DFE3E8",400:"#C4CDD5",500:"#919EAB",600:"#637381",700:"#454F5B",800:"#212B36",900:"#161C24"},Ut={lighter:"#D0ECFE",light:"#73BAFB",main:"#1877F2",dark:"#0C44AE",darker:"#042174",contrastText:"#FFFFFF"},zt={lighter:"#EFD6FF",light:"#C684FF",main:"#8E33FF",dark:"#5119B7",darker:"#27097A",contrastText:"#FFFFFF"},Mt={lighter:"#CAFDF5",light:"#61F3F3",main:"#00B8D9",dark:"#006C9C",darker:"#003768",contrastText:"#FFFFFF"},qt={lighter:"#C8FAD6",light:"#5BE49B",main:"#00A76F",dark:"#007867",darker:"#004B50",contrastText:"#FFFFFF"},Ht={lighter:"#FFF5CC",light:"#FFD666",main:"#FFAB00",dark:"#B76E00",darker:"#7A4100",contrastText:J[800]},Gt={lighter:"#FFE9D5",light:"#FFAC82",main:"#FF5630",dark:"#B71D18",darker:"#7A0916",contrastText:"#FFFFFF"},Vt={black:"#000000",white:"#FFFFFF"},Gn={hover:N(J[500],.08),selected:N(J[500],.16),disabled:N(J[500],.8),disabledBackground:N(J[500],.24),focus:N(J[500],.24),hoverOpacity:.08,disabledOpacity:.48},_t={primary:Ut,secondary:zt,info:Mt,success:qt,warning:Ht,error:Gt,grey:J,common:Vt,divider:N(J[500],.2),action:Gn};function Vn(){return{..._t,mode:"light",text:{primary:J[800],secondary:J[600],disabled:J[500]},background:{paper:"#FFFFFF",default:J[100],neutral:J[200]},action:{..._t.action,active:J[600]}}}function Jn(){const t=N(J[500],.2),s=N(J[500],.14),n=N(J[500],.12);return["none",`0px 2px 1px -1px ${t},0px 1px 1px 0px ${s},0px 1px 3px 0px ${n}`,`0px 3px 1px -2px ${t},0px 2px 2px 0px ${s},0px 1px 5px 0px ${n}`,`0px 3px 3px -2px ${t},0px 3px 4px 0px ${s},0px 1px 8px 0px ${n}`,`0px 2px 4px -1px ${t},0px 4px 5px 0px ${s},0px 1px 10px 0px ${n}`,`0px 3px 5px -1px ${t},0px 5px 8px 0px ${s},0px 1px 14px 0px ${n}`,`0px 3px 5px -1px ${t},0px 6px 10px 0px ${s},0px 1px 18px 0px ${n}`,`0px 4px 5px -2px ${t},0px 7px 10px 1px ${s},0px 2px 16px 1px ${n}`,`0px 5px 5px -3px ${t},0px 8px 10px 1px ${s},0px 3px 14px 2px ${n}`,`0px 5px 6px -3px ${t},0px 9px 12px 1px ${s},0px 3px 16px 2px ${n}`,`0px 6px 6px -3px ${t},0px 10px 14px 1px ${s},0px 4px 18px 3px ${n}`,`0px 6px 7px -4px ${t},0px 11px 15px 1px ${s},0px 4px 20px 3px ${n}`,`0px 7px 8px -4px ${t},0px 12px 17px 2px ${s},0px 5px 22px 4px ${n}`,`0px 7px 8px -4px ${t},0px 13px 19px 2px ${s},0px 5px 24px 4px ${n}`,`0px 7px 9px -4px ${t},0px 14px 21px 2px ${s},0px 5px 26px 4px ${n}`,`0px 8px 9px -5px ${t},0px 15px 22px 2px ${s},0px 6px 28px 5px ${n}`,`0px 8px 10px -5px ${t},0px 16px 24px 2px ${s},0px 6px 30px 5px ${n}`,`0px 8px 11px -5px ${t},0px 17px 26px 2px ${s},0px 6px 32px 5px ${n}`,`0px 9px 11px -5px ${t},0px 18px 28px 2px ${s},0px 7px 34px 6px ${n}`,`0px 9px 12px -6px ${t},0px 19px 29px 2px ${s},0px 7px 36px 6px ${n}`,`0px 10px 13px -6px ${t},0px 20px 31px 3px ${s},0px 8px 38px 7px ${n}`,`0px 10px 13px -6px ${t},0px 21px 33px 3px ${s},0px 8px 40px 7px ${n}`,`0px 10px 14px -6px ${t},0px 22px 35px 3px ${s},0px 8px 42px 7px ${n}`,`0px 11px 14px -7px ${t},0px 23px 36px 3px ${s},0px 9px 44px 8px ${n}`,`0px 11px 15px -7px ${t},0px 24px 38px 3px ${s},0px 9px 46px 8px ${n}`]}function Kn(t){return{MuiCssBaseline:{styleOverrides:{"*":{boxSizing:"border-box"},html:{margin:0,padding:0,width:"100%",height:"100%",WebkitOverflowScrolling:"touch"},body:{margin:0,padding:0,width:"100%",height:"100%"},"#root":{width:"100%",height:"100%"},input:{"&[type=number]":{MozAppearance:"textfield","&::-webkit-outer-spin-button":{margin:0,WebkitAppearance:"none"},"&::-webkit-inner-spin-button":{margin:0,WebkitAppearance:"none"}}},img:{maxWidth:"100%",display:"inline-block",verticalAlign:"bottom"}}},MuiBackdrop:{styleOverrides:{root:{backgroundColor:N(t.palette.grey[900],.8)},invisible:{background:"transparent"}}},MuiButton:{styleOverrides:{containedInherit:{color:t.palette.common.white,backgroundColor:t.palette.grey[800],"&:hover":{color:t.palette.common.white,backgroundColor:t.palette.grey[800]}},sizeLarge:{minHeight:48}}},MuiCard:{styleOverrides:{root:{boxShadow:t.customShadows.card,borderRadius:Number(t.shape.borderRadius)*2,position:"relative",zIndex:0}}},MuiCardHeader:{defaultProps:{titleTypographyProps:{variant:"h6"},subheaderTypographyProps:{variant:"body2"}},styleOverrides:{root:{padding:t.spacing(3,3,0)}}},MuiOutlinedInput:{styleOverrides:{root:{[`& .${Os.notchedOutline}`]:{borderColor:N(t.palette.grey[500],.24)}}}},MuiPaper:{defaultProps:{elevation:0}},MuiTableCell:{styleOverrides:{head:{color:t.palette.text.secondary,backgroundColor:t.palette.background.neutral}}},MuiTooltip:{styleOverrides:{tooltip:{backgroundColor:t.palette.grey[800]},arrow:{color:t.palette.grey[800]}}},MuiTypography:{styleOverrides:{paragraph:{marginBottom:t.spacing(2)},gutterBottom:{marginBottom:t.spacing(1)}}},MuiMenuItem:{styleOverrides:{root:{...t.typography.body2}}}}}function Z(t){return`${t/16}rem`}function xe({sm:t,md:s,lg:n}){return{"@media (min-width:600px)":{fontSize:Z(t)},"@media (min-width:900px)":{fontSize:Z(s)},"@media (min-width:1200px)":{fontSize:Z(n)}}}const Yn="Public Sans, sans-serif",Zn="Barlow, sans-serif",Xn={fontFamily:Yn,fontSecondaryFamily:Zn,fontWeightRegular:400,fontWeightMedium:500,fontWeightSemiBold:600,fontWeightBold:700,h1:{fontWeight:800,lineHeight:80/64,fontSize:Z(40),...xe({sm:52,md:58,lg:64})},h2:{fontWeight:800,lineHeight:64/48,fontSize:Z(32),...xe({sm:40,md:44,lg:48})},h3:{fontWeight:700,lineHeight:1.5,fontSize:Z(24),...xe({sm:26,md:30,lg:32})},h4:{fontWeight:700,lineHeight:1.5,fontSize:Z(20),...xe({sm:20,md:24,lg:24})},h5:{fontWeight:700,lineHeight:1.5,fontSize:Z(18),...xe({sm:19,md:20,lg:20})},h6:{fontWeight:700,lineHeight:28/18,fontSize:Z(17),...xe({sm:18,md:18,lg:18})},subtitle1:{fontWeight:600,lineHeight:1.5,fontSize:Z(16)},subtitle2:{fontWeight:600,lineHeight:22/14,fontSize:Z(14)},body1:{lineHeight:1.5,fontSize:Z(16)},body2:{lineHeight:22/14,fontSize:Z(14)},caption:{lineHeight:1.5,fontSize:Z(12)},overline:{fontWeight:700,lineHeight:1.5,fontSize:Z(12),textTransform:"uppercase"},button:{fontWeight:700,lineHeight:24/14,fontSize:Z(14),textTransform:"unset"}};function Qn(){const t=N(J[500],.16);return{z1:`0 1px 2px 0 ${t}`,z4:`0 4px 8px 0 ${t}`,z8:`0 8px 16px 0 ${t}`,z12:`0 12px 24px -4px ${t}`,z16:`0 16px 32px -4px ${t}`,z20:`0 20px 40px -4px ${t}`,z24:`0 24px 48px 0 ${t}`,card:`0 0 2px 0 ${N(J[500],.08)}, 0 12px 24px -4px ${N(J[500],.08)}`,dropdown:`0 0 2px 0 ${N(J[500],.24)}, -20px 20px 40px -4px ${N(J[500],.24)}`,dialog:`-40px 40px 80px -8px ${N(Vt.black,.24)}`,primary:`0 8px 16px 0 ${N(Ut.main,.24)}`,info:`0 8px 16px 0 ${N(Mt.main,.24)}`,secondary:`0 8px 16px 0 ${N(zt.main,.24)}`,success:`0 8px 16px 0 ${N(qt.main,.24)}`,warning:`0 8px 16px 0 ${N(Ht.main,.24)}`,error:`0 8px 16px 0 ${N(Gt.main,.24)}`}}function Jt({children:t}){const s=a.useMemo(()=>({palette:Vn(),typography:Xn,shadows:Jn(),customShadows:Qn(),shape:{borderRadius:8}}),[]),n=Ts(s);return n.components=Kn(n),e.jsxs(Es,{theme:n,children:[e.jsx(Ds,{}),t]})}Jt.propTypes={children:O.node};function ei(){return Hn(),e.jsx(yn,{children:e.jsx(Jt,{children:e.jsx(qn,{})})})}const ti=vs.createRoot(document.getElementById("root"));ti.render(e.jsx(Ps,{children:e.jsx(ks,{children:e.jsx(a.Suspense,{children:e.jsx(ei,{})})})}));function si(t){const s=typeof t<"u"?en(t).format("0.00a"):"";return et(s,".00")}function jt(t){const s=typeof t<"u"?`${(t/1e3/1e3*60).toFixed(2)} kw/h`:"";return et(s,"")}function Ce(t){const s=typeof t<"u"?`${(t/1e3*60).toFixed(2)} w/h`:"";return et(s,"")}function et(t,s){return t.includes(s)?t.replace(s,""):t}const ni=()=>{const t=Se();return[t.palette.success.dark,t.palette.info.dark,t.palette.error.dark,t.palette.warning.dark,t.palette.primary.dark,t.palette.success.main,t.palette.info.main,t.palette.error.main,t.palette.primary.main,t.palette.warning.main,t.palette.success.light,t.palette.info.light,t.palette.error.light,t.palette.warning.light,t.palette.primary.light]},ii=Ne(Ye)(({theme:t})=>({"& .apexcharts-canvas":{"& .apexcharts-tooltip":{...Oe({color:t.palette.background.default}),color:t.palette.text.primary,boxShadow:t.customShadows.dropdown,borderRadius:t.shape.borderRadius*1.25,"&.apexcharts-theme-light":{borderColor:"transparent",...Oe({color:t.palette.background.default})}},"& .apexcharts-xaxistooltip":{...Oe({color:t.palette.background.default}),borderColor:"transparent",color:t.palette.text.primary,boxShadow:t.customShadows.dropdown,borderRadius:t.shape.borderRadius*1.25,"&:before":{borderBottomColor:N(t.palette.grey[500],.24)},"&:after":{borderBottomColor:N(t.palette.background.default,.8)}},"& .apexcharts-tooltip-title":{textAlign:"center",fontWeight:t.typography.fontWeightBold,backgroundColor:N(t.palette.grey[500],.08),color:t.palette.text[t.palette.mode==="light"?"secondary":"primary"]},"& .apexcharts-legend":{padding:0},"& .apexcharts-legend-series":{display:"inline-flex !important",alignItems:"center"},"& .apexcharts-legend-marker":{marginRight:8},"& .apexcharts-legend-text":{lineHeight:"18px",textTransform:"capitalize"}}}));a.memo(ii);function ve({title:t,subtitle:s,icon:n,sx:i,...r}){return e.jsxs(ue,{component:R,spacing:3,direction:"row",sx:{px:3,py:5,borderRadius:2,...i},...r,children:[n&&e.jsx(D,{sx:{width:64,height:64},children:n}),e.jsxs(R,{spacing:.5,children:[e.jsx(P,{variant:"h5",children:t}),e.jsx(P,{variant:"subtitle2",sx:{color:"text.disabled"},children:s})]})]})}ve.propTypes={color:O.string,icon:O.oneOfType([O.element,O.string]),sx:O.object,title:O.string,subtitle:O.string};function Kt(t,s){let n,i=0,r=!1;const o=[];for(let l=0;l<=3;l+=1)if(n=s[`switch:${l}`],typeof n?.aenergy?.by_minute<"u"){r=!0;const u=Number(n.aenergy.by_minute[0]);u>0&&(i+=u,o.push({label:`${t} switch:${l}`,value:u}))}if(n=s["rgbw:0"],typeof n?.aenergy?.by_minute<"u"){r=!0;const l=Number(n.aenergy.by_minute[0]);l>0&&(i+=l,o.push({label:`${t} rgbw:0`,value:l}))}return{hasSwitch:r,totalPower:i,powerPerDevice:o}}function ri(t){let s=0,n=0,i=0,r=0,o=0,l=[];const u=[];let h={totalPower:0,powerPerDevice:[]};return Object.values(t).forEach(d=>{const x=d?.wsmessages?.NotifyFullStatus?.params;if(d.online&&(i+=1),typeof x<"u"&&(h=Kt(d.cname,x),h.totalPower>0&&u.push(d.chartColor),l=l.concat(h.powerPerDevice),o+=h.totalPower,typeof x?.cloud?.connected<"u"&&x.cloud.connected&&(r+=1),typeof d.scripts<"u")){let c;Object.values(d.scripts).forEach(p=>{c=x[`script:${p.id}`],c!=="undefined"&&(s+=1,c.running&&(n+=1),p.running=c.running)})}}),{currentPower:o,powerPerDevice:l,colorPerDevice:u,scriptsRunning:n,scriptsCount:s,cloudCount:r,onlineCount:i}}function oi({title:t,subheader:s,colors:n,powerPerDevice:i,...r}){const o=Se(),l=[],u=[];i.forEach(d=>{l.push(d.label),u.push(d.value)});const h={chart:{id:"current-consumption"},labels:l,stroke:{colors:[o.palette.background.paper]},legend:{show:!0,position:"bottom"},colors:n,dataLabels:{enabled:!0,dropShadow:{enabled:!1}},tooltip:{fillSeriesColor:!1,shared:!0,intersect:!1,y:{formatter:d=>typeof d<"u"?Ce(d):d}}};return e.jsxs(ue,{...r,children:[e.jsx(Je,{title:t,subheader:s,sx:{mb:5}}),e.jsx(Ye,{"data-testid":"chart_current_component",type:"pie",series:u,options:h,width:"100%",height:280})]})}function ai({title:t,subheader:s,chart:n,handleTimelineChange:i,selection:r,...o}){const{labels:l,colors:u,series:h,timeline:d,maxConsumption:x}=n,{t:c}=L(),p={colors:u,legend:{show:!0,position:"bottom",showForSingleSeries:!0},plotOptions:{bar:{columnWidth:"28%"}},chart:{stacked:d.data!=="Minute"},yaxis:{labels:{formatter(f){return d.data==="Minute"?x/1e3*60<1e3?Ce(f):jt(f):x/1e3<1e3?`${(f/1e3).toFixed(2)} w/h`:`${(f/1e3/1e3).toFixed(2)} kw/h`}},forceNiceScale:!0},xaxis:{type:"datetime",labels:{format:d.format,datetimeUTC:!1}},stroke:{width:3,curve:"smooth",lineCap:"round"},tooltip:{shared:!0,intersect:!1,x:{show:!0,format:d.format||"undefined"},y:{formatter(f){return d.data==="Minute"?x/1e3*60<9e3?Ce(f):jt(f):x/1e3<9e3?`${(f/1e3).toFixed(2)} w/h`:`${(f/1e3/1e3).toFixed(2)} kw/h`}}}};return e.jsxs(ue,{...o,children:[e.jsx(Je,{title:t,subheader:s,action:e.jsx(ke,{sx:{m:1,minWidth:120},size:"small",children:e.jsxs(As,{value:r,onChange:i,children:[e.jsx(q,{value:"0",children:c("_byminute_")}),e.jsx(q,{value:"1",children:c("_byhour_")}),e.jsx(q,{value:"2",children:c("_byday_")}),e.jsx(q,{value:"3",children:c("_bymonth_")}),e.jsx(q,{value:"4",children:c("_byyear_")})]})})}),e.jsx(D,{sx:{p:3,pb:1},children:e.jsx(Ye,{"data-testid":"chart_timeline_component",dir:"ltr",type:h[0].type,series:h,options:p,width:"100%",height:364})})]})}function li(t){const s={};switch(t){case 1:s.data="Hour",s.format="HH:00",s.catformat="yyyy-MM-dd HH:00";break;case 2:s.data="Day",s.format="d.MM",s.catformat="yyyy-MM-dd";break;case 3:s.data="Month",s.format="MMM.yyyy",s.catformat="yyyy-MM";break;case 4:s.data="Year",s.format="yyyy",s.catformat="yyyy";break;default:s.data="Minute",s.format="H:mm",s.catformat="yyyy-MM-dd HH:mm"}return s}function ci(t,s,n){const i=[],r=[],o=[],l=[];let u=0;return s.forEach(h=>{h.consumption>u&&(u=h.consumption);const d=Lt(h.ts,n.catformat);i.includes(d)||i.push(d);const x=o.indexOf(h.device_id);if(x===-1){const c=t.findIndex(p=>p.id===h.device_id);c!==-1?(o.push(h.device_id),l.push(t[c].chartColor),r.push({name:t[c].cname,type:n.data==="Minute"?"line":"bar",data:[{x:d,y:h.consumption}]})):console.error(`Could not finde device with id ${h.device_id}`)}else r[x].data.push({x:d,y:h.consumption})}),{labels:i,series:r,colors:l,maxConsumption:u}}function di(){const[t,s]=a.useState(0),[n,i]=a.useState({running:0,count:0}),[r,o]=a.useState(0),[l,u]=a.useState([]),[h,d]=a.useState([]),[x,c]=a.useState({online:0,count:0}),[p,f]=a.useState({labels:[],colors:[],series:[],timeline:{},maxConsumption:0}),[_,C]=a.useState([]),{t:j}=L(),[y,w]=a.useState(0),b=a.useRef({data:"Minute",format:"HH:mm",catformat:"yyyy-MM-dd HH:mm"}),{user:T,request:I,subscribe:S,unsubscribe:E}=K(),$=ni(),F=a.useRef(m()),g=a.useCallback(W=>{let H;if(_.length!==0)H=_;else if(typeof W.data.devices<"u")H=W.data.devices;else return;const{rows:oe}=W.data,se=ci(H,oe,b.current);H.length>0&&f({labels:se.labels,colors:se.colors,series:se.series,timeline:b.current,maxConsumption:se.maxConsumption})},[_]),k=a.useCallback(W=>{C(W);const H=ri(W);i({running:H.scriptsRunning,count:H.scriptsCount}),o(H.cloudCount),u(H.colorPerDevice),d(H.powerPerDevice),s(H.currentPower),c({online:H.onlineCount,count:W.length}),I({event:`getTimeline${b.current.data}`,data:{source:"App View",message:"App View needs timeline for a device"}},g)},[I,g]),B=a.useCallback(W=>{const H=W.data.device;if(W.event==="ShellyUpdate"&&W.type==="ws"){const oe=_.map((se,We)=>se.id===H.id?(H.chartColor=$[ie(We+1,$.length)],H):se);k(oe)}},[k,_,$]),Y=W=>{const H=Number(W.target.value);w(H),b.current=li(H),I({event:`getTimeline${b.current.data}`,data:{source:"App View",message:"App View needs timeline for a device"}},g)},ee=a.useCallback(W=>{const H=W.data.devices.map((oe,se)=>(oe.chartColor=$[ie(se+1,$.length)],oe));g(W),k(H)},[$,k,g]);return a.useEffect(()=>{const W=F.current;return _.length===0&&I({event:"devices timeline get",data:{source:"App View",message:"App View needs the list of devices and the timeline"}},ee),S({subscriptionID:W,callback:B,all:!0},["ShellyUpdate"]),()=>{E(W,["ShellyUpdate"])}},[_,ee,B,E,S,I]),_.length===0?null:e.jsxs(_e,{maxWidth:"xl",children:[e.jsx(P,{variant:"h4",children:`${j("_welcome_")} ${T.firstname!==null?T.firstname:T.alias}`}),e.jsxs(te,{container:!0,spacing:3,children:[e.jsx(te,{size:{xs:12,sm:6,md:3},children:e.jsx(ve,{"data-testid":"dashboard_shellies_component",title:`${x.online}/${x.count}`,subtitle:`Shellies ${j("Connected")}`,color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/overview/S-Shelly-Icon.svg"})})}),e.jsx(te,{size:{xs:12,sm:6,md:3},children:e.jsx(ve,{"data-testid":"dashboard_totalconsumption_component",title:Ce(t),subtitle:j("_consumption_"),color:"info",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/overview/consumption.svg"})})}),e.jsx(te,{size:{xs:12,sm:6,md:3},children:e.jsx(ve,{"data-testid":"dashboard_scripts_component",title:`${n.running}/${n.count}`,subtitle:j("Running"),color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/overview/script.svg"})})}),e.jsx(te,{size:{xs:12,sm:6,md:3},children:e.jsx(ve,{"data-testid":"dashboard_cloud_component",title:si(r),subtitle:j("Connected"),color:"error",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/overview/cloud.svg"})})}),e.jsx(te,{size:{xs:12,sm:12,md:12,lg:12},children:e.jsx(oi,{"data-testid":"dashboard_current_consumption_component",title:j("_consumption_"),subheader:j("_perShelly_"),colors:l,powerPerDevice:h})}),e.jsx(te,{size:{xs:12,sm:12,md:12,lg:12},children:e.jsx(ai,{"data-testid":"dashboard_timeline_component",title:"Timeline",subheader:j("_perShelly_"),chart:p,handleTimelineChange:Y,selection:y})})]})]})}function ui(){const{user:t}=K();return e.jsxs(e.Fragment,{children:[e.jsx(de,{children:e.jsx("title",{children:" Dashboard"})}),t?e.jsx(di,{}):null]})}const pi=Object.freeze(Object.defineProperty({__proto__:null,default:ui},Symbol.toStringTag,{value:"Module"}));function hi({handleContentChange:t,content:s}){const{t:n}=L(),i=["heading","bold","italic","strike","link","underline","code","orderedList","bulletList","align","codeBlock","blockquote","history","color"],r={editor:{editor:"Editor",preview:n("_editor-preview_")},toolbar:{bold:n("_editor-bold_"),italic:n("_editor-italic_"),strike:n("_editor-strike_"),underline:n("_editor-underline_"),link:n("_editor-link_"),bulletList:n("_editor-bulletlist_"),orderedList:n("_editor-orderedlist_"),alignLeft:n("_editor-alignleft_"),alignCenter:n("_editor-aligncenter_"),alignRight:n("_editor-alignright_"),alignJustify:n("_editor-alignjustify_"),blockquote:n("_editor-blockquote_"),codeBlock:n("_editor-codeblock_"),color:n("_editor-color_"),table:"Table",youtube:"Youtube",undo:n("_editor-undo_"),redo:n("_editor-redo_"),mention:"Mention"},headings:{normalText:n("_editor-normaltext_"),h1:n("_editor-h1_"),h2:n("_editor-h2_"),h3:n("_editor-h3_"),h4:n("_editor-h4_"),h5:n("_editor-h5_"),h6:n("_editor-h6_")},table:{table:"Tableau",addColumnBefore:"Ajouter une colonne avant",addColumnAfter:"Ajouter une colonne apr칟s",deleteColumn:"Supprimer la colonne",addRowBefore:"Ajouter une ligne avant",addRowAfter:"Ajouter une ligne apr칟s",deleteRow:"Supprimer la ligne",mergeCells:"Fusionner les cellules",splitCell:"Diviser la cellule",deleteTable:"Supprimer le tableau",insertTable:"Ins칠rer un tableau",toggleHeaderCell:"Basculer la cellule d'en-t칡te",toggleHeaderColumn:"Basculer la colonne d'en-t칡te",toggleHeaderRow:"Basculer la ligne d'en-t칡te",mergeOrSplit:"Fusionner ou diviser",setCellAttribute:"D칠finir l'attribut de cellule"},link:{link:n("_editor-link_"),insert:n("_editor-insertlink_"),invalid:n("_editor-invalidlink_")},youtube:{link:"Lien",insert:"Ins칠rer la vid칠o Youtube",title:"Ins칠rer une vid칠o Youtube",invalid:"Lien invalide",enter:"Entrer le lien",height:"Hauteur",width:"Largeur"}};return e.jsxs("div",{children:[e.jsx(tn,{value:s,onChange:t,toolbar:i,placeholder:n("_editor-placeholder_"),disableTabs:!0,toolbarPosition:"top",labels:r,withBubbleMenu:!1}),e.jsx("div",{"data-testid":"blogpost_content_component"})]})}const Yt=({type:t,handleUpdatePost:s,updatepost:n,handleBlogpostsReceived:i})=>{const{user:r,request:o}=K(),[l,u]=a.useState(t==="update"?n:{title:"",content:"",public:0}),{t:h}=L(),[d,x]=a.useState({success:!0,message:""}),c=y=>{x({success:y.data.success,message:y.data.message}),y.data.success&&i(y)},p=y=>{x({success:y.data.success,message:y.data.message}),y.data.success&&s(l)},f=({target:y})=>{const w={...l};y.name==="public"?w.public=y.checked?1:0:w[y.name]=y.value,u(w)},_=y=>{const w={...l};w.content=y,u(w)},C=y=>{y.preventDefault(),t==="create"?(l.userid=r.userid,l.createdAt=Date.now(),o({event:"blogpost create",data:{source:"Blogpost Form",message:"Blogpost Form wants to create a new post",blogpost:l}},c)):t==="update"&&o({event:"blogpost update",data:{source:"Blogpost Form",message:"Blogpost Form wants to update a post",blogpost:l}},p)},j=()=>typeof l.title>"u"||l.title.length===0||typeof l.content>"u"||l.content.length===0||Tt(n,l);return e.jsx("form",{onSubmit:C,children:e.jsx(ke,{fullWidth:!0,size:"subtitle2",children:e.jsxs(R,{spacing:3,sx:{px:3,py:3},children:[e.jsxs(R,{direction:"row",spacing:3,children:[e.jsx(X,{required:!0,value:l.title,name:"title",label:h("Title"),slotProps:{htmlInput:{"data-testid":"blogpost_title_input",maxLength:40}},onChange:f,sx:{width:280}}),e.jsx(fe,{control:e.jsx(Ns,{name:"public",size:"medium",checked:l.public===1,onChange:f}),label:"Public",labelPlacement:"bottom"})]}),e.jsx(hi,{handleContentChange:_,content:l.content}),e.jsx(P,{variant:"subtitle2",color:d.success?"success":"error",children:h(d.message)}),e.jsx(Q,{disabled:j(),fullWidth:!0,size:"large",type:"submit",color:"inherit",variant:"outlined",startIcon:e.jsx(v,{icon:"formkit:submit"}),children:h("Save")})]})})})};function Zt({openUpdate:t,updatepost:s,onCloseUpdate:n,handleUpdatePost:i}){const{t:r}=L();return e.jsxs(ae,{anchor:"right",open:t,onClose:n,slotProps:{paper:{sx:{width:1,border:"none",overflow:"auto"}}},children:[e.jsxs(R,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{px:1,py:2},children:[e.jsx(P,{variant:"h6",sx:{ml:1},children:r("_editpost_")}),e.jsx(U,{onClick:n,children:e.jsx(v,{icon:"eva:close-fill"})})]}),e.jsx(ne,{}),e.jsx(Yt,{type:"update",handleUpdatePost:i,updatepost:s})]})}Zt.propTypes={openUpdate:O.bool.isRequired,updatepost:O.object,handleUpdatePost:O.func,onCloseUpdate:O.func.isRequired};function Xt({blogpost:t,index:s,handleDeletePost:n}){const[i,r]=a.useState(null),[o,l]=a.useState(!1),[u,h]=a.useState(!1),[d,x]=a.useState(!1),[c,p]=a.useState(t),{t:f}=L(),{user:_}=K(),C=s===0,j=s===1||s===2,y=k=>{const B={...c};B.title=k.title,B.content=k.content,B.public=k.public,p(B)},w=k=>{r(k.currentTarget),x(!1)},b=()=>{r(null)},T=()=>{l(!1)},I=()=>{l(!0),r(null)},S=()=>{x(!0)},E=e.jsx(me,{alt:c.author.name,src:c.author.avatarUrl,sx:{zIndex:9,width:32,height:32,position:"absolute",left:k=>k.spacing(3),bottom:k=>k.spacing(-2),...(C||j)&&{zIndex:9,top:24,left:24,width:40,height:40}}}),$=e.jsx(D,{sx:C||j?{position:"absolute",top:80,left:25}:{pl:3,pt:4},children:e.jsxs(R,{children:[e.jsx(P,{variant:"caption",component:"div",sx:{mb:2,color:"text.disabled",...(C||j)&&{opacity:.48,color:"common.white"}},children:Rn(c.createdAt)}),e.jsxs(R,{direction:"row",spacing:2,children:[e.jsx(P,{color:"inherit",variant:"subtitle2",sx:{height:44,overflow:"hidden",WebkitLineClamp:2,display:"-webkit-box",WebkitBoxOrient:"vertical",...C&&{typography:"h5",height:60},...(C||j)&&{color:"common.white"}},children:c.title}),e.jsx(v,{icon:"mdi:text-box",onClick:()=>h(!u),sx:{cursor:"pointer",...(C||j)&&{color:"white"}}})]}),e.jsx(P,{variant:"caption",color:"inherit",sx:{...(C||j)&&{color:"common.white"}},children:e.jsx(ct,{value:`${c.content.substring(0,150)} ${c.content.length>150?"...":""}`})})]})}),F=e.jsx(D,{component:"img",alt:c.title,src:c.cover,sx:{top:0,width:1,height:1,objectFit:"cover",position:"absolute"}}),g=e.jsx(Xe,{color:"paper",src:"/assets/icons/shape-avatar.svg",sx:{width:80,height:36,zIndex:9,bottom:-15,position:"absolute",color:"background.paper",...(C||j)&&{display:"none"}}});return e.jsxs(te,{size:u?{xs:12,sm:12,md:12}:{xs:12,sm:C?12:6,md:C?6:3},children:[e.jsxs(ue,{children:[e.jsxs(D,{sx:{position:"relative",pt:"calc(100% * 3 / 4)",...(C||j)&&{pt:"calc(100% * 4 / 3)","&:after":{top:0,content:"''",width:"100%",height:"100%",position:"absolute",bgcolor:k=>N(k.palette.grey[900],.72)}},...C&&{pt:{xs:"calc(100% * 4 / 3)",sm:"calc(100% * 3 / 4.66)"}}},children:[_!==null&&_.roleid<3&&e.jsx(U,{onClick:w,sx:{zIndex:9,position:"absolute",top:24,right:20,width:40,height:40},children:e.jsx(v,{icon:"eva:more-vertical-fill",color:"white"})}),g,E,F]}),$]}),u&&e.jsx(D,{sx:{m:3,display:"flex",width:1,overflowX:"auto",overflowY:"auto"},children:e.jsx(ct,{value:c.content})}),_!==null&&_.roleid<3&&e.jsxs(be,{open:!!i,anchorEl:i,onClose:b,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{width:200}}},children:[e.jsxs(q,{onClick:I,children:[e.jsx(v,{icon:"eva:edit-fill",sx:{mr:2}}),f("Edit")]}),!d&&e.jsxs(q,{onClick:S,sx:{color:"error.main"},children:[e.jsx(v,{icon:"eva:trash-2-outline",sx:{mr:2}}),f("Delete")]}),d&&e.jsxs(q,{onClick:n,sx:{color:"error.main"},children:[e.jsx(v,{icon:"eva:question-mark-circle-outline",sx:{mr:2}}),f("_reallydelete_")]})]}),e.jsx(Zt,{title:f("_editpost_"),openUpdate:o,type:"update",updatepost:c,onCloseUpdate:T,handleUpdatePost:y})]})}function Qt({openCreate:t,onOpenCreate:s,onCloseCreate:n,handleBlogpostsReceived:i}){const{t:r}=L();return e.jsxs(e.Fragment,{children:[e.jsx(Q,{"data-testid":"blog_newblog_button",variant:"contained",color:"inherit",startIcon:e.jsx(v,{icon:"eva:plus-fill"}),onClick:s,children:r("_newpost_")}),e.jsxs(ae,{anchor:"right",open:t,onClose:n,slotProps:{paper:{sx:{width:1,border:"none",overflow:"auto"}}},children:[e.jsxs(R,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{px:1,py:2},children:[e.jsx(P,{variant:"h6",sx:{ml:1},children:r("_newpost_")}),e.jsx(U,{"data-testid":"blogpost_close_button",onClick:n,children:e.jsx(v,{icon:"eva:close-fill"})})]}),e.jsx(ne,{}),e.jsx(Yt,{type:"create",handleBlogpostsReceived:i})]})]})}Qt.propTypes={openCreate:O.bool.isRequired,onOpenCreate:O.func.isRequired,onCloseCreate:O.func.isRequired,handleBlogpostsReceived:O.func.isRequired};function xi(){const[t,s]=a.useState([]),{request:n,user:i}=K(),r=a.useRef(!1),[o,l]=a.useState(!1),u=a.useCallback(c=>{r.current=!0;const p=c.data.blogposts.map((f,_)=>({id:f.blogpostid,cover:`/assets/images/covers/cover_${ie(_+1,24)}.jpg`,title:f.title,content:f.content,createdAt:f.createdAt,public:f.public,author:{name:f.alias,avatarUrl:`/assets/images/avatars/avatar_${ie(f.userid,25)}.jpg`}}));s(p)},[s]);a.useEffect(()=>{r.current||n({event:"blogposts get all",data:{source:"Blog View",message:"Blog View  needs the list of blogposts"}},u)},[u,n]);const h=()=>{l(!0)},d=()=>{l(!1)},x=c=>{n({event:"blogpost delete",data:{source:"Blog View",message:"Blog View wants to delete a post",ids:[c]}},u)};return e.jsxs(_e,{children:[e.jsxs(R,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsx(P,{variant:"h4",children:"Blog"}),i.roleid<3&&e.jsx(Qt,{openCreate:o,onOpenCreate:h,onCloseCreate:d,handleBlogpostsReceived:u})]}),e.jsx(te,{container:!0,spacing:3,children:t.map((c,p)=>e.jsx(Xt,{blogpost:c,index:p,handleDeletePost:()=>x(c.id)},m()))})]})}function gi(){const{user:t}=K();return e.jsxs(e.Fragment,{children:[e.jsx(de,{children:e.jsx("title",{children:" Blog"})}),t?e.jsx(xi,{}):null]})}const mi=Object.freeze(Object.defineProperty({__proto__:null,default:gi},Symbol.toStringTag,{value:"Module"}));function fi(t,s){return t.sort((n,i)=>n[s]-i[s])}function bi(t,s){return t.sort((n,i)=>n[s].localeCompare(i[s]))}function yt(t,s,n){return t[n]===null?1:s[n]===null||s[n]<t[n]?-1:s[n]>t[n]?1:0}function es(t,s){return t==="desc"?(n,i)=>yt(n,i,s):(n,i)=>-yt(n,i,s)}function _i({inputData:t,comparator:s,filterName:n,field:i}){const r=t.map((o,l)=>[o,l]);return r.sort((o,l)=>{const u=s(o[0],l[0]);return u!==0?u:o[1]-l[1]}),t=r.map(o=>o[0]),n&&(t=t.filter(o=>o[i].toLowerCase().indexOf(n.toLowerCase())!==-1)),t}function ts(t,s,n){return t>0?Math.max(0,(1+t)*s-n):0}function ss({openCreate:t,onOpenCreate:s,onCloseCreate:n,handleUsersReceived:i}){const{t:r}=L();return e.jsxs(e.Fragment,{children:[e.jsx(Q,{"data-testid":"users_newuser_button",variant:"contained",color:"inherit",startIcon:e.jsx(v,{icon:"eva:plus-fill"}),onClick:s,children:r("_newuser_")}),e.jsxs(ae,{anchor:"right",open:t,onClose:n,slotProps:{paper:{sx:{width:300,border:"none",overflow:"hidden"}}},children:[e.jsxs(R,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{px:1,py:2},children:[e.jsx(P,{variant:"h6",sx:{ml:1},children:r("_newuser_")}),e.jsx(U,{"data-testid":"createuser_close_button",onClick:n,children:e.jsx(v,{icon:"eva:close-fill"})})]}),e.jsx(ne,{}),e.jsx(Qe,{type:"create",handleUsersReceived:i})]})]})}ss.propTypes={openCreate:O.bool.isRequired,onOpenCreate:O.func.isRequired,onCloseCreate:O.func.isRequired,handleUsersReceived:O.func.isRequired};function ns({query:t}){const{t:s}=L();return e.jsx(pe,{children:e.jsx(M,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(St,{sx:{textAlign:"center"},children:[e.jsx(P,{variant:"h6",paragraph:!0,children:s("_notfound_")}),e.jsxs(P,{variant:"body2",children:[s("_noresultsfor_")," ",e.jsxs("strong",{children:['"',t,'"']}),"."]})]})})})}ns.propTypes={query:O.string};const ji=({updateuser:t={updateuser:t}})=>{const{t:s}=L(),{request:n,devices:i}=K(),[r,o]=a.useState([]),[l,u]=a.useState({success:!0,message:""}),h=p=>{u({success:p.data.success,message:p.data.message})},d=p=>{p.preventDefault(),n({event:"user devices update",data:{source:"Devices Form",message:`Updating the devices of user ${t.alias}`,userid:t.userid,userdevices:r}},h)},x=a.useCallback(p=>{o(p.data.userdevices)},[]),c=p=>{const f=[...r];f.includes(p)?f.splice(f.findIndex(_=>_===p),1):f.push(p),o(f)};return a.useEffect(()=>{n({event:"user devices get all",data:{source:"Devices Form",message:"Devices Form needs the list of devices of a user",userid:t.userid}},x)},[x,n,t]),e.jsx(D,{component:"form",onSubmit:d,sx:{height:1},children:e.jsxs(R,{direction:"column",sx:{justifyContent:"space-between",m:2,height:1},children:[e.jsx(ke,{fullWidth:!0,size:"subtitle2",children:e.jsx(R,{spacing:.5,sx:{maxHeight:"99%",overflowY:"auto"},children:i.map(p=>e.jsx(fe,{value:p.id,control:e.jsx(re,{checked:r.includes(p.id)}),onChange:()=>c(p.id),label:p.cname},p.id))})}),e.jsx(P,{variant:"subtitle2",color:l.success?"success":"error",children:s(l.message)}),e.jsx(Q,{fullWidth:!0,size:"large",type:"submit",color:"inherit",variant:"outlined",startIcon:e.jsx(v,{icon:"formkit:submit"}),children:s("Save")})]})})};function yi({title:t,updateuser:s,openDevices:n,onCloseDevices:i}){return e.jsxs(ae,{anchor:"right",open:n,onClose:i,slotProps:{paper:{sx:{width:300,border:"none",overflow:"hidden"}}},children:[e.jsxs(R,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{px:1,py:2},children:[e.jsx(P,{variant:"h6",sx:{ml:1},children:`${t}: ${s.alias}`}),e.jsx(U,{onClick:i,children:e.jsx(v,{icon:"eva:close-fill"})})]}),e.jsx(ne,{}),e.jsx(ji,{updateuser:s})]})}function vi({userid:t,uuid:s,appUser:n,selected:i,alias:r,avatarUrl:o,firstname:l,lastname:u,roleid:h,role:d,email:x,home:c,handleClick:p,handleDeleteUser:f,handleUpdateUser:_}){const[C,j]=a.useState(null),[y,w]=a.useState(!1),{t:b}=L(),[T,I]=a.useState({open:!1,type:""}),[S,E]=a.useState({open:!1}),$=W=>{k(),I({open:!0,type:W})},F=()=>{I({open:!1,type:""})},g=W=>{j(W.currentTarget),w(!1)},k=()=>{j(null)},B=()=>{w(!0)},Y=()=>{k(),E({open:!0})},ee=()=>{E({open:!1})};return e.jsxs(e.Fragment,{children:[e.jsxs(pe,{"data-testid":"user_tablerow_component",hover:!0,tabIndex:-1,role:"checkbox",selected:i,children:[e.jsx(M,{padding:"checkbox",children:t!==1&&t!==n.userid&&(n.roleid===1||h!==1)&&e.jsx(re,{disableRipple:!0,checked:i,onChange:p})}),e.jsx(M,{component:"th",scope:"row",padding:"none",children:e.jsxs(R,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(me,{alt:r,src:o}),e.jsx(P,{variant:"subtitle2",noWrap:!0,children:r})]})}),e.jsx(M,{children:l}),e.jsx(M,{children:u}),e.jsx(M,{children:d}),e.jsx(M,{children:x}),e.jsx(M,{children:c}),e.jsx(M,{align:"right",children:e.jsx(U,{"data-testid":`user${t}_openmenue_button`,onClick:g,children:e.jsx(v,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(be,{open:!!C,anchorEl:C,onClose:k,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{width:200}}},children:[e.jsxs(q,{"data-testid":"user_editprofile_button",disabled:t===1&&n.userid!==1,onClick:()=>$("profile"),children:[e.jsx(v,{icon:"eva:edit-fill",sx:{mr:2}}),b("Edit")]}),h!==1&&e.jsxs(q,{onClick:()=>Y(),children:[e.jsx(v,{icon:"eva:edit-fill",sx:{mr:2}}),b("_assigndevices_")]}),!y&&t!==1&&t!==n.userid&&(n.roleid===1||h!==1)&&e.jsxs(q,{onClick:B,sx:{color:"error.main"},children:[e.jsx(v,{icon:"eva:trash-2-outline",sx:{mr:2}}),b("Delete")]}),y&&e.jsxs(q,{onClick:f,sx:{color:"error.main"},children:[e.jsx(v,{icon:"eva:question-mark-circle-outline",sx:{mr:2}}),b("_reallydelete_")]})]}),e.jsx(Wt,{title:b("_edituserprofile_"),openUpdate:T.open,type:T.type,updateuser:{alias:r,email:x,firstname:l,lastname:u,home:c,userid:t,roleid:h,role:d,uuid:s},onCloseUpdate:F,handleUpdateUser:_}),e.jsx(yi,{title:b("_assigndevices_"),updateuser:{alias:r,firstname:l,lastname:u,userid:t},openDevices:S.open,onCloseDevices:ee})]})}function wi({order:t,orderBy:s,rowCount:n,headLabel:i,numSelected:r,onRequestSort:o,onSelectAllClick:l}){const u=h=>d=>{o(d,h)};return e.jsx(kt,{children:e.jsxs(pe,{children:[e.jsx(M,{padding:"checkbox",children:e.jsx(re,{indeterminate:r>0&&r<n,checked:n>0&&r===n,onChange:l})}),i.map(h=>e.jsx(M,{align:h.align||"left",sortDirection:s===h.id?t:!1,sx:{width:h.width,minWidth:h.minWidth},children:e.jsxs(Pt,{hideSortIcon:!0,active:s===h.id,direction:s===h.id?t:"asc",onClick:u(h.id),children:[h.label,s===h.id?e.jsx(D,{sx:{...$t},children:t==="desc"?"sorted descending":"sorted ascending"}):null]})},h.id))]})})}function is({emptyRows:t,height:s}){return t?e.jsx(pe,{sx:{...s&&{height:s*t}},children:e.jsx(M,{colSpan:9})}):null}is.propTypes={emptyRows:O.number,height:O.number};function Ci({selected:t,filterName:s,onFilterName:n,placeholder:i,handleDeleteSelected:r,showReallyDelete:o,handleShowReallyDelete:l}){const{t:u}=L();return e.jsxs(Ve,{sx:{height:96,display:"flex",justifyContent:"space-between",p:h=>h.spacing(0,1,0,3),...t.length>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[t.length>0?e.jsxs(P,{component:"div",variant:"subtitle1",children:[t.length," ",u("selected")]}):e.jsx(Bs,{value:s,onChange:n,placeholder:i,startAdornment:e.jsx(Te,{position:"start",children:e.jsx(v,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),t.length>0&&!o&&e.jsx(ce,{title:u("Delete"),children:e.jsx(U,{onClick:()=>l(!0),children:e.jsx(v,{icon:"eva:trash-2-fill"})})}),t.length>0&&o&&e.jsx(Q,{color:"error",variant:"contained",startIcon:e.jsx(v,{icon:"eva:question-mark-circle-outline"}),onClick:()=>{r(),l(!1)},children:e.jsx(P,{variant:"subtitle1",children:u("_reallydelete_")})})]})}function Si(){const[t,s]=a.useState(0),[n,i]=a.useState([]),[r,o]=a.useState("asc"),[l,u]=a.useState([]),[h,d]=a.useState("name"),[x,c]=a.useState(""),[p,f]=a.useState(5),{t:_}=L(),{request:C,user:j}=K(),[y,w]=a.useState(!1),b=a.useRef(!1),[T,I]=a.useState(!1),[S,E]=a.useState([j.roleid===1&&j.userid!==1?n.length-2:n.length-1]),$=a.useCallback(A=>{const G=A.data.users.map((V,or)=>({userid:V.userid,uuid:V.uuid,avatarUrl:`/assets/images/avatars/avatar_${ie(V.userid,25)}.jpg`,alias:V.alias,firstname:V.firstname,lastname:V.lastname,role:V.rolename,email:V.email,home:V.home,roleid:V.roleid}));b.current=!0,i(G),E(j.roleid===1&&j.userid!==1?G.length-2:G.length-1),u([])},[j]),F=a.useCallback(A=>{const z=[...n],G=z.findIndex(V=>V.userid===A.userid);z[G]=A,z[G].avatarUrl=`/assets/images/avatars/avatar_${ie(A.userid,25)}.jpg`,i(z)},[n]),g=a.useCallback(A=>{A!==null&&F(A.detail)},[F]);a.useEffect(()=>(Et("userUpdated",g),b.current||C({event:"users get all",data:{source:"Users View",message:"User View needs the list of users"}},$),()=>{Dt("userUpdated")}),[C,g,$]);const k=()=>{w(!0)},B=()=>{w(!1)},Y=A=>{I(A)},ee=(A,z)=>{z!==""&&(o(h===z&&r==="asc"?"desc":"asc"),d(z))},W=A=>{if(A.target.checked){const z=n.filter(G=>G.userid!==1&&j.userid!==G.userid).map(G=>G.alias);u(z);return}u([]),I(!1)},H=(A,z)=>{const G=l.indexOf(z);let V=[];G===-1?V=V.concat(l,z):G===0?V=V.concat(l.slice(1)):G===l.length-1?V=V.concat(l.slice(0,-1)):G>0&&(V=V.concat(l.slice(0,G),l.slice(G+1))),u(V),I(!1)},oe=A=>{C({event:"user delete",data:{source:"Users View",message:"User View wants to delete a user",ids:[A]}},$)},se=()=>{const A=n.filter(z=>l.includes(z.alias)&&z.userid!==1).map(z=>z.userid);u([]),C({event:"user delete",data:{source:"Users View",message:"User View wants to delete users",ids:A}},$)},We=(A,z)=>{s(z)},fs=A=>{s(0),f(parseInt(A.target.value,10))},bs=A=>{s(0),c(A.target.value)},st=_i({inputData:n,comparator:es(r,h),filterName:x,field:"alias"}),_s=!st.length&&!!x;return e.jsxs(_e,{children:[e.jsxs(R,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsx(P,{variant:"h4",children:_("Users")}),e.jsx(ss,{openCreate:y,onOpenCreate:k,onCloseCreate:B,handleUsersReceived:$})]}),e.jsxs(ue,{children:[e.jsx(Ci,{selected:l,filterName:x,onFilterName:bs,placeholder:_("_searchuser_"),handleDeleteSelected:se,showReallyDelete:T,handleShowReallyDelete:Y}),e.jsx(Le,{children:e.jsx(Ft,{sx:{overflow:"unset"},children:e.jsxs(Rt,{sx:{minWidth:800},size:"small",children:[e.jsx(wi,{order:r,orderBy:h,rowCount:S,numSelected:l.length,onRequestSort:ee,onSelectAllClick:W,headLabel:[{id:"alias",label:_("Alias")},{id:"firstname",label:_("Firstname")},{id:"lastname",label:_("Lastname")},{id:"role",label:_("Role")},{id:"email",label:_("Email")},{id:"home",label:_("Home")},{id:""}]}),e.jsxs(It,{children:[st.slice(t*p,t*p+p).map(A=>e.jsx(vi,{appUser:j,userid:A.userid,uuid:A.uuid,alias:A.alias,firstname:A.firstname,lastname:A.lastname,role:A.role,email:A.email,home:A.home,roleid:A.roleid,avatarUrl:A.avatarUrl,selected:l.indexOf(A.alias)!==-1,handleClick:z=>H(z,A.alias),handleDeleteUser:()=>oe(A.userid),handleUpdateUser:F},A.userid)),e.jsx(is,{height:77,emptyRows:ts(t,p,n.length)}),_s&&e.jsx(ns,{query:x})]})]})})}),e.jsx(Ot,{page:t,component:"div",count:n.length,rowsPerPage:p,onPageChange:We,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:fs,labelRowsPerPage:_("_rowsperpage_"),labelDisplayedRows:({from:A,to:z,count:G})=>`${A}${z} ${_("of")} ${G!==-1?G:`${_("_morethan_")} ${z}`}`})]})]})}function ki(){const{user:t}=K();return e.jsxs(e.Fragment,{children:[e.jsx(de,{children:e.jsx("title",{children:" User"})}),t?e.jsx(Si,{}):null]})}const Pi=Object.freeze(Object.defineProperty({__proto__:null,default:ki},Symbol.toStringTag,{value:"Module"}));function $i(){const t=["Plus1PM","Plus1PMMini","PlusI4","PlusRGBWPM","SHBDUO-1","SHPLG-S"],[s,n]=a.useState(0),i=r=>{n(r)};return e.jsx("div",{children:e.jsx(sn,{index:s,onChange:i,interval:4e3,animation:"fade",indicators:!0,stopAutoPlayOnHover:!0,children:t.map(r=>e.jsx(D,{component:"img",src:`/assets/images/devices/${r}.png`,sx:{width:200,hight:200,objectFit:"scale-down"}},m()))})})}function Fi(){const t=Se();return e.jsx(D,{display:"flex",justifyContent:"center",alignItems:"center",sx:{...Fn({color:N(t.palette.background.default,.9),imgUrl:"/assets/background/overlay_4.jpg"}),height:1},children:e.jsx(ue,{sx:{p:5,width:1,maxWidth:420},children:e.jsxs(R,{sx:{alignItems:"center",justifyContent:"center",height:1},children:[e.jsx(Be,{sx:{mt:3}}),e.jsx($i,{}),e.jsx(Qe,{type:"login"})]})})})}function Ri(){return e.jsxs(e.Fragment,{children:[e.jsx(de,{children:e.jsx("title",{children:" Login"})}),e.jsx(Fi,{})]})}const Ii=Object.freeze(Object.defineProperty({__proto__:null,default:Ri},Symbol.toStringTag,{value:"Module"}));function Oi(){const[t,s]=a.useState([]),{request:n}=K(),i=a.useRef(!1),r=Ae(),o=a.useCallback(u=>{if(i.current=!0,u.data.blogposts.length>0){const h=u.data.blogposts.map((d,x)=>({id:d.blogpostid,cover:`/assets/images/covers/cover_${ie(x+1,24)}.jpg`,title:d.title,content:d.content,createdAt:d.createdAt,view:23,comment:45,share:45,favorite:5,author:{name:d.alias,avatarUrl:`/assets/images/avatars/avatar_${ie(d.userid,25)}.jpg`}}));s(h)}else r("/login")},[s,r]);a.useEffect(()=>{i.current||n({event:"blogposts get public",data:{name:"LandingView",message:"LandingView  needs the list of public blogposts"}},o)},[o,n]);const l=()=>{r("/login")};return e.jsxs(_e,{children:[e.jsx(D,{sx:{flexGrow:1},children:e.jsxs(R,{direction:"row",spacing:10,sx:{justifyContent:"space-between"},children:[e.jsx(Be,{sx:{mt:3}}),e.jsx(R,{direction:"row",sx:{alignItems:"center"},children:e.jsxs(U,{"data-testid":"landing_login_button",onClick:l,sx:{pt:3},"aria-label":"Login",children:[e.jsx(v,{icon:"eva:lock-fill"}),e.jsx(P,{variant:"h6",children:"Login"})]})})]})}),e.jsx(te,{container:!0,spacing:3,sx:{pt:5},children:t.map((u,h)=>e.jsx(Xt,{blogpost:u,index:h},m()))})]})}function Ti(){return e.jsxs(e.Fragment,{children:[e.jsx(de,{children:e.jsx("title",{children:" S-Central"})}),e.jsx(Oi,{})]})}const Ei=Object.freeze(Object.defineProperty({__proto__:null,default:Ti},Symbol.toStringTag,{value:"Module"})),rs=({online:t})=>e.jsx(v,{icon:t?"material-symbols:wifi":"material-symbols:wifi-off",sx:{color:t?"green":"red"}});rs.propTypes={online:O.bool.isRequired};function os({ip:t,switches:s,handleClick:n}){return typeof s>"u"?null:s.map((i,r)=>(i.ip=t,i.index=r,e.jsx(ce,{title:`Switch ${i.id}`,children:e.jsx(v,{icon:"icomoon-free:switch",sx:{cursor:"pointer",color:i.output?"green":"black"},onClick:()=>n(i)},m())},m())))}os.propTypes={ip:O.string.isRequired,switches:O.array,handleClick:O.func.isRequired};const Di=({device:t,handleSwitchToggle:s})=>{const[n,i]=a.useState(t.switches),r=o=>{o.output=!o.output,t.switches[o.index]=o,i([...t.switches]),s(o)};return e.jsxs(e.Fragment,{children:[e.jsxs(R,{direction:"row",sx:{minHeight:35,maxHeight:35,pr:1,pl:1,alignItems:"center",justifyContent:"space-between"},children:[e.jsx(rs,{online:t.online}),e.jsx(os,{ip:t.ip,switches:n,handleClick:r})]}),e.jsx(Je,{title:e.jsx(Ge,{href:`http://${t.ip}`,target:"_blank",color:"inherit",underline:"hover",children:t.cname.substring(0,14)}),subheader:`${t.name} ${t.gen>0?`(Gen ${t.gen})`:""}`,sx:{minWidth:200,minHeight:50,maxHeight:50,pt:1}}),e.jsx(Ls,{sx:{minWidth:160,maxWidth:160,minHeight:120,objectFit:"scale-down"},image:t.image,title:t.name,component:"img",alt:t.name})]})},Ai=({scripts:t})=>typeof t>"u"?null:t.map(s=>s?.logmessages?.length>0?e.jsxs(R,{spacing:0,children:[e.jsx(P,{variant:"subtitle2",children:s.name},m()),s.logmessages.map(n=>{const i=new Date(n.ts*1e3).toTimeString().substring(0,8);return e.jsxs(R,{direction:"row",spacing:1,sx:{minWidth:0},children:[e.jsx(P,{variant:"caption",children:i},m()),e.jsx(P,{variant:"caption",noWrap:!0,children:n.msg},m())]},m())})]},m()):null),Ni=a.forwardRef(({colors:t,selected:s,onSelectColor:n,limit:i="auto",sx:r,...o},l)=>{const u=typeof s=="string",h=a.useCallback(d=>{if(u)d!==s&&n(d);else{const x=s.includes(d)?s.filter(c=>c!==d):[...s,d];n(x)}},[n,s,u]);return e.jsx(R,{ref:l,direction:"row",display:"inline-flex",sx:{flexWrap:"wrap",...i!=="auto"&&{width:i*36,justifyContent:"flex-end"},...r},...o,children:t.map(d=>{const x=u?s===d:s.includes(d);return e.jsx(Ws,{sx:{width:36,height:36,borderRadius:"50%"},onClick:()=>{h(d)},children:e.jsx(R,{alignItems:"center",justifyContent:"center",sx:{width:20,height:20,bgcolor:d,borderRadius:"50%",border:c=>`solid 1px ${N(c.palette.grey[500],.16)}`,...x&&{transform:"scale(1.3)",boxShadow:`4px 4px 8px 0 ${N(d,.48)}`,outline:`solid 2px ${N(d,.08)}`,transition:c=>c.transitions.create("all",{duration:c.transitions.duration.shortest})}},children:e.jsx(v,{width:x?12:0,icon:"eva:checkmark-fill",sx:{color:c=>c.palette.getContrastText(d),transition:c=>c.transitions.create("all",{duration:c.transitions.duration.shortest})}})})},d)})})});Ni.propTypes={colors:O.oneOfType([O.string,O.arrayOf(O.string)]),limit:O.number,onSelectColor:O.func,selected:O.oneOfType([O.string,O.arrayOf(O.string)]),sx:O.object};function tt({colors:t,limit:s=3,sx:n}){const i=t.slice(0,s),r=t.length-s;return e.jsxs(R,{component:"span",direction:"row",alignItems:"center",justifyContent:"flex-end",sx:n,children:[i.map((o,l)=>e.jsx(D,{sx:{ml:-.75,width:16,height:16,bgcolor:o,borderRadius:"50%",border:u=>`solid 2px ${u.palette.background.paper}`,boxShadow:u=>`inset -1px 1px 2px ${N(u.palette.common.black,.24)}`}},o+l)),t.length>s&&e.jsx(D,{component:"span",sx:{typography:"subtitle2"},children:`+${r}`})]})}tt.propTypes={colors:O.arrayOf(O.string),limit:O.number,sx:O.object};const vt=["#00AB55","#D22B2B","#000000"];function as({kvs:t}){return t.map(s=>{const n=typeof s.display<"u"?s.display:s.key,i=()=>{switch(typeof s.style<"u"?s.style:s.value){case"boolean":return Number(s.value)===1?"true":"false";case"color":return e.jsx(tt,{colors:Number(s.value)===1?vt.slice(0,1):vt.slice(1,2),sx:{pt:"5px"}},m());default:return s.value}};return e.jsxs(R,{direction:"row",justifyContent:"space-between",style:{gap:20},useFlexGap:!0,flexWrap:"wrap",children:[e.jsx(P,{variant:"caption",sx:{minWidth:100},children:n.substring(0,14)},m()),e.jsx(P,{variant:"caption",children:i()},m())]},m())})}as.propTypes={kvs:O.array.isRequired};const Bi=({device:t,handleSwitchSet:s})=>{const[n,i]=a.useState(t.switches),{t:r}=L(),o=n.find(w=>typeof w.brightness<"u"),l=n.find(w=>typeof w.white<"u"),u=n.find(w=>typeof w.rgb<"u"),[h,d]=a.useState(typeof u<"u"?`rgb (${u.rgb[0]}, ${u.rgb[1]}, ${u.rgb[2]})`:"rgb (255, 0, 0)"),[x,c]=a.useState(typeof o<"u"?o.brightness:0),[p,f]=a.useState(typeof l<"u"?l.white:0),_=a.useMemo(()=>nn(s,30,{leading:!1,trailing:!0}),[s]),C=(w,b)=>{d(w),u.rgb=b.rgb,_(u)},j=(w,b)=>{c(b),o.brightness=b,_(o)},y=(w,b)=>{f(b),l.white=b,_(l)};return a.useEffect(()=>{i(t.switches)},[t,i]),e.jsxs(R,{alignItems:"flex-start",children:[typeof o<"u"&&e.jsxs(e.Fragment,{children:[e.jsx(P,{variant:"subtitle",children:r("Brightness")}),e.jsx(ot,{"data-testid":"shelly_brightness_slider",value:x,min:0,max:100,step:10,marks:!0,valueLabelDisplay:"auto",size:"small",onChange:j,"aria-label":"Brighness slider"})]}),typeof l<"u"&&e.jsxs(e.Fragment,{children:[e.jsx(P,{variant:"subtitle",children:r("White")}),e.jsx(ot,{"data-testid":"shelly_white_slider",value:p,min:0,max:t.gen===1?100:255,step:t.gen===1?10:25,marks:!0,valueLabelDisplay:"auto",size:"small",onChange:y,"aria-label":"White slider"})]}),typeof u<"u"&&e.jsx(ln,{"data-testid":"shelly_multicolor_input",format:"rgb",isAlphaHidden:!0,value:h,onChange:C,size:"small",variant:"outlined","aria-label":"Color Selection",sx:{pt:1}})]})},qe=({white:t})=>e.jsxs(R,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:.5,children:[e.jsx(v,{icon:"stash:circle-dot"},m()),e.jsx(P,{variant:"caption",children:t},m())]},m());qe.propTypes={white:O.number};const ls=({data:t})=>{if(typeof t.motion<"u")return e.jsx(v,{icon:Number(t.motion)===1?"material-symbols:directions-walk":"fa6-solid:person",sx:{color:Number(t.motion)===1?"blue":"black"}},m());if(typeof t.window<"u")return Number(t.window)===1?e.jsx(v,{icon:"material-symbols:door-open-rounded",sx:{color:"black"}},m()):e.jsx(v,{icon:"material-symbols:door-front-rounded",sx:{color:"black"}},m());if(typeof t.button<"u")switch(Number(t.button)){case 1:return e.jsx(v,{icon:"mdi:number-1-box",sx:{color:"blue"}},m());case 2:return e.jsx(v,{icon:"mdi:number-2-box",sx:{color:"blue"}},m());case 3:return e.jsx(v,{icon:"mdi:number-3-box",sx:{color:"blue"}},m());case 4:return e.jsx(v,{icon:"mdi:number-4-box",sx:{color:"blue"}},m());case 254:return e.jsx(v,{icon:"f7:hand-point-left-fill",sx:{color:"blue"}},m());default:return e.jsx(v,{icon:"f7:hand-point-left-fill",sx:{color:"blue"}},m())}return e.jsx(v,{icon:"material-symbols:event-busy",sx:{color:"black"}},m())};ls.propTypes={data:O.object.isRequired};const cs=({event:t})=>{let s;switch(Number(t.id)){case 0:s=180;break;case 1:s=270;break;case 2:s=90;break;default:s=0}return e.jsxs(R,{direction:"row",children:[e.jsx(v,{icon:"system-uicons:grid-squares-add",sx:{color:"black"},className:`rotate${s}`},m()),t.event==="single_push"&&e.jsx(v,{icon:"mdi:number-1-box",sx:{color:"blue"}},m()),t.event==="double_push"&&e.jsx(v,{icon:"mdi:number-2-box",sx:{color:"blue"}},m()),t.event==="triple_push"&&e.jsx(v,{icon:"mdi:number-3-box",sx:{color:"blue"}},m()),(t.event==="long_push"||t.event==="btn_up")&&e.jsx(v,{icon:"f7:hand-point-left-fill",sx:{color:"blue"}},m())]},m())};cs.propTypes={event:O.object.isRequired};const ds=({events:t})=>{const s=t.map(n=>n.event==="shelly-blu"&&typeof n.data<"u"?e.jsx(ls,{data:n.data},m()):["single_push","double_push","triple_push","long_push"].includes(n.event)?e.jsx(cs,{event:n},m()):n.event==="btn_up"||n.event==="btn_down"?null:n.event==="scheduled_restart"?e.jsx(v,{icon:"solar:restart-square-bold",sx:{color:"black"}},m()):e.jsx(v,{icon:"ic:sharp-help",sx:{color:"black"}},m()));return s.length>0?s:e.jsx(v,{icon:"mdi:bug",sx:{color:"red"}},m())};ds.propTypes={events:O.array.isRequired};const He=({consume:t})=>e.jsxs(R,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:.5,children:[e.jsx(v,{icon:"material-symbols-light:bolt",sx:{color:+(t>0)?"blue":"black"}},m()),e.jsx(P,{variant:"caption",children:Ce(t)},m())]},m());He.propTypes={consume:O.number.isRequired};const us=({params:t})=>{const s=[];return Object.keys(t).forEach(i=>{if(i.startsWith("script")){const r=t[i];s.push(e.jsxs(R,{justifyContent:"flex-start",alignItems:"center",spacing:.5,direction:"row",children:[e.jsxs(P,{variant:"subtitle2",color:r.running?"green":"red",children:["{",r.id,"}"]},m()),e.jsxs(P,{variant:"caption",children:[Math.round(Number(r.mem_free)/1024)," kb free"]},m())]},m()))}}),s};us.propTypes={params:O.object.isRequired};const Li=({version:t})=>e.jsxs(R,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:.5,children:[e.jsx(v,{icon:"material-symbols:system-update-alt",sx:{color:"green"}},m()),e.jsx(P,{variant:"caption",children:t},m())]},m()),wt=({brightness:t})=>e.jsxs(R,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:.5,children:[e.jsx(v,{icon:"subway:black-white",width:18,height:18},m()),e.jsxs(P,{variant:"caption",children:[t,"%"]},m())]},m()),ps=({sys:t})=>e.jsxs(R,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:.5,children:[e.jsx(v,{icon:"material-symbols-light:sd",sx:{color:"black"}},m()),e.jsxs(P,{variant:"caption",children:[Math.round(Number(t.ram_free)/1024)," kb free"]},m()),e.jsx(v,{icon:"material-symbols:storage-rounded",sx:{color:"black"}},m()),e.jsxs(P,{variant:"caption",children:[Math.round(Number(t.fs_free)/1024)," kb free"]},m())]},m());ps.propTypes={sys:O.object.isRequired};const Wi=({deviceName:t,wsMessage:s})=>{const{params:n}=s;if(typeof n>"u")return[];const i=[];let r;if(s.method!=="NotifyEvent"&&(r=Kt(t,n)),s.method==="NotifyFullStatus"){if(typeof n?.sys<"u"&&i.push(e.jsx(ps,{sys:n.sys},m())),typeof n?.cloud?.connected<"u"&&i.push(e.jsx(v,{icon:"material-symbols-light:cloud",sx:{color:n.cloud.connected?"green":"black"}},m())),typeof n?.sys?.available_updates?.stable?.version<"u"&&i.push(e.jsx(Li,{version:n.sys.available_updates.stable.version},m())),i.push(e.jsx(us,{params:s.params},m())),r.hasSwitch&&i.push(e.jsx(He,{consume:r.totalPower},m())),typeof n["rgbw:0"]?.brightness<"u"&&i.push(e.jsx(wt,{brightness:n["rgbw:0"].brightness},m())),typeof n["switch:0"]?.brightness<"u"&&i.push(e.jsx(wt,{brightness:n["switch:0"].brightness},m())),typeof n["rgbw:0"]?.white<"u"&&i.push(e.jsx(qe,{white:n["rgbw:0"].white},m())),typeof n["switch:0"]?.white<"u"&&i.push(e.jsx(qe,{white:n["switch:0"].white},m())),typeof n["rgbw:0"]?.rgb<"u"){const{rgb:o}=n["rgbw:0"],l=`rgb(${o[0]}, ${o[1]}, ${o[2]})`;i.push(e.jsx(v,{icon:"material-symbols:light-mode",sx:{color:l}},m()))}}else s.method==="NotifyStatus"?r.hasSwitch&&i.push(e.jsx(He,{consume:r.totalPower},m())):s.method==="NotifyEvent"?typeof n?.events<"u"&&i.push(e.jsx(ds,{events:n.events},m())):i.push(e.jsx(v,{icon:"ic:sharp-help",sx:{color:"black"}},m()));return i},hs=({ts:t})=>e.jsx(P,{variant:"subtitle2",children:Lt(t,"HH:mm")},m());hs.propTypes={ts:O.number.isRequired};const Ui=({deviceName:t,wsmessages:s})=>typeof s>"u"?null:Object.keys(s).map(i=>{const r=s[i];return e.jsxs(a.Fragment,{children:[e.jsxs(R,{direction:"row",justifyContent:"left",alignItems:"center",spacing:2,children:[typeof r?.params?.ts<"u"&&e.jsx(hs,{ts:r.params.ts},m()),e.jsx(P,{variant:"subtitle2",children:i},m()),e.jsx(Wi,{deviceName:t,wsMessage:r},m())]},m()),e.jsx(P,{variant:"caption",children:JSON.stringify(r)},m())]},m())}),ge=["#00AB55","#D22B2B","#000000"],xs=({deviceIP:t,deviceOnline:s,scripts:n})=>{if(typeof n>"u"||n==null||typeof n[Symbol.iterator]!="function")n=[{name:"n/a",colors:ge.slice(-1)},{name:"n/a",colors:ge.slice(-1)},{name:"n/a",colors:ge.slice(-1)}];else{n=[...n];for(let i=0;i<=2;i+=1)typeof n[i]>"u"?n.push({name:"n/a",colors:ge.slice(-1)}):n[i].colors=n[i].running&&s?ge.slice(0,1):ge.slice(1,2)}return n.map(i=>e.jsx(a.Fragment,{children:e.jsxs(R,{direction:"row",style:{gap:20},useFlexGap:!0,flexWrap:"wrap",children:[e.jsx(Ge,{href:i.id!==0?`http://${t}/#/script/${i.id}`:`http://${t}/#/scripts`,target:"_blank",color:"inherit",underline:"hover",variant:"subtitle2",noWrap:!0,sx:{minWidth:100},children:e.jsx(P,{noWrap:!0,variant:"caption",children:i.name.substring(0,14)},m())}),e.jsx(tt,{colors:i.colors,sx:{pt:"5px"}},m())]},m())},m()))};xs.propTypes={deviceIP:O.string.isRequired,deviceOnline:O.bool.isRequired,scripts:O.array.isRequired};function zi(t,s){let n=!t.online;if(typeof t.scripts<"u"){let i;Object.values(t.scripts).forEach(r=>{i=s[`script:${r.id}`],r.running!==i.running&&(n=!0,r.running=i.running)})}if(typeof t.switches<"u"){let i;t.switches.forEach(r=>{i=s[`switch:${r.id}`]||s[`rgbw:${r.id}`];const o=typeof r.ts>"u"||s.ts*1e3>r.ts;typeof i<"u"&&o&&(r.output!==i.output&&(n=!0,r.output=i.output,console.log(`Switch ${r.key} of device ${t.cname} output was set to ${r.output}`)),r.brightness!==i.brightness&&(n=!0,r.brightness=i.brightness,console.log(`Switch ${r.key} of device ${t.cname} brightness was set to ${r.brightness}`)),r.white!==i.white&&(n=!0,r.white=i.white,console.log(`Switch ${r.key} of device ${t.cname} white was set to ${r.white}`)),Tt(r.rgb,i.rgb)||(n=!0,r.rgb=i.rgb,console.log(`Switch ${r.key} of device ${t.cname} rgb was set to ${r.rgb}`)))})}return n?{...t}:null}const Mi=Ne(t=>{const{expand:s,...n}=t;return e.jsx(U,{"data-testid":"shelly_openkvs_button",...n})})(({theme:t,expand:s})=>({transform:s?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest})})),qi=({deviceId:t,deviceGen:s,type:n})=>{const[i,r]=a.useState(!1),[o,l]=a.useState(),[u,h]=a.useState([]),[d,x]=a.useState({}),[c,p]=a.useState([]),{request:f,subscribe:_,unsubscribe:C,send:j}=K(),y=a.useCallback(S=>{const E=S.data.device;l(()=>E),h(()=>E.scripts),x(()=>E.wsmessages),p(()=>E.kvs)},[]),w=a.useCallback(S=>{const E=S.type,$=S.data.device;switch($.cname==="Flur2"&&console.log(JSON.stringify($)),E){case"script":h(()=>$.scripts);break;case"kvs":p(()=>$.kvs);break;case"log":h(()=>$.scripts);break;case"ws":{const F=$?.wsmessages?.NotifyFullStatus?.params;if(typeof F<"u"){const g=zi($,F);g!==null&&l(()=>g)}x(()=>$.wsmessages);break}default:l(()=>$)}},[l,h,x,p]);a.useEffect(()=>{if(s!==0&&(_({subscriptionID:t,callback:w,all:!1},["ShellyUpdate"]),!(typeof o<"u")))return f({event:"device get",data:{source:"ShellyCard",message:"ShellyCard needs a device",deviceId:t}},y),()=>{C(t,["ShellyUpdate"])}},[o,f,_,C,w,y]);const b=()=>{r(!i)},T=S=>{S.ts=Date.now(),j({event:"toggleSwitch",data:{name:"Shelly Device",message:`${o.cname} wants to toggle a switch`,switch:S}})},I=S=>{if(S.ts=Date.now(),typeof S.rgb<"u"&&!(S.rgb instanceof Array)){let E=S.rgb.substring(S.rgb.indexOf("(")+1,S.rgb.indexOf(")")).split(",");E=E.map($=>Number($)),S.rgb=E}j({event:"setSwitch",data:{name:"Shelly Device",message:`${o.cname} wants to toggle a switch`,switch:S}})};return typeof o>"u"?null:e.jsx(ue,{raised:!0,children:e.jsxs(R,{direction:n==="ctrl"?"column":"row",children:[e.jsxs(R,{children:[e.jsx(Di,{device:o,handleSwitchToggle:T}),n==="sk"&&e.jsxs(e.Fragment,{children:[e.jsx(Fe,{sx:{minWidth:200,pt:0},children:e.jsx(R,{justifyContent:"left",alignItems:"flex-start",children:e.jsx(xs,{deviceIP:o.ip,deviceOnline:o.online,scripts:u})})}),e.jsxs(Us,{disableSpacing:!0,children:[e.jsx(U,{href:`http://${o.ip}/#/key-value-store`,target:"_blank","aria-label":"show KVS entries",children:e.jsx(v,{icon:"material-symbols:storage-rounded",sx:{color:o?.kvs?.length===0?"grey":"green"}},m())}),e.jsx(Mi,{disabled:o?.kvs?.length===0,onClick:b,expand:i,"aria-expanded":i,"aria-label":"show KVS entries",children:e.jsx(v,{icon:"mdi:expand-more",sx:{color:"gray"}},m())})]}),e.jsx(zs,{in:i,timeout:"auto",mountOnEnter:!0,unmountOnExit:!0,children:e.jsx(Fe,{sx:{pt:0},children:e.jsx(R,{justifyContent:"left",alignItems:"flex-start",children:e.jsx(as,{kvs:c})})})})]})]}),n==="ws"&&e.jsx(Fe,{sx:{display:"flex",width:1,overflowX:"auto",overflowY:"auto"},children:e.jsx(R,{children:e.jsx(Ui,{deviceName:o.name,wsmessages:d})})}),n==="log"&&e.jsx(Fe,{sx:{display:"flex",width:1,overflowX:"auto",overflowY:"auto"},children:e.jsx(R,{children:e.jsx(Ai,{scripts:u})})}),n==="ctrl"&&e.jsx(D,{bgcolor:"white",sx:{minWidth:230,maxWidth:230,maxHeight:180,minHeight:180,mb:2,pl:2,pr:2},children:e.jsx(Bi,{device:o,handleSwitchSet:I})})]})})},Hi=a.memo(qi);function gs({type:t,title:s,openWifi:n,row:i,onCloseWifi:r,selected:o}){const[l,u]=a.useState(t==="single"?{}:{ssid:"",password:"",ap:{enabled:!1}}),[h,d]=a.useState(!1),[x,c]=a.useState({success:!0,message:"",successful:0,total:0}),{t:p}=L(),{request:f}=K(),_=a.useCallback(w=>{u(w.data.wifisettings)},[]),C=a.useCallback(w=>{c({success:w.data.success,successful:w.data.successful,total:w.data.total,message:w.data.message})},[]);a.useEffect(()=>{n&&t==="single"&&dt.isEmpty(l)&&f({event:"device get wifi settings",data:{source:"Wifi Form",message:"Wifi Form needs the wifi settings of a device",deviceId:i.id}},_)},[i,_,f,n,t,l]);const j=w=>{w.preventDefault(),f({event:"device wifi update",data:{source:"Wifi Form",message:"Updating the wifi settings",wifiSettings:l,ids:t==="single"?[i.id]:o}},C)},y=w=>{const b={...l};b[w.target.name]=w.target.value,u(b)};return dt.isEmpty(l)?null:e.jsxs(ae,{anchor:"right",open:n,onClose:r,slotProps:{paper:{sx:{width:300,border:"none",overflow:"hidden"}}},children:[e.jsxs(R,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{px:1,py:2},children:[e.jsx(P,{variant:"h6",sx:{ml:1},children:s}),e.jsx(U,{"data-testid":"device_closewifi_button",onClick:r,children:e.jsx(v,{icon:"eva:close-fill"})})]}),e.jsx(P,{variant:"subtitle2",color:"error",sx:{ml:1},children:p("_wifiwarming_")}),e.jsx(ne,{}),e.jsx(ke,{fullWidth:!0,size:"subtitle2",children:e.jsx(D,{component:"form",onSubmit:j,sx:{display:"flex",flexDirection:"column",gap:2},children:e.jsxs(R,{spacing:3,sx:{px:3,py:3},children:[e.jsx(X,{required:!0,autoComplete:"off",label:"SSID",name:"ssid",value:l.ssid,onChange:y,slotProps:{htmlInput:{"data-testid":"wifi_ssid_input"}}}),e.jsx(X,{required:!0,name:"password",autoComplete:"new-password",label:p("Password"),onChange:y,type:h?"text":"password",slotProps:{input:{endAdornment:e.jsx(Te,{position:"end",children:e.jsx(U,{onClick:()=>d(!h),edge:"end",children:e.jsx(v,{icon:h?"eva:eye-fill":"eva:eye-off-fill"})})})},htmlInput:{minLength:8,maxLength:63}}}),t==="single"&&e.jsxs(e.Fragment,{children:[e.jsx(X,{disabled:!0,label:"IP",name:"ip",value:l.ip}),e.jsx(X,{disabled:!0,label:"Mode",name:"ipv4mode",value:l.ipv4mode}),e.jsx(X,{disabled:!0,label:"Gatway",name:"gw",value:l.gw}),e.jsx(X,{disabled:!0,label:"Mask",name:"netmask",value:l.netmask}),e.jsx(X,{disabled:!0,label:"DNS",name:"nameserver",value:l.nameserver!=null?l.nameserver:""})]}),e.jsx(fe,{required:!0,control:e.jsx(re,{color:"error"}),label:p("_acceptrisk_")}),e.jsx(P,{variant:"subtitle2",color:x.success?"success":"error",children:p(x.message,{successful:x.successful,total:x.total})}),e.jsx(Q,{fullWidth:!0,size:"large",type:"submit",color:"inherit",variant:"outlined",startIcon:e.jsx(v,{icon:"formkit:submit"}),children:p("Save")})]})})})]})}function Gi({row:t,labelId:s,isItemSelected:n,handleClick:i,handleRebootDevices:r,handleFirmwareUpdates:o,updateRow:l}){const{t:u}=L(),{request:h,subscribe:d,unsubscribe:x}=K(),[c,p]=a.useState(t),[f,_]=a.useState(null),[C,j]=a.useState({open:!1}),y=()=>{j({open:!0})},w=()=>{j({open:!1})},b=S=>{S.stopPropagation(),_(S.currentTarget)},T=S=>{switch(S){case"reboot":{r([c.id]);break}case"stable":{o("stable",[c.id]);break}case"beta":{o("beta",[c.id]);break}case"wifi":{y();break}}_(null)},I=a.useCallback(S=>{const E=S.data.device;if(E.gen>0){const $=E?.wsmessages?.NotifyFullStatus?.params?.sys,F={id:E.id,image:E.image,name:E.cname.substring(0,14),model:E.name,gen:E.gen,uptime:$?.uptime,restart:E.rebootPending?"reboot pending":$?.restart_required,firmware:E.fw_id,stable:E.updateStablePending?"stable pending":E.stable,beta:E.updateBetaPending?"beta pending":E.beta};l(F),p(F)}},[p,l]);return a.useEffect(()=>{if(h({event:"device get",data:{source:"ShellyCard",message:"ShellyCard needs a device",deviceId:t.id}},I),t.gen!==0)return d({subscriptionID:t.id,callback:I,all:!1},["ShellyUpdate"]),()=>{x(t.id,["ShellyUpdate"])}},[t,d,x,I]),e.jsxs(e.Fragment,{children:[e.jsxs(pe,{hover:!0,onClick:S=>i(S,c.id),role:"checkbox","aria-checked":n,tabIndex:-1,selected:n,sx:{cursor:"pointer"},children:[e.jsx(M,{padding:"checkbox",children:e.jsx(re,{color:"primary",checked:n})}),e.jsx(M,{align:"right",sx:{minWidth:70,maxWidth:70,objectFit:"scale-down"},children:e.jsx("img",{src:t.image,alt:t.name})}),e.jsx(M,{component:"th",id:s,scope:"row",padding:"none",children:e.jsx(P,{children:t.name})}),e.jsx(M,{align:"left",children:e.jsxs(P,{children:[c.model," "]})}),e.jsx(M,{align:"left",children:e.jsx(P,{children:c.gen})}),e.jsx(M,{align:"left",children:e.jsx(P,{children:On(c.uptime)})}),e.jsx(M,{align:"left",children:e.jsx(P,{color:c.restart==="reboot pending"?"success":"string",children:c.restart==="reboot pending"?u("_rebootpending_"):c.restart?u("_required_"):u("_notrequired_")})}),e.jsx(M,{align:"left",children:e.jsx(P,{children:typeof c.firmware>"u"?"--":c.firmware.substring(c.firmware.lastIndexOf("/")+1,c.firmware.length)})}),e.jsx(M,{align:"left",children:e.jsx(P,{color:c.stable==="stable pending"?"success":"string",children:typeof c.stable>"u"?"--":c.stable==="stable pending"?u("_stablepending_"):c.stable.substring(c.stable.lastIndexOf("/")+1)})}),e.jsx(M,{align:"left",children:e.jsx(P,{color:c.beta==="beta pending"?"success":"string",children:typeof c.beta>"u"?"--":c.beta==="beta pending"?u("_betapending_"):c.beta.substring(c.beta.lastIndexOf("/")+1)})}),e.jsx(M,{align:"right",children:e.jsx(U,{"data-testid":`device${c.id}_openmenue_button`,onClick:b,children:e.jsx(v,{icon:"eva:more-vertical-fill"})})})]},c.id),e.jsxs(be,{open:!!f,anchorEl:f,onClose:T,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{width:300}}},children:[e.jsxs(q,{onClick:()=>{T("stable")},disabled:typeof c.stable>"u",children:[e.jsx(v,{icon:"material-symbols:system-update-alt",sx:{color:"green",mr:2}}),u("_firmwarestable_")]}),e.jsxs(q,{onClick:()=>{T("beta")},disabled:typeof c.beta>"u",children:[e.jsx(v,{icon:"material-symbols:system-update-alt",sx:{color:"red",mr:2}}),u("_firmwarebeta_")]}),e.jsxs(q,{onClick:()=>{T("reboot")},children:[e.jsx(v,{icon:"ix:reboot",sx:{mr:2}}),u("Reboot")]}),e.jsxs(q,{"data-testid":`device${c.id}_openwifi_button`,onClick:()=>T("wifi"),children:[e.jsx(v,{icon:"material-symbols:wifi",sx:{mr:2}}),"Wifi"]})]}),e.jsx(gs,{type:"single",title:`Wifi ${c.name}`,openWifi:C.open,row:c,onCloseWifi:w,selected:[t.id]})]})}function Vi({alert:t,setAlert:s}){return e.jsx(Ms,{in:t.visible,timeout:{enter:0,exit:2e3},addEndListener:()=>{setTimeout(()=>{s({title:t.title,text:t.text,severity:t.severity,visible:!1})},5e3)},children:e.jsxs(qs,{severity:t.severity,variant:"filled",sx:{maxHeight:"50px",width:"100%"},children:[t.title!==""&&e.jsx(Hs,{children:t.title}),t.text]})})}function Ji({selected:t,handleRebootDevices:s,handleFirmwareUpdates:n,alert:i,setAlert:r}){const{t:o}=L(),[l,u]=a.useState({open:!1}),h=()=>{u({open:!0})},d=()=>{u({open:!1})};return e.jsxs(e.Fragment,{children:[e.jsxs(Ve,{sx:[{pl:{sm:2},pr:{xs:1,sm:1}},t.length>0&&{bgcolor:x=>N(x.palette.primary.main,x.palette.action.activatedOpacity)}],children:[e.jsxs(R,{direction:"row",spacing:2,sx:{px:1,py:2,justifyContent:"flex-start",alignItems:"center",width:"60%"},children:[t.length>0?e.jsxs(P,{sx:{flex:"1 1 40%"},color:"inherit",variant:"subtitle1",component:"div",children:[`Batch ${t.length}`," ",o("selected")]}):e.jsx(P,{sx:{flex:"1 1 40%"},variant:"h6",id:"tableTitle",component:"div",children:"Batch"}),e.jsx(Vi,{text:o("Select devices to enable batch actions."),severity:"info",alert:i,setAlert:r})]}),t.length>0&&e.jsxs(R,{direction:"row",sx:{px:1,py:2,justifyContent:"flex-end",alignItems:"center",width:"40%"},children:[e.jsx(ce,{title:o("_firmwarestable_"),children:e.jsx(U,{onClick:()=>n("stable"),children:e.jsx(v,{icon:"material-symbols:system-update-alt",sx:{color:"green"}})})}),e.jsx(ce,{title:o("_firmwarebeta_"),children:e.jsx(U,{onClick:()=>n("beta"),children:e.jsx(v,{icon:"material-symbols:system-update-alt",sx:{color:"red"}})})}),e.jsx(ce,{title:o("Reboot"),children:e.jsx(U,{onClick:()=>s(),children:e.jsx(v,{icon:"ix:reboot"})})}),e.jsx(ce,{title:"Wifi",children:e.jsx(U,{onClick:()=>h(),children:e.jsx(v,{icon:"material-symbols:wifi"})})})]})]}),e.jsx(gs,{type:"selected",title:`Wifi ${t.length} ${o("selected")}`,openWifi:l.open,onCloseWifi:d,selected:t})]})}const Ki=[{id:"image",disablePadding:!0,label:""},{id:"name",disablePadding:!0,label:"Name"},{id:"model",disablePadding:!1,label:"Model"},{id:"gen",disablePadding:!1,label:"Gen"},{id:"uptime",disablePadding:!1,label:"Uptime"},{id:"restart",disablePadding:!1,label:"Reboot"},{id:"firmware",disablePadding:!1,label:"Firmware"},{id:"stable",disablePadding:!1,label:"Stable"},{id:"beta",disablePadding:!1,label:"Beta"},{id:"menue",disablePadding:!0,label:""}];function Yi(t){const{onSelectAllClick:s,order:n,orderBy:i,numSelected:r,rowCount:o,onRequestSort:l}=t,u=d=>x=>{l(x,d)},{t:h}=L();return e.jsx(kt,{children:e.jsxs(pe,{children:[e.jsx(M,{padding:"checkbox",children:e.jsx(re,{color:"primary",indeterminate:r>0&&r<o,checked:o>0&&r===o,onChange:s})}),Ki.map(d=>e.jsx(M,{align:"left",padding:d.disablePadding?"none":"normal",sortDirection:i===d.id?n:!1,children:e.jsxs(Pt,{active:i===d.id,direction:i===d.id?n:"asc",onClick:u(d.id),hideSortIcon:!0,children:[h(d.label),i===d.id?e.jsx(D,{component:"span",sx:$t,children:n==="desc"?"sorted descending":"sorted ascending"}):null]})},d.id))]})})}function Zi({devices:t}){const[s,n]=a.useState("asc"),[i,r]=a.useState(""),[o,l]=a.useState([]),[u,h]=a.useState(0),[d,x]=a.useState(5),{send:c}=K(),[p,f]=a.useState([]),[_,C]=a.useState({title:"",text:"",severity:"",visible:!1}),{t:j}=L();a.useEffect(()=>{f(t.map(g=>{const k=g?.wsmessages?.NotifyFullStatus?.params?.sys;return{id:g.id,image:g.image,name:g.cname.substring(0,14),model:g.name,gen:g.gen,uptime:k?.uptime,restart:g.rebootPending?"reboot pending":k?.restart_required,firmware:g.fw_id,stable:g.updateStablePending?"stable pending":g.stable,beta:g.updateBetaPending?"beta pending":g.beta}}))},[t]);const y=g=>{p[p.findIndex(k=>k.id===g.id)]=g,f(p)},w=(g,k)=>{typeof k>"u"&&(k=o);const B=k.filter(Y=>{const ee=p.find(W=>W.id===Y);return g==="stable"?typeof ee.stable<"u":typeof ee.beta<"u"});B.length>0&&c({event:`devices ${g} update`,data:{source:"Shelly Table",message:"Shelly Table wants to update the firmware of devices",ids:B}}),B.length!==k.length&&C({title:"",text:B.length===0?j("_noupdateavailable_",{type:g}):j("_updateavailable_",{checked:B.length,selected:k.length,type:g}),severity:"warning",visible:!0})},b=g=>{typeof g>"u"&&(g=o),c({event:"devices reboot",data:{source:"Shelly Table",message:"Shelly Table wants to reboot devices",ids:g}})},T=(g,k)=>{n(i===k&&s==="asc"?"desc":"asc"),r(k)},I=g=>{if(g.target.checked){const k=p.map(B=>B.id);l(k);return}l([])},S=(g,k)=>{const B=o.indexOf(k);let Y=[];B===-1?Y=Y.concat(o,k):B===0?Y=Y.concat(o.slice(1)):B===o.length-1?Y=Y.concat(o.slice(0,-1)):B>0&&(Y=Y.concat(o.slice(0,B),o.slice(B+1))),l(Y)},E=(g,k)=>{h(k)},$=g=>{x(parseInt(g.target.value,10)),h(0)},F=ts(u,d,p.length);return e.jsx(D,{sx:{width:"100%"},children:e.jsxs(St,{sx:{width:"100%",mb:2},children:[e.jsx(Ji,{selected:o,handleRebootDevices:b,handleFirmwareUpdates:w,alert:_,setAlert:C}),e.jsx(Ft,{children:e.jsxs(Rt,{sx:{minWidth:750},"aria-labelledby":"tableTitle",size:"small",children:[e.jsx(Yi,{numSelected:o.length,order:s,orderBy:i,onSelectAllClick:I,onRequestSort:T,rowCount:p.length}),e.jsxs(It,{children:[p.sort(es(s,i)).slice(u*d,u*d+d).map((g,k)=>{const B=o.includes(g.id),Y=`enhanced-table-checkbox-${k}`;return e.jsx(Gi,{row:g,labelId:Y,isItemSelected:B,handleClick:S,handleRebootDevices:b,handleFirmwareUpdates:w,updateRow:y},g.id)}),F>0&&e.jsx(pe,{style:{height:33*F},children:e.jsx(M,{colSpan:10})})]})]})}),e.jsx(Ot,{rowsPerPageOptions:[5,10,25],component:"div",count:p.length,rowsPerPage:d,page:u,onPageChange:E,onRowsPerPageChange:$})]})})}const Xi=({index:t,devices:s})=>{const i=["sk","ctrl","log","ws","table"][t];if(i==="table")return e.jsx(Zi,{devices:s});const r=12,o=i==="sk"||i==="ctrl"?4:12,l=i==="sk"||i==="ctrl"?2:12,u=i==="sk"||i==="ctrl"?2:12,h=i==="sk"||i==="ctrl"?2:12;return e.jsx(te,{container:!0,spacing:2,size:{xs:{xs:r},sm:{sm:o},md:{md:l},lg:{lg:u},xl:{xl:h}},children:s.map((d,x)=>{const c=d.switches.find(C=>typeof C.brightness<"u"),p=d.switches.find(C=>typeof C.white<"u"),f=d.switches.find(C=>typeof C.rgb<"u");return i==="sk"||i==="ws"&&d.gen>0||i==="log"&&d.gen>1||i==="ctrl"&&(c||p||f)?e.jsx(te,{sx:{minWidth:i==="sk"||i==="ctrl"?0:1},children:e.jsx(Hi,{deviceId:d.id,deviceGen:d.gen,type:i},d.id)},m()):null})})},Me=[{value:"config",label:"Config"},{value:"cname",label:"Name"},{value:"name",label:"Model"},{value:"gen",label:"Gen"}];function ms({handleSort:t}){const[s,n]=a.useState(null),[i,r]=a.useState(0),{t:o}=L(),l=d=>{n(d.currentTarget)},u=()=>{n(null)},h=(d,x)=>{n(null),r(x),t(Me[x])};return e.jsxs(e.Fragment,{children:[e.jsxs(Q,{disableRipple:!0,color:"inherit",onClick:l,endIcon:e.jsx(v,{icon:s?"eva:chevron-up-fill":"eva:chevron-down-fill"}),children:[o("_sortby_"),":",e.jsx(P,{component:"span",variant:"subtitle2",sx:{color:"text.secondary"},children:o(Me[i].label)})]}),e.jsx(Gs,{open:!!s,anchorEl:s,onClose:u,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{[`& .${Vs.root}`]:{p:0}}}},children:Me.map((d,x)=>e.jsx(q,{onClick:c=>h(c,x),selected:x===i,children:o(d.label)},d.value))})]})}ms.propTypes={handleSort:O.func.isRequired};function Qi({openFilter:t,onOpenFilter:s,onCloseFilter:n,filter:i,handleDeviceFilter:r}){const[o,l]=a.useState([]),[u,h]=a.useState([]),{t:d}=L();if(a.useEffect(()=>{l(Array.from(i.mChecked)),h(Array.from(i.gChecked))},[i]),typeof i>"u")return null;const x=C=>{const j=o.map((y,w)=>w===C?!y:y);l(j)},c=C=>{const j=u.map((y,w)=>w===C?!y:y);h(j)},p=e.jsxs(R,{spacing:1,children:[e.jsx(P,{variant:"subtitle2",children:d("Model")}),e.jsx(at,{children:i.models.map((C,j)=>e.jsx(fe,{control:e.jsx(re,{checked:!!o[j],onChange:()=>x(j)}),label:C},C))})]}),f=e.jsxs(R,{spacing:1,children:[e.jsx(P,{variant:"subtitle2",children:d("Generation")}),e.jsx(at,{children:i.generations.map((C,j)=>e.jsx(fe,{value:C,control:e.jsx(re,{checked:!!u[j],onChange:()=>c(j)}),label:C!==""?`Gen ${C}`:"no Gen"},C))})]}),_=()=>{l(new Array(i.mChecked.length).fill(!1)),h(new Array(i.gChecked.length).fill(!1))};return e.jsxs(e.Fragment,{children:[e.jsxs(Q,{disableRipple:!0,color:i.isFilter?"success":"inherit",endIcon:e.jsx(v,{icon:"ic:round-filter-list"}),onClick:s,children:[d("Filters"),""]}),e.jsxs(ae,{anchor:"right",open:t,onClose:n,slotProps:{paper:{sx:{width:300,border:"none",overflow:"hidden"}}},children:[e.jsxs(R,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{px:1,py:2},children:[e.jsx(P,{variant:"h6",sx:{ml:1},children:d("Filters")}),e.jsx(U,{onClick:n,children:e.jsx(v,{icon:"eva:close-fill"})})]}),e.jsx(ne,{}),e.jsx(Le,{children:e.jsxs(R,{spacing:3,sx:{p:3},children:[p,f]})}),e.jsx(D,{sx:{p:3},children:e.jsxs(R,{direction:"row",spacing:2,children:[e.jsx(Q,{fullWidth:!0,size:"large",color:"inherit",variant:"outlined",startIcon:e.jsx(v,{icon:"formkit:submit"}),onClick:()=>r(o,u),children:d("Submit")}),e.jsx(Q,{fullWidth:!0,size:"large",color:"inherit",variant:"outlined",startIcon:e.jsx(v,{icon:"ic:round-clear-all"}),onClick:()=>_(),children:d("Clear")})]})})]})]})}function er(){const{devices:t}=K(),[s,n]=a.useState(t),[i,r]=a.useState(!1),[o,l]=a.useState(0),[u,h]=a.useState({models:[],generations:[],mChecked:[],gChecked:[],isFilter:!1}),{t:d}=L();a.useEffect(()=>{const j=[],y=[];t.forEach(b=>{j.includes(b.name)||j.push(b.name),y.includes(b.gen)||y.push(b.gen)});const w={models:j,generations:y,mChecked:new Array(j.length).fill(!1),gChecked:new Array(y.length).fill(!1),isFilter:!1};h(()=>w),n(t)},[t]);const x=(j,y)=>{l(y)},c=()=>{r(!0)},p=()=>{r(!1)},f=j=>{let y;switch(j.value){case"config":n(()=>t);break;case"gen":y=[...s],y=fi(y,"gen"),n(()=>y);break;default:y=[...s],y=bi(y,j.value),n(()=>y)}},_=j=>t.filter(w=>{for(const b in j)if(w[b]===void 0||!j[b].includes(w[b]))return!1;return!0}),C=(j,y)=>{let w=!1;const b={};u.models.forEach((T,I)=>{j[I]&&(w=!0,typeof b.name>"u"&&(b.name=[]),b.name.push(T))}),u.generations.forEach((T,I)=>{y[I]&&(w=!0,typeof b.gen>"u"&&(b.gen=[]),b.gen.push(T))}),n(w?()=>_(b):()=>t),h({models:u.models,generations:u.generations,mChecked:j,gChecked:y,isFilter:w}),r(!1)};return e.jsxs(_e,{children:[e.jsx(P,{variant:"h4",children:"Shellies"}),e.jsx(R,{direction:"row",alignItems:"center",flexWrap:"wrap-reverse",justifyContent:"flex-end",sx:{mb:5},children:e.jsxs(R,{direction:"row",spacing:1,flexShrink:0,sx:{my:1},children:[e.jsx(Qi,{openFilter:i,onOpenFilter:c,onCloseFilter:p,filter:u,handleDeviceFilter:C}),e.jsx(ms,{handleSort:f})]})}),e.jsx(D,{sx:{pb:2,borderBottom:1,borderColor:"divider"},children:e.jsxs(Js,{value:o,onChange:x,variant:"scrollable",scrollButtons:"auto","aria-label":"shelly tabs",children:[e.jsx(je,{"data-testid":"shellies_script_tab",label:"Script / KVS"}),e.jsx(je,{"data-testid":"shellies_control_tab",label:d("Control")}),e.jsx(je,{"data-testid":"shellies_logs_tab",label:"Logs"}),e.jsx(je,{"data-testid":"shellies_ws_tab",label:"WS Inspector"}),e.jsx(je,{"data-testid":"shellies_list_tab",label:"List / Batch"})]})}),e.jsx(Xi,{index:o,devices:typeof s>"u"?t:s},"shelliesTab")]})}function tr(){const{user:t}=K();return e.jsxs(e.Fragment,{children:[e.jsx(de,{children:e.jsx("title",{children:" Shellies"})}),t?e.jsx(er,{}):null]})}const sr=Object.freeze(Object.defineProperty({__proto__:null,default:tr},Symbol.toStringTag,{value:"Module"}));function nr(){const t=e.jsx(D,{component:"header",sx:{top:0,left:0,width:1,lineHeight:0,position:"fixed",p:s=>({xs:s.spacing(3,3,0),sm:s.spacing(5,5,0)})},children:e.jsx(Be,{sx:{mt:3,ml:4}})});return e.jsxs(e.Fragment,{children:[t,e.jsx(_e,{children:e.jsxs(D,{sx:{py:12,maxWidth:480,mx:"auto",display:"flex",minHeight:"100vh",textAlign:"center",alignItems:"center",flexDirection:"column",justifyContent:"center"},children:[e.jsx(P,{variant:"h3",sx:{mb:3},children:"Sorry, page not found!"}),e.jsx(P,{sx:{color:"text.secondary"},children:"Sorry, we couldn뗪 find the page youre looking for. Perhaps you뗬e mistyped the URL? Be sure to check your spelling."}),e.jsx(D,{component:"img",src:"/assets/illustrations/illustration_404.svg",sx:{mx:"auto",height:260,my:{xs:5,sm:10}}}),e.jsx(Q,{href:"/",size:"large",variant:"contained",component:Bt,children:"Go to Home"})]})})]})}function ir(){return e.jsxs(e.Fragment,{children:[e.jsx(de,{children:e.jsx("title",{children:" 404 Page Not Found "})}),e.jsx(nr,{})]})}const rr=Object.freeze(Object.defineProperty({__proto__:null,default:ir},Symbol.toStringTag,{value:"Module"}));export{fo as a,mo as c,bo as g};
