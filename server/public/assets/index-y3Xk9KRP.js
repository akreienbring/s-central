import{r as a,j as e}from"./react-DszLFPtG.js";import{c as Pn}from"./react-dom-C1leq-tK.js";import{L as Fn,B as Rn}from"./react-router-dom-CnhFGwUs.js";import{H as Tn,a as oe}from"./react-helmet-async-BE1j4sQA.js";import{i as On}from"./i18next-B2185GOa.js";import{i as En,u as A}from"./react-i18next-4l6hPDw5.js";import{P as i}from"./prop-types-DCR0IDdT.js";import{u as Te,a as Oe,b as Dn,O as In,N as at}from"./react-router-BoBBW7sI.js";import{u as ue,a as ve,B as O,S as $,T as k,s as Ee,b as T,A as de,c as X,D as pe,L as Ct,C as An,F as Je,d as te,I as ze,e as H,M,f as Ke,g as Ln,h as ne,P as be,i as we,j as xe,k as Un,l as Ye,m as lt,n as ct,o as Bn,p as Nn,q as St,r as Wn,t as zn,v as Mn,w as qn,x as ie,y as Xe,z as Hn,E as he,G as Y,H as Me,J as Vn,K as De,N as K,O as Gn,Q as Fe,R as Jn,U as Kn,V as Yn,W as Xn,X as Zn,Y as Qn,Z as es,_ as ts,$ as ns,a0 as dt,a1 as Ce,a2 as ss,a3 as rs,a4 as os,a5 as is,a6 as ut,a7 as as,a8 as Se}from"./@mui-CNHb4Bw2.js";import{f as Ze,a as ls,b as cs,e as pt,c as ds,d as us}from"./date-fns-28xL-GjM.js";import{m as ps,i as kt,d as hs}from"./lodash-Cj9C-gE2.js";import{n as xs}from"./numeral-DssFQf_R.js";import{A as gs}from"./react-apexcharts-BkorIlZg.js";import{_ as fs}from"./react-material-ui-carousel-DWmOzw6e.js";import{T as ms,a as ht}from"./mui-tiptap-editor-CzUkJzmE.js";import"./@emotion-CsFs-KDg.js";import{w as bs}from"./websocket-BpbVMnY7.js";import{c as ys}from"./sha256-uint8array-DNUmUZDr.js";import{I as js}from"./@iconify-Bo6ss--p.js";import{x as _s}from"./mui-color-input-BWpu3CST.js";import{S as vs}from"./simplebar-react-BcCiPwai.js";import"./index-y3Xk9KRP.js";import"./scheduler-CylivXx-.js";import"./@remix-run-CqHE3mAX.js";import"./react-fast-compare-XDm1dv6Z.js";import"./invariant-yluD5JcG.js";import"./shallowequal-_yq4vFQl.js";import"./clsx-B-dksMZM.js";import"./react-transition-group-BX6M0UjH.js";import"./@babel-gRyvpOoA.js";import"./@popperjs-DzOHQG4g.js";import"./apexcharts-C7GUJZ0z.js";import"./framer-motion-TV3r1K02.js";import"./tslib-DWL4nlhP.js";import"./hey-listen-DQI87Kmj.js";import"./style-value-types-CX_osMP7.js";import"./popmotion-O_1Jfs3J.js";import"./framesync-DhFHr8mH.js";import"./react-is-CjY7idYL.js";import"./@tiptap-CYurFYpt.js";import"./prosemirror-state-CbPVowry.js";import"./prosemirror-model-CWJw0FAp.js";import"./orderedmap-C4TimWWB.js";import"./prosemirror-transform-CmxhxSzP.js";import"./tippy.js-DM9ol-Nf.js";import"./linkifyjs-CPzQtjSI.js";import"./prosemirror-view-D2u4awtz.js";import"./prosemirror-tables-D5HyTxhQ.js";import"./prosemirror-keymap-BAKRQlar.js";import"./w3c-keyname-DEtA-KhA.js";import"./prosemirror-dropcursor-HUb11Unb.js";import"./prosemirror-gapcursor-CHFTFkqk.js";import"./prosemirror-history-BjKgugDr.js";import"./rope-sequence-2KRK_2Nd.js";import"./prosemirror-commands-B0Mmz6rZ.js";import"./prosemirror-schema-list-DpEpyLDh.js";import"./lowlight-gjfAhr3T.js";import"./highlight.js-CpIo8AYo.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./stylis-FDnFs_-n.js";import"./es5-ext-B-aRoSt4.js";import"./simplebar-core-C1qQJ13b.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const l of d.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function s(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function r(o){if(o.ep)return;o.ep=!0;const d=s(o);fetch(o.href,d)}})();var ai=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function li(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ci(t){if(t.__esModule)return t;var n=t.default;if(typeof n=="function"){var s=function r(){return this instanceof r?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};s.prototype=n.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(s,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}),s}const ws={English:"English",Spanish:"Spanish",German:"German",_consumption_:"Current Consumption",_perShelly_:"per Shelly",Running:"Running",Connected:"Connected",_welcome_:"Welcome back 游녦",Filters:"Filters",_sortby_:"Sort by",Submit:"Submit",Clear:"Clear",Alias:"Alias",Model:"Model",Generation:"Generation",_byminute_:"By Minute",_byhour_:"By Hour",_byday_:"By Day",_bymonth_:"By Month",_byyear_:"By Year",_notconnected_:"Disconnected!",_getinvolved_:"Get involved!",_gotogithub_:"Go to Github",_opensource_:"Open Source MIT License",Home:"Home",Profile:"Profile",Security:"Security",Settings:"Settings",Logout:"Logout",_forgotpw_:"Forgot Password?",_wrongpw_:"Wrong Password!",_usernotexists_:"EMail not found!",_resetpw_:"Password was reset.",Password:"Password",Email:"Email",Firstname:"Firstname",Lastname:"Lastname",Role:"Role",_newuser_:"New User",_editprofile_:"Your Profile",_edituserprofile_:"Edit User",_editsecurity_:"Your Access",_editsettings:"Your Settings",_searchuser_:"Search User",Users:"Users",_rowsperpage_:"Rows per page:",of:"of",_morethan_:"more than",Login:"Login",Save:"Save",_userupdated_:"User was updated",_usernotupdated_:"Could not update user",_usercreated_:"User was created",_usernotcreated_:"Could not create user",_blogpostcreated_:"Post was saved",_blogpostnotcreated_:"Could not save post",_blogpostupdated_:"Post was updated",_blogpostnotupdated_:"Could not update post",Delete:"Delete",Edit:"Edit",_reallydelete_:"Really Delete?",_userdeleted_:"User deleted",_usernotdeleted:"Couldn't delete user",_emailexists_:"Email already exists",_aliasexists_:"Alias already exists",Read:"Read",Unread:"Unread",Notifications:"Notifications",_unreadmessages_:"You have {{totalUnRead}} new messages",_markallasread_:"Mark all as read",Brightness:"Brightness",White:"White",Control:"Settings",_newpost_:"New Post",Title:"Title",Content:"Content",_editpost_:"Edit Post","_editor-preview_":"Preview","_editor-bold_":"Bold","_editor-italic_":"Italic","_editor-strike_":"Strikethrough","_editor-underline_":"Underline","_editor-link_":"Link","_editor-bulletlist_":"Bullet List","_editor-orderedlist_":"Ordered List","_editor-alignleft_":"Align left","_editor-aligncenter_":"Align Center","_editor-alignright_":"Align Right","_editor-alignjustify_":"Align Justify","_editor-blockquote_":"Blockquote","_editor-codeblock_":"Codeblock","_editor-undo_":"Undo","_editor-redo_":"Redo","_editor-normaltext_":"Normal","_editor-h1_":"Heading1","_editor-h2_":"Heading2","_editor-h3_":"Heading3","_editor-h4_":"Heading4","_editor-h5_":"Heading5","_editor-h6_":"Heading6","_editor-insertlink_":"Insert Link","_editor-invalidlink_":"Invalid Link","_editor-color_":"Text Color","_editor-placeholder_":"Write your post",_notfound_:"Not found",_noresultsfor_:"No results found for",selected:"selected"},Cs={translation:ws},Ss={English:"Englisch",Spanish:"Spanisch",German:"Deutsch",_consumption_:"Aktueller Verbrauch",_perShelly_:"per Shelly",Running:"Laufen",Connected:"Verbunden",_welcome_:"Willkommen zur칲ck 游녦",Filters:"Filter",_sortby_:"Sortierung",Submit:"Anwenden",Clear:"L칬schen",Alias:"Alias",Model:"Model",Generation:"Generation",_byminute_:"Per Minute",_byhour_:"Per Stunde",_byday_:"Per Tag",_bymonth_:"Per Monat",_byyear_:"Per Jahr",_notconnected_:"Getrennt!",_getinvolved_:"Helf mit!",_gotogithub_:"Besuch das Github Projekt",_opensource_:"Open Source MIT Lizenz",Home:"Home",Profile:"Profil",Security:"Sicherheit",Settings:"Einstellungen",Logout:"Logout",_forgotpw_:"Passwort vergessen?",_wrongpw_:"Falsches Passwort!",_usernotexists_:"Email nicht gefunden!",_resetpw_:"Passwort wurde zur칲ck gesetzt.",Password:"Passwort",Email:"Email",Firstname:"Vorname",Lastname:"Nachname",Role:"Rolle",_newuser_:"Neuer Benutzer",_editprofile_:"Dein Profil",_edituserprofile_:"Benutzer bearbeiten",_editsecurity_:"Deine Zugangsdaten",_editsettings:"Deine Einstellungen",_searchuser_:"Benutzer suchen",Users:"Benutzer",_rowsperpage_:"Zeilen per Seite:",of:"von",_morethan_:"mehr als",Login:"Anmelden",Save:"Speichern",_userupdated_:"User aktualisiert",_usernotupdated_:"Fehler bei der Aktualisierung ",_usercreated_:"Benutzer wurde angelegt",_usernotcreated_:"Benutzer konnte nicht angelegt werden",_blogpostcreated_:"Post wurde gespeichert",_blogpostnotcreated_:"Post konnte nicht gespeichert werden",_blogpostupdated_:"Post wurde aktualisiert",_blogpostnotupdated_:"Fehler bei der Aktualisierung",Delete:"L칬schen",Edit:"Bearbeiten",_reallydelete_:"Wirklich L칬schen?",_userdeleted_:"Benutzer wurde gel칬scht",_usernotdeleted:"Benutzer konnte nicht gel칬scht werden",_emailexists_:"Email existiert bereits",_aliasexists_:"Alias existiert bereits",Read:"Gelesen",Unread:"Ungelesen",Notifications:"Nachrichten",_unreadmessages_:"Du hast {{totalUnRead}} neue Meldungen",_markallasread_:"Alle als gelesen markieren",Brightness:"Helligkeit",White:"Wei",Control:"Einstellung",_newpost_:"Neuer Post",Title:"Titel",Content:"Inhalt",_editpost_:"Post bearbeiten","_editor-preview_":"Vorschau","_editor-bold_":"Fett","_editor-italic_":"Kursiv","_editor-strike_":"Durchgestrichen","_editor-underline_":"Unterstrichen","_editor-link_":"Link","_editor-bulletlist_":"Aufz칛hlung","_editor-orderedlist_":"Numerierung","_editor-alignleft_":"Links Ausrichten","_editor-aligncenter_":"Mittig Ausrichten","_editor-alignright_":"Rechts Ausrichten","_editor-alignjustify_":"Gleichm칛ig Ausrichten","_editor-blockquote_":"Zitat","_editor-codeblock_":"Codeblock","_editor-undo_":"Zur칲ck","_editor-redo_":"Wiederherstellen","_editor-normaltext_":"Normal","_editor-h1_":"칖berschrift1","_editor-h2_":"칖berschrift2","_editor-h3_":"칖berschrift3","_editor-h4_":"칖berschrift4","_editor-h5_":"칖berschrift5","_editor-h6_":"칖berschrift6","_editor-insertlink_":"Link Einf칲gen","_editor-invalidlink_":"Ung칲ltiger Link","_editor-color_":"Textfarbe","_editor-placeholder_":"Schreib deinen Post",_notfound_:"Nicht gefunden",_noresultsfor_:"Keine Resultate gefunden f칲r",selected:"ausgew칛hlt"},ks={translation:Ss},$s={English:"Ingl칠s",Spanish:"Espa침ol",German:"Aleman",_consumption_:"Consumo Actual",_perShelly_:"por Shelly",Running:"Corriendo",Connected:"Connectado",_welcome_:"Bienvenido de nuevo 游녦",Filters:"Filtrar",_sortby_:"Clasificaci칩n",Submit:"Entregar",Clear:"Borrar",Alias:"Alias",Model:"Modelo",Generation:"Generaci칩n",_byminute_:"por Minuto",_byhour_:"por Hora",_byday_:"por Dia",_bymonth_:"por Mes",_byyear_:"por A침o",_notconnected_:"Desconnectado!",_getinvolved_:"Participar!",_gotogithub_:"Ir a Github",_opensource_:"Open Source MIT Licencia",Home:"Home",Profile:"Perfil",Security:"Securidad",Settings:"Configuraci칩n",Logout:"Cerrar sesi칩n",_forgotpw_:"Contrase침a olvidado?",_wrongpw_:"Contrase침a incorrecto!",_usernotexists_:"Correo electr칩nico incorrecto!",_resetpw_:"Contrase침a restablecida.",Password:"Contrase침a",Email:"Correo electr칩nico",Firstname:"Nombre",Lastname:"Apellido",Role:"Rol",_newuser_:"Nuevo Usuario",_editprofile_:"Tu Perfil",_edituserprofile_:"Editar usuario",_editsecurity_:"Tu Acceso",_editsettings:"Tu Adjusto",_searchuser_:"Busca Usuario",Users:"Usuarios",_rowsperpage_:"Filas por p치gina:",of:"de",_morethan_:"mas de",Login:"Acceso",Save:"Guardar",_userupdated_:"Usuario actualizada",_usernotupdated_:"No pudo actualizar el usuario",_usercreated_:"Usario creado",_usernotcreated_:"No se pudo crear el usuario",_blogpostcreated_:"Post creado",_blogpostnotcreated_:"No se pudo crear el post",_blogpostupdated_:"Post actualizada",_blogpostnotupdated_:"No pudo actualizar el post",Delete:"Borrar",Edit:"Editar",_reallydelete_:"Realmente Borrar?",_userdeleted_:"Usuario eliminado",_usernotdeleted:"No se pudo eliminar el usuario",_emailexists_:"El correo electr칩nico ya existe",_aliasexists_:"Alias ya existe",Read:"Ya le칤",Unread:"No le칤do",_unreadmessages_:"Tienes {{totalUnRead}} nuevos mensajes",_markallasread_:"Marcar todo como le칤do",Brightness:"Brillo",White:"Blanco",Control:"Ajustes",_newpost_:"Nuevo Post",Title:"Titulo",Content:"Contenido",_editpost_:"Editar Post","_editor-preview_":"Previsi칩n","_editor-bold_":"Gordo","_editor-italic_":"It치lico","_editor-strike_":"Tachado","_editor-underline_":"Testado","_editor-link_":"Enlace","_editor-bulletlist_":"Enumeraci칩n","_editor-orderedlist_":"Numeraci칩n","_editor-alignleft_":"Alinear Izquierda","_editor-aligncenter_":"Alinear Central","_editor-alignright_":"Alinear Derecha","_editor-alignjustify_":"Alinear Igualmente","_editor-blockquote_":"Cita","_editor-codeblock_":"Codeblock","_editor-undo_":"Atr치s","_editor-redo_":"Rehacer","_editor-normaltext_":"Normal","_editor-h1_":"Sobrescritura1","_editor-h2_":"Sobrescritura2","_editor-h3_":"Sobrescritura3","_editor-h4_":"Sobrescritura4","_editor-h5_":"Sobrescritura5","_editor-h6_":"Sobrescritura6","_editor-insertlink_":"Entrar Enlace","_editor-invalidlink_":"Enlace Invalido","_editor-color_":"Color del texto","_editor-placeholder_":"Escribir tu post",_notfound_:"No encontrado",_noresultsfor_:"No se encontraron resultados para",selected:"seleccionado"},Ps={translation:$s},$e=[{value:"en",label:"English"},{value:"de",label:"German"},{value:"es",label:"Spanish"}],Fs=()=>{const t=localStorage.getItem("i18nLanguage");if(t!==null)return console.log(`Using last selected language ${t}`),t;if(typeof navigator.language<"u"){const n=navigator.language.substring(0,2);if(typeof $e.find(s=>s.value===n)<"u")return console.log(`Using browser language ${n}`),navigator.language.substring(0,2)}return console.log("Using browser language en"),"en"};On.use(En).init({resources:{en:{...Cs},de:{...ks},es:{...Ps}},lng:Fs()});const Rs="modulepreload",Ts=function(t){return"/"+t},xt={},ae=function(n,s,r){let o=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));o=Promise.allSettled(s.map(h=>{if(h=Ts(h),h in xt)return;xt[h]=!0;const u=h.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":Rs,u||(g.as="script"),g.crossOrigin="",g.href=h,c&&g.setAttribute("nonce",c),document.head.appendChild(g),u)return new Promise((_,j)=>{g.addEventListener("load",_),g.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${h}`)))})}))}function d(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return o.then(l=>{for(const c of l||[])c.status==="rejected"&&d(c.reason);return n().catch(d)})},Be={WSURL:"ws://192.168.1.2:3031",WSSURL:"wss://monitor.wirsindborg.synology.me:5001",RECONNECT_DELAY:2,RECONNECT_MAX:10,LANDING_PAGE:"blogs"},Ne=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),f=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,t=>(+t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+t/4).toString(16)),se=(t,n)=>t<n?t:t%n===0?n:t%n;function gt(t){return ys().update(t).digest("hex")}function Os(t,n,s){if(typeof n>"u"||n==="")throw new Error("Failed to authenticate!  Please supply a password!");if(typeof t>"u"||t.auth_type!=="digest")throw new Error("The message contains no authentication information");const r={nonce:t.nonce,nc:t.nc,realm:t.realm,algorithm:t.algorithm};return Es(r,n,s)}function Es(t,n,s){t.username=s,t.cnonce=String(Math.floor(Math.random()*1e9));let r=gt(`${t.username}:${t.realm}:${n}`);return r+=`:${t.nonce}`,r+=`:1:${t.cnonce}`,t.response=gt(r),t}const $t=(t,n)=>{document.addEventListener(t,n)},Ds=(t,n)=>{document.removeEventListener(t,n)},re=(t,n)=>{const s=new CustomEvent(t,{detail:n});document.dispatchEvent(s)},Pt=a.createContext(),V=()=>a.useContext(Pt),Ft=({children:t})=>{const[n,s]=a.useState(JSON.parse(localStorage.getItem("user"))),[r,o]=a.useState(null),[d,l]=a.useState(.001),c=a.useRef(null),h=a.useRef({}),u=a.useRef({}),m=a.useRef(!1),g=a.useRef(null),_=a.useRef({event:"user reconnect",data:{name:"Shelly Context",channel:`sc${f()}`,message:"Hello from Shelly Context",user:n}}),j=a.useRef(["user validate","blogposts get public"]),v=(x,p)=>{p&&(x=.001),m.current=!0,setTimeout(()=>{if(c.current!==null&&c.current.readyState===WebSocket.OPEN){m.current=!1;return}if(x>Be.RECONNECT_MAX){m.current=!1,console.log("Reconnecting makes no sense! Please reload Page"),re("lastUpdatedAt",null);return}console.log(`Trying to reconnect: ${x}`),l(x+1),v(x+1,!1)},x*Be.RECONNECT_DELAY*1e3)};a.useEffect(()=>{n!==null?localStorage.setItem("user",JSON.stringify(n)):localStorage.removeItem("user"),_.current.data.user=n},[n]),a.useEffect(()=>{(c.current===null||m&&c.current.readyState!==WebSocket.OPEN)&&(re("lastUpdatedAt","connecting"),console.log("Creating a new WebSocket Client!"),c.current=new bs.w3cwebsocket(Be.WSSURL)),c.current.onerror=x=>console.error(x),c.current.onopen=x=>{m.current=!1,re("lastUpdatedAt",Date.now()),console.log("WebSocket connection opened for Shelly Context!"),r!==null?c.current.send(JSON.stringify({event:"user validate",data:{source:r.msg.data.source,message:r.msg.data.message,user:{email:r.msg.data.user.email}}})):_.current.data.user!==null&&(console.log(`Reconnecting the logged in user '${_.current.data.user.alias}'`),c.current.send(JSON.stringify(_.current))),Object.entries(u.current).forEach(p=>{const[C,I]=p;j.current.includes(I.msg.event)&&c.current.send(JSON.stringify(I.msg)),typeof I.callback>"u"&&delete u[C]})},c.current.onmessage=x=>{re("lastUpdatedAt",Date.now());const p=JSON.parse(x.data);p!==null&&(p.event==="user validate"?r!==null&&typeof p.data.error<"u"&&p.data.error.code===401?(r.msg.data.auth=Os(p.data.error.message,r.msg.data.user.password,r.msg.data.user.email),delete r.msg.data.user.password,delete r.msg.data.error,c.current.send(JSON.stringify(r.msg))):(g.current=p.data.secret,delete p.data.secret,r.callback(p),o(null),console.log(`Deleted the 'user validate request. Now have ${Object.entries(u.current).length} messages left`)):p.event==="user reconnect"?typeof p.data.secret<"u"?(g.current=p.data.secret,console.log(`Just reconnected. There are ${Object.entries(u.current).length} outstanding messages`),Object.entries(u.current).forEach(C=>{const[I,N]=C;j.current.includes(p.event)||(N.msg.data.secret=g.current),c.current.send(JSON.stringify(N.msg)),typeof N.callback>"u"&&delete u[I]})):(console.error("Reconnecting was not possible. Logging out!"),P()):p.event==="ping"?c.current.send(JSON.stringify({event:"pong",data:{name:"SC Context",message:p.data.message}})):typeof p.data.requestID<"u"&&typeof u.current[p.data.requestID]<"u"?(u.current[p.data.requestID].callback(p),delete u.current[p.data.requestID],console.log(`Deleted request ${p.data.requestID} on answer: '${p.data.message}'. Now have ${Object.entries(u.current).length} requests`)):typeof p.event<"u"?typeof h.current[p.event]<"u"&&h.current[p.event].forEach(C=>{(C.all||p.data.subscriptionID===C.subscriptionID||C.all)&&C.callback(p)}):console.error(`Shelly context received an unhandled message ${JSON.stringify(p)} `))},c.current.onclose=x=>{m.current?re("lastUpdatedAt",null):(re("lastUpdatedAt","connecting"),v(d,!0)),c.current?console.log(`WebSocket connection closed by the server for SC Context. Reason: ${x.reason}!`):console.log(`WebSocket connection closed because SC Context was unmounted. Reason: ${x.reason}!`)}},[r,v,d]);const b=x=>{s(x)},P=()=>{c.current.close(4001,"User logged out"),s(null)},F=(x,p)=>{p.forEach(C=>{typeof h.current[C]>"u"?h.current[C]=[x]:h.current[C].push(x)})},S=(x,p)=>{p.forEach(C=>{typeof h.current[C]<"u"&&(h.current[C]=h.current[C].filter(I=>I.subscriptionID!==x))})},y=a.useCallback(x=>{const p=!j.current.includes(x.event);if(p&&(x.data.secret=g.current),c.current!==null&&c.current.readyState===WebSocket.OPEN&&(!p||g.current!==null))c.current.send(JSON.stringify(x));else{const C=f();u.current[C]={msg:x,undefined:void 0},m.current||v(d,!0)}},[v,d]),R=a.useCallback((x,p)=>{let C=!1;if(Object.values(u.current).forEach(N=>{N.msg.event===x.event&&(C=!0)}),C)return;if(x.event==="user validate")_.current.data.user=x.data.user,o({msg:x,callback:p});else{const N=f();x.data.requestID=N,u.current[N]={msg:x,callback:p}}const I=!j.current.includes(x.event);I&&(x.data.secret=g.current),c.current!==null&&c.current.readyState===WebSocket.OPEN&&(!I||g.current!==null)?c.current.send(JSON.stringify(x)):m.current||v(d,!0)},[v,d]);return e.jsx(Pt.Provider,{value:a.useMemo(()=>({user:n,login:b,logout:P,subscribe:F,unsubscribe:S,request:R,send:y}),[n,R,y]),children:t})};Ft.propTypes={children:i.object};function Rt(){const{pathname:t}=Te();return a.useMemo(()=>t,[t])}const Qe=a.forwardRef(({href:t,...n},s)=>e.jsx(Fn,{ref:s,to:t,...n}));Qe.propTypes={href:i.string};function Ie(t,n,s){const r=ue(),o=ve(r.breakpoints.up(n));return ve(r.breakpoints.down(n)),ve(r.breakpoints.between(n,s)),ve(r.breakpoints.only(n)),o}const ye=a.forwardRef(({disabledLink:t=!1,sx:n,...s},r)=>{const o=e.jsx(O,{component:"img",src:"/assets/logo.svg",sx:{width:40,height:40,...n}});return t?o:e.jsxs($,{direction:"row",spacing:2,sx:{justifyContent:"flex-start",alignItems:"center"},children:[e.jsx(O,{sx:{display:"contents"},children:o}),e.jsx(k,{variant:"h6",sx:{pt:3},children:"Shelly Central"})]})});ye.propTypes={disabledLink:i.bool,sx:i.object};const Is=Ee("div")(()=>({flexGrow:1,height:"100%",overflow:"hidden"})),As=Ee(vs)(({theme:t})=>({maxHeight:"100%","& .simplebar-scrollbar":{"&:before":{backgroundColor:T(t.palette.grey[600],.48)},"&.simplebar-visible:before":{opacity:1}},"& .simplebar-mask":{zIndex:"inherit"}})),Tt=a.forwardRef(({children:t,sx:n,...s},r)=>{const o=typeof navigator>"u"?"SSR":navigator.userAgent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(o)?e.jsx(O,{ref:r,sx:{overflow:"auto",...n},...s,children:t}):e.jsx(Is,{children:e.jsx(As,{scrollableNodeProps:{ref:r},clickOnTrack:!1,sx:n,...s,children:t})})});Tt.propTypes={children:i.node,sx:i.object};const Ae=a.memo(Tt),Re={H_MOBILE:64,H_DESKTOP:80,H_DESKTOP_OFFSET:64},fe={WIDTH:280},et=a.forwardRef(({src:t,sx:n,...s},r)=>e.jsx(O,{component:"span",className:"svg-color",ref:r,sx:{width:24,height:24,display:"inline-block",bgcolor:"currentColor",mask:`url(${t}) no-repeat center / contain`,WebkitMask:`url(${t}) no-repeat center / contain`,...n},...s}));et.propTypes={src:i.string,sx:i.object};const ke=t=>e.jsx(et,{src:`/assets/icons/navbar/${t}.svg`,sx:{width:1,height:1}}),Ls=[{title:"dashboard",path:"/dashboard",icon:ke("ic_analytics"),minRole:"User"},{title:"shellies",path:"/shellies",icon:ke("ic_device"),minRole:"User"},{title:"blog",path:"/blog",icon:ke("ic_blog"),minRole:"User"},{title:"user",path:"/user",icon:ke("ic_user"),minRole:"Admin"}];function Ot({openNav:t,onCloseNav:n}){const s=Rt(),{user:r}=V(),{t:o}=A(),d=Ie("up","lg");a.useEffect(()=>{t&&n()},[s]);const l=e.jsxs(O,{sx:{my:3,mx:2.5,py:2,px:2.5,display:"flex",borderRadius:1.5,alignItems:"center",bgcolor:m=>T(m.palette.grey[500],.12)},children:[e.jsx(de,{src:`/assets/images/avatars/avatar_${se(r.id,25)}.jpg`,alt:"photoURL"}),e.jsxs(O,{sx:{ml:2},children:[e.jsx(k,{variant:"subtitle2",children:`${r.firstname!==null?r.firstname:r.alias} ${r.lastname!==null?r.lastname:r.alias}`}),e.jsx(k,{variant:"body2",sx:{color:"text.secondary"},children:r.role})]})]}),c=e.jsx($,{component:"nav",spacing:.5,sx:{px:2},children:Ls.map(m=>m.minRole==="User"||m.minRole==="Admin"&&r.roleid===1?e.jsx(Et,{item:m},m.title):null)}),h=e.jsx(O,{sx:{px:2.5,pb:3,mt:10},children:e.jsxs($,{alignItems:"center",spacing:3,sx:{pt:5,borderRadius:2,position:"relative"},children:[e.jsx(O,{sx:{width:100,position:"absolute",top:-50},children:e.jsx(de,{src:"/assets/illustrations/avatar_main.jpg",sx:{width:100,height:100}})}),e.jsxs(O,{sx:{textAlign:"center"},children:[e.jsx(k,{variant:"h6",children:o("_getinvolved_")}),e.jsx(k,{variant:"body2",sx:{color:"text.secondary",mt:1},children:o("_opensource_")})]}),e.jsx(X,{href:"https://github.com/akreienbring/Shelly-Central",target:"_blank",variant:"contained",color:"inherit",children:o("_gotogithub_")})]})}),u=e.jsxs(Ae,{sx:{height:1,"& .simplebar-content":{height:1,display:"flex",flexDirection:"column"}},children:[e.jsx(ye,{sx:{mt:3,ml:4}}),l,c,e.jsx(O,{sx:{flexGrow:1}}),h]});return e.jsx(O,{sx:{flexShrink:{lg:0},width:{lg:fe.WIDTH}},children:d?e.jsx(O,{sx:{height:1,position:"fixed",width:fe.WIDTH,borderRight:m=>`dashed 1px ${m.palette.divider}`},children:u}):e.jsx(pe,{open:t,onClose:n,PaperProps:{sx:{width:fe.WIDTH}},children:u})})}Ot.propTypes={openNav:i.bool,onCloseNav:i.func};function Et({item:t}){const n=Rt(),{t:s}=A(),r=t.path===n;return e.jsxs(Ct,{component:Qe,href:t.path,sx:{minHeight:44,borderRadius:.75,typography:"body2",color:"text.secondary",textTransform:"capitalize",fontWeight:"fontWeightMedium",...r&&{color:"primary.main",fontWeight:"fontWeightSemiBold",bgcolor:o=>T(o.palette.primary.main,.08),"&:hover":{bgcolor:o=>T(o.palette.primary.main,.16)}}},children:[e.jsx(O,{component:"span",sx:{width:24,height:24,mr:2},children:t.icon}),e.jsxs(O,{component:"span",children:[t.title==="user"?s("Users"):t.title," "]})]})}Et.propTypes={item:i.object};const ft=8;function Dt({children:t,sx:n,...s}){const r=Ie("up","lg");return e.jsx(O,{component:"main",sx:{flexGrow:1,minHeight:1,display:"flex",flexDirection:"column",py:`${Re.H_MOBILE+ft}px`,...r&&{px:2,py:`${Re.H_DESKTOP+ft}px`,width:`calc(100% - ${fe.WIDTH}px)`},...n},...s,children:t})}Dt.propTypes={children:i.node,sx:i.object};function Pe(t){const n=(t==null?void 0:t.color)||"#000000",s=(t==null?void 0:t.blur)||6,r=(t==null?void 0:t.opacity)||.8,o=t==null?void 0:t.imgUrl;return o?{position:"relative",backgroundImage:`url(${o})`,"&:before":{position:"absolute",top:0,left:0,zIndex:9,content:'""',width:"100%",height:"100%",backdropFilter:`blur(${s}px)`,WebkitBackdropFilter:`blur(${s}px)`,backgroundColor:T(n,r)}}:{backdropFilter:`blur(${s}px)`,WebkitBackdropFilter:`blur(${s}px)`,backgroundColor:T(n,r)}}function Us(t){const n=(t==null?void 0:t.direction)||"to bottom",s=t==null?void 0:t.startColor,r=t==null?void 0:t.endColor,o=t==null?void 0:t.imgUrl,d=t==null?void 0:t.color;return{background:`linear-gradient(${n}, ${s||d}, ${r||d}), url(${o})`,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center center"}}const w=a.forwardRef(({icon:t,width:n=25,sx:s,...r},o)=>e.jsx(O,{ref:o,component:js,className:"component-iconify",icon:t,sx:{width:n,height:n,...s},...r}));w.propTypes={icon:i.oneOfType([i.element,i.string]),sx:i.object,width:i.number};function Bs(t,n){return t?Ze(new Date(t),"dd MMM yyyy"):""}function Ns(t,n){const s=n;return t?Ze(new Date(t),s):""}function It(t,n){return t?Ze(ls(t),n):""}const Ws=()=>{const[t,n]=a.useState("connecting"),{t:s}=A(),r=Oe(),o=a.useCallback(l=>{l!==null&&n(l.detail)},[]);a.useEffect(()=>($t("lastUpdatedAt",o),()=>{Ds("lastUpdatedAt")}),[o,t]);const d=()=>{t===null&&(n(void 0),r(0))};return t===0?null:e.jsx(X,{variant:"contained",color:t!==null&&t!=="connecting"?"success":"error",startIcon:t==="connecting"||t==="loading"?e.jsx(An,{size:25,variant:"indeterminate",color:"common.white"}):e.jsx(w,{icon:"carbon:update-now"}),onClick:d,children:t!==null&&t!=="connecting"&&t!=="loading"?Ns(t,"HH:mm:ss"):s("_notconnected_")})},At=({type:t,requestResult:n,roles:s,currentUser:r,setRequestResult:o,setCurrentUser:d,handleForgotten:l,handleCurrentUser:c})=>{const{user:h}=V(),[u,m]=a.useState(t!=="profile"?"dashboard":r.home),[g,_]=a.useState(""),[j,v]=a.useState(!1),{t:b}=A(),P=a.useRef(!1),F=a.useRef(r);a.useEffect(()=>{!P.current&&s.length>0&&(_(r.roleid),P.current=!0)},[s,n,r]);const S=()=>{o({success:!0,message:""})},y=({target:p})=>{const C={...r};p.name==="role"?(_(p.value),C.role=s[p.value-1].name,C.roleid=p.value):p.name==="home"?m(p.value):p.name==="alias"?C[p.name]=p.value.trim():C[p.name]=p.value,d(C)},R=p=>{p.preventDefault(),F.current=r,c(r)},x=()=>{if(r===null)return!0;let p=!1;return t==="login"&&(p=typeof r.email>"u"||r.email.length===0||typeof r.password>"u"||r.password.length===0||!Ne(r.email)),(t==="profile"||t==="settings")&&(p=(r.alias===F.current.alias||r.alias.length===0)&&r.firstname===F.current.firstname&&r.lastname===F.current.lastname&&r.home===F.current.home),t==="create"&&(p=typeof r.email>"u"||r.email.length===0||!Ne(r.email)||typeof r.alias>"u"||r.alias.length===0),t==="security"&&(p=!Ne(r.email)||r.password!==r.password2||typeof r.password>"u"||r.password.length===0||typeof r.password2>"u"||r.password.length2===0),p};return e.jsx("form",{onSubmit:R,children:e.jsx(Je,{fullWidth:!0,size:"subtitle2",children:e.jsxs($,{spacing:3,sx:{px:3,py:3},children:[(t==="login"||t==="create"||t==="security")&&e.jsx(te,{required:!0,value:r.email,name:"email",label:b("Email"),onFocus:S,onChange:y}),(t==="login"||t==="security")&&e.jsx(te,{name:"password",required:!0,label:b("Password"),onFocus:S,onChange:y,type:j?"text":"password",slotProps:{input:{endAdornment:e.jsx(ze,{position:"end",children:e.jsx(H,{onClick:()=>v(!j),edge:"end",children:e.jsx(w,{icon:j?"eva:eye-fill":"eva:eye-off-fill"})})})}}}),t==="security"&&e.jsx(te,{required:!0,name:"password2",label:b("Password"),onFocus:S,onChange:y,type:j?"text":"password",slotProps:{input:{endAdornment:e.jsx(ze,{position:"end",children:e.jsx(H,{onClick:()=>v(!j),edge:"end",children:e.jsx(w,{icon:j?"eva:eye-fill":"eva:eye-off-fill"})})})}}}),(t==="profile"||t==="create")&&e.jsxs($,{spacing:3,children:[e.jsx(te,{required:!0,value:r.alias,name:"alias",label:b("Alias"),onChange:y,onFocus:S}),e.jsx(te,{value:r.firstname?r.firstname:"",name:"firstname",label:b("Firstname"),onChange:y,onFocus:S}),e.jsx(te,{value:r.lastname?r.lastname:"",name:"lastname",label:b("Lastname"),onChange:y,onFocus:S}),e.jsx(te,{disabled:h.id===r.id||r.id===1,required:!0,select:!0,value:g,name:"role",label:b("Role"),onChange:y,onFocus:S,children:typeof s<"u"?s.map(p=>e.jsx(M,{value:p.id,children:p.name},p.name)):null})]}),(t==="settings"||t==="create")&&e.jsxs(te,{required:!0,select:!0,value:u||"dashboard",name:"home",label:b("Home"),onChange:y,onFocus:S,children:[e.jsx(M,{value:"dashboard",children:"Dashboard"}),e.jsx(M,{value:"shellies",children:"Shellies"})]}),e.jsxs($,{direction:"row",alignItems:"baseline",justifyContent:"space-between",spacing:1,children:[e.jsx(k,{variant:"subtitle2",color:n.success?"success":"error",children:b(n.message)}),t==="login"&&e.jsx(Ke,{variant:"subtitle2",underline:"hover",color:"primary",style:{cursor:"pointer"},onClick:()=>l(r.email),children:b("_forgotpw_")})]}),t==="login"?e.jsx(Ln,{disabled:x(),fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"inherit",children:b("Login")}):e.jsx(X,{disabled:x(),fullWidth:!0,size:"large",type:"submit",color:"inherit",variant:"outlined",startIcon:e.jsx(w,{icon:"formkit:submit"}),children:b("Save")})]})})})};At.propTypes={type:i.string,currentUser:i.object,setCurrentUser:i.func,requestResult:i.object,setRequestResult:i.func,roles:i.array,handleForgotten:i.func,handleCurrentUser:i.func};const Le=({type:t,updateuser:n,handleUsersReceived:s,handleUpdateUser:r})=>{const{login:o,user:d,request:l}=V(),[c,h]=a.useState(()=>t==="profile"||t==="settings"||t==="security"?typeof n>"u"?{...d}:n:{alias:"",email:"",firstname:"",lastname:"",password:"",home:"dashboard",roleid:3}),[u,m]=a.useState([]),[g,_]=a.useState({success:!0,message:""}),j=Oe(),v=Te(),b=a.useCallback(p=>{p.data.success?(h(p.data.user),o(p.data.user),j(`/${p.data.user.home!==null?p.data.user.home:"dashboard"}`)):_({success:!1,message:p.data.message})},[j,o]),P=a.useCallback(p=>{_({success:p.data.success,message:p.data.message}),d.id===c.id&&o(c),typeof r<"u"?r(c):v.pathname==="/user"&&re("userUpdated",c)},[d,c,o,r,v]),F=a.useCallback(p=>{_({success:p.data.success,message:p.data.message}),p.data.success&&s(p)},[s]),S=a.useCallback(p=>{m(p.data.roles)},[]),y=a.useCallback(p=>{_({success:p.data.success,message:p.data.message})},[]);a.useEffect(()=>{(t==="profile"||t==="create")&&l({event:"roles get all",data:{name:"Users Form",message:"User Form needs the list of roles"}},S)},[t,S,l]);const R=p=>{t==="login"?l({event:"user validate",data:{source:"User Form",message:"User Form wants to validate a user",user:p}},b):t==="profile"?l({event:"user profile update",data:{source:"User Form",message:"User Form wants to update a users profile",user:p}},P):t==="create"?l({event:"user create",data:{source:"User Form ",message:"User Form wants to create a new user",user:p}},F):t==="security"?l({event:"user security update",data:{source:"User Form ",message:"User Form  wants to update a users credentials",user:p}},P):t==="settings"&&l({event:"user settings update",data:{source:"User Form ",message:"User Form  wants to update a users settings",user:p}},P)},x=p=>{l({event:"user resetpw",data:{name:"User Form",message:"User Form wants to reset a password",email:p}},y)};return e.jsx(At,{type:t,roles:u,requestResult:g,currentUser:c,setCurrentUser:h,setRequestResult:_,handleForgotten:x,handleCurrentUser:R})};Le.propTypes={type:i.string,updateuser:i.object,handleUsersReceived:i.func,handleUpdateUser:i.func};function tt({title:t,openUpdate:n,type:s,updateuser:r,onCloseUpdate:o,handleUpdateUser:d}){return e.jsxs(pe,{anchor:"right",open:n,onClose:o,PaperProps:{sx:{width:300,border:"none",overflow:"hidden"}},children:[e.jsxs($,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{px:1,py:2},children:[e.jsx(k,{variant:"h6",sx:{ml:1},children:t}),e.jsx(H,{onClick:o,children:e.jsx(w,{icon:"eva:close-fill"})})]}),e.jsx(ne,{}),e.jsx(Le,{type:s,updateuser:r,handleUpdateUser:d})]})}tt.propTypes={title:i.string.isRequired,openUpdate:i.bool.isRequired,type:i.string.isRequired,updateuser:i.object,handleUpdateUser:i.func,onCloseUpdate:i.func.isRequired};function zs(){const[t,n]=a.useState(null),[s,r]=a.useState({open:!1,type:""});a.useState(!1);const{user:o,logout:d}=V(),{t:l}=A(),c=Oe(),h=b=>{_(),r({open:!0,type:b})},u=()=>{r({open:!1,type:""})},m=()=>{_(),c(`${o.home}`)},g=b=>{n(b.currentTarget)},_=()=>{n(null)},j=()=>{c("/"),d()},v=b=>l(b==="profile"?"_editprofile_":b==="security"?"_editsecurity_":"_editsettings");return e.jsxs(e.Fragment,{children:[e.jsx(H,{onClick:g,sx:{width:40,height:40,background:b=>T(b.palette.grey[500],.08),...t&&{background:b=>`linear-gradient(135deg, ${b.palette.primary.light} 0%, ${b.palette.primary.main} 100%)`}},children:e.jsx(de,{src:`/assets/images/avatars/avatar_${se(o.id,25)}.jpg`,alt:o.name,sx:{width:36,height:36,border:b=>`solid 2px ${b.palette.background.default}`},children:`${o.firstname!==null?o.firstname:o.alias} ${o.lastname!==null?o.lastname:o.alias}`})}),e.jsxs(be,{open:!!t,anchorEl:t,onClose:_,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},marginThreshold:8,slotProps:{paper:{sx:{p:0,mt:1,ml:.75,width:200}}},children:[e.jsxs(O,{sx:{my:1.5,px:2},children:[e.jsx(k,{variant:"subtitle2",noWrap:!0,children:`${o.firstname!==null?o.firstname:o.alias} ${o.lastname!==null?o.lastname:o.alias}`}),e.jsx(k,{variant:"body2",sx:{color:"text.secondary"},noWrap:!0,children:o.email})]}),e.jsx(ne,{sx:{borderStyle:"dashed"}}),e.jsxs(M,{onClick:m,children:[e.jsx(we,{children:e.jsx(w,{icon:"eva:home-fill"})}),e.jsx(xe,{primary:l("Home")})]},"Home"),e.jsxs(M,{onClick:()=>h("profile"),children:[e.jsx(we,{children:e.jsx(w,{icon:"eva:person-fill"})}),e.jsx(xe,{primary:l("Profile")})]},"Profile"),e.jsxs(M,{onClick:()=>h("security"),children:[e.jsx(we,{children:e.jsx(w,{icon:"eva:lock-fill"})}),e.jsx(xe,{primary:l("Security")})]},"Security"),e.jsxs(M,{onClick:()=>h("settings"),children:[e.jsx(we,{children:e.jsx(w,{icon:"eva:settings-2-fill"})}),e.jsx(xe,{primary:l("Settings")})]},"Settings"),e.jsx(ne,{sx:{borderStyle:"dashed",m:0}}),e.jsx(M,{disableRipple:!0,disableTouchRipple:!0,onClick:j,sx:{typography:"body2",color:"error.main",py:1.5},children:l("Logout")})]}),e.jsx(tt,{title:v(s.type),openUpdate:s.open,type:s.type,onCloseUpdate:u})]})}function Ms(){const[t,n]=a.useState(null),{t:s,i18n:{changeLanguage:r,language:o}}=A(),[d,l]=a.useState(o),[c,h]=a.useState(0),u=(_,j)=>{l(_),h(j),r(_),localStorage.setItem("i18nLanguage",_),g()},m=_=>{n(_.currentTarget)},g=()=>{n(null)};return e.jsxs(e.Fragment,{children:[e.jsx(H,{onClick:m,sx:{width:40,height:40,...t&&{bgcolor:"action.selected"}},children:e.jsx("img",{src:`/assets/icons/flags/${d}.svg`,alt:s($e[c].label)})}),e.jsx(be,{open:!!t,anchorEl:t,onClose:g,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{p:0,mt:1,ml:.75,width:180}}},children:$e.map((_,j)=>e.jsxs(M,{selected:_.value===$e[c].value,onClick:v=>u(_.value,j),sx:{typography:"body2",py:1},children:[e.jsx(O,{component:"img",alt:_.label,src:`/assets/icons/flags/${_.value}.svg`,sx:{width:28,mr:2}}),s(_.label)]},_.value))})]})}function qs(){const[t,n]=a.useState([]),s=t.filter(y=>y.isUnread===!0).length,[r,o]=a.useState(null),{request:d,subscribe:l,unsubscribe:c,send:h}=V(),u=a.useRef(f()),m=a.useRef(!1),{t:g}=A(),_=a.useCallback(y=>{const{notification:R}=y.data,x=[...t];x.push({id:R.id,type:R.type,title:`Error: ${R.device_cname}, Script: ${R.script_name}`,description:R.notification,avatar:null,createdAt:new Date(R.ts),isUnread:R.isUnread===1}),n(x)},[t]),j=a.useCallback(y=>{m.current=!0;const R=y.data.notifications.map((x,p)=>({id:x.id,type:x.type,title:`Error: ${x.device_cname}, Script: ${x.script_name}`,description:x.notification,avatar:null,createdAt:new Date(x.ts),isUnread:x.isUnread===1}));n(R)},[n]);a.useEffect(()=>{const y=u.current;return m.current||d({event:"notifications get all",data:{name:"Notifications Popover",message:"Notifications Popover needs the list of notifications"}},j),l({subscriptionID:u.current,callback:_,all:!0},["ScriptError"]),()=>{c(y,["ScriptError"])}},[j,_,l,c,d]);const v=y=>{o(y.currentTarget)},b=()=>{o(null)},P=()=>{const y=[],R=t.map(x=>(x.isUnread=!1,y.push(x.id),x));n(R),h({event:"notification update",data:{source:"Notifications Popover",message:"Notifications Popover wants to update notifications",ids:y}})},F=y=>{const R=[],x=t.map(p=>(y.id===p.id&&(p.isUnread=!1,R.push(p.id)),p));n(x),h({event:"notification update",data:{source:"Notifications Popover",message:"Notifications Popover wants to update notifications",ids:R}})},S=y=>{d({event:"notification delete",data:{source:"Notifications Popover",message:"Notifications Popover wants to delete a notification",ids:[y]}},j)};return e.jsxs(e.Fragment,{children:[e.jsx(H,{color:r?"primary":"default",onClick:v,children:e.jsx(Un,{badgeContent:s,color:"error",children:e.jsx(w,{width:24,icon:"solar:bell-bing-bold-duotone"})})}),e.jsxs(be,{open:!!r,anchorEl:r,onClose:b,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{mt:1.5,ml:.75,width:360}}},children:[e.jsxs(O,{sx:{display:"flex",alignItems:"center",py:2,px:2.5},children:[e.jsxs(O,{sx:{flexGrow:1},children:[e.jsx(k,{variant:"subtitle1",children:g("Notifications")}),e.jsx(k,{variant:"body2",sx:{color:"text.secondary"},children:g("_unreadmessages_",{totalUnRead:s})})]}),s>0&&e.jsx(Ye,{title:g("_markallasread_"),children:e.jsx(H,{color:"primary",onClick:P,children:e.jsx(w,{icon:"eva:done-all-fill"})})})]}),e.jsx(ne,{sx:{borderStyle:"dashed"}}),e.jsxs(Ae,{sx:{height:{xs:340,sm:"auto"}},children:[e.jsx(lt,{disablePadding:!0,subheader:e.jsx(ct,{disableSticky:!0,sx:{py:1,px:2.5,typography:"overline"},children:g("Unread")}),children:t.filter(y=>y.isUnread===!0).map(y=>e.jsx(qe,{notification:y,handleItemClick:F},f()))}),e.jsx(lt,{disablePadding:!0,subheader:e.jsx(ct,{disableSticky:!0,sx:{py:1,px:2.5,typography:"overline"},children:g("Read")}),children:t.filter(y=>y.isUnread===!1).map(y=>e.jsx(qe,{notification:y,handleItemDelete:S},f()))})]})]})]})}function qe({notification:t,handleItemClick:n,handleItemDelete:s}){const{avatar:r,title:o}=Hs(t),{i18n:d}=A(),l=()=>{switch(d.language){case"en":return pt;case"de":return us;case"es":return ds;default:return pt}};return e.jsxs(Ct,{onClick:c=>{t.isUnread&&n(t)},sx:{py:1.5,px:2.5,mt:"1px",...t.isUnread&&{bgcolor:"action.selected"}},children:[e.jsx(Bn,{children:e.jsx(de,{sx:{bgcolor:"background.neutral"},children:r})}),e.jsxs($,{direction:"row",spacing:3,alignItems:"start",justifyContent:"space-between",children:[e.jsx(xe,{primary:o,secondary:e.jsxs(k,{variant:"caption",sx:{mt:.5,display:"flex",alignItems:"center",color:"text.disabled"},children:[e.jsx(w,{icon:"eva:clock-outline",sx:{mr:.5,width:16,height:16}}),cs(t.createdAt,{addSuffix:!0,locale:l()})]}),sx:{maxWidth:200}}),!t.isUnread&&e.jsx(H,{onClick:c=>{s(t.id)},children:e.jsx(w,{icon:"eva:trash-2-outline",sx:{mr:2}})})]})]})}function Hs(t){const n=e.jsxs(e.Fragment,{children:[e.jsxs(k,{variant:"subtitle2",children:[t.title," "]}),e.jsx(k,{component:"span",variant:"body2",style:{whiteSpace:"pre-line"},sx:{color:"text.secondary"},children:t.description})]});return t.type==="script-error"?{avatar:e.jsx("img",{alt:t.title,src:"/assets/icons/ic_notification_error.svg"}),title:n}:{avatar:t.avatar?e.jsx("img",{alt:t.title,src:t.avatar}):null,title:n}}qe.propTypes={handleItemDelete:i.func,handleItemClick:i.func,notification:i.shape({createdAt:i.instanceOf(Date),id:i.number,isUnread:i.bool,title:i.string,description:i.string,type:i.string,avatar:i.any})};function Lt({onOpenNav:t}){const n=ue(),s=Te(),r=Ie("up","lg"),o=e.jsxs(e.Fragment,{children:[!r&&e.jsx(H,{onClick:t,sx:{mr:1},children:e.jsx(w,{icon:"eva:menu-2-fill"})}),e.jsx(O,{sx:{flexGrow:1}}),e.jsxs($,{direction:"row",alignItems:"center",spacing:1,children:[(s.pathname==="/dashboard"||s.pathname==="/shellies")&&e.jsx(Ws,{}),e.jsx(Ms,{}),e.jsx(qs,{}),e.jsx(zs,{})]})]});return e.jsx(Nn,{sx:{boxShadow:"none",height:Re.H_MOBILE,zIndex:n.zIndex.appBar+1,...Pe({color:n.palette.background.default}),transition:n.transitions.create(["height"],{duration:n.transitions.duration.shorter}),...r&&{width:`calc(100% - ${fe.WIDTH+1}px)`,height:Re.H_DESKTOP}},children:e.jsx(St,{sx:{height:1,px:{lg:5}},children:o})})}Lt.propTypes={onOpenNav:i.func};function Ut({children:t}){const[n,s]=a.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(Lt,{onOpenNav:()=>s(!0)}),e.jsxs(O,{sx:{minHeight:1,display:"flex",flexDirection:{xs:"column",lg:"row"}},children:[e.jsx(Ot,{openNav:n,onCloseNav:()=>s(!1)}),e.jsx(Dt,{children:t})]})]})}Ut.propTypes={children:i.node};const mt=a.lazy(()=>ae(()=>Promise.resolve().then(()=>mr),void 0)),bt=a.lazy(()=>ae(()=>Promise.resolve().then(()=>jr),void 0)),Vs=a.lazy(()=>ae(()=>Promise.resolve().then(()=>$r),void 0)),Gs=a.lazy(()=>ae(()=>Promise.resolve().then(()=>Tr),void 0)),Js=a.lazy(()=>ae(()=>Promise.resolve().then(()=>Dr),void 0)),yt=a.lazy(()=>ae(()=>Promise.resolve().then(()=>Gr),void 0)),Ks=a.lazy(()=>ae(()=>Promise.resolve().then(()=>Yr),void 0));function Ys(){const{user:t}=V();return Dn([{path:"/",element:e.jsx(Js,{})},{element:t?e.jsx(Ut,{children:e.jsx(a.Suspense,{children:e.jsx(In,{})})}):e.jsx(at,{to:"/",replace:!0}),children:t&&t.roleid===1?[{path:"dashboard",element:e.jsx(mt,{}),index:!0},{path:"user",element:e.jsx(Vs,{})},{path:"shellies",element:e.jsx(yt,{})},{path:"blog",element:e.jsx(bt,{})}]:[{path:"dashboard",element:e.jsx(mt,{}),index:!0},{path:"shellies",element:e.jsx(yt,{})},{path:"blog",element:e.jsx(bt,{})}]},{path:"login",element:e.jsx(Gs,{})},{path:"404",element:e.jsx(Ks,{})},{path:"*",element:e.jsx(at,{to:"/404",replace:!0})}])}function Xs(){const{pathname:t}=Te();return a.useEffect(()=>{window.scrollTo(0,0)},[t]),null}const B={0:"#FFFFFF",100:"#F9FAFB",200:"#F4F6F8",300:"#DFE3E8",400:"#C4CDD5",500:"#919EAB",600:"#637381",700:"#454F5B",800:"#212B36",900:"#161C24"},Bt={lighter:"#D0ECFE",light:"#73BAFB",main:"#1877F2",dark:"#0C44AE",darker:"#042174",contrastText:"#FFFFFF"},Nt={lighter:"#EFD6FF",light:"#C684FF",main:"#8E33FF",dark:"#5119B7",darker:"#27097A",contrastText:"#FFFFFF"},Wt={lighter:"#CAFDF5",light:"#61F3F3",main:"#00B8D9",dark:"#006C9C",darker:"#003768",contrastText:"#FFFFFF"},zt={lighter:"#C8FAD6",light:"#5BE49B",main:"#00A76F",dark:"#007867",darker:"#004B50",contrastText:"#FFFFFF"},Mt={lighter:"#FFF5CC",light:"#FFD666",main:"#FFAB00",dark:"#B76E00",darker:"#7A4100",contrastText:B[800]},qt={lighter:"#FFE9D5",light:"#FFAC82",main:"#FF5630",dark:"#B71D18",darker:"#7A0916",contrastText:"#FFFFFF"},Ht={black:"#000000",white:"#FFFFFF"},Zs={hover:T(B[500],.08),selected:T(B[500],.16),disabled:T(B[500],.8),disabledBackground:T(B[500],.24),focus:T(B[500],.24),hoverOpacity:.08,disabledOpacity:.48},jt={primary:Bt,secondary:Nt,info:Wt,success:zt,warning:Mt,error:qt,grey:B,common:Ht,divider:T(B[500],.2),action:Zs};function Qs(){return{...jt,mode:"light",text:{primary:B[800],secondary:B[600],disabled:B[500]},background:{paper:"#FFFFFF",default:B[100],neutral:B[200]},action:{...jt.action,active:B[600]}}}function er(){const t=T(B[500],.2),n=T(B[500],.14),s=T(B[500],.12);return["none",`0px 2px 1px -1px ${t},0px 1px 1px 0px ${n},0px 1px 3px 0px ${s}`,`0px 3px 1px -2px ${t},0px 2px 2px 0px ${n},0px 1px 5px 0px ${s}`,`0px 3px 3px -2px ${t},0px 3px 4px 0px ${n},0px 1px 8px 0px ${s}`,`0px 2px 4px -1px ${t},0px 4px 5px 0px ${n},0px 1px 10px 0px ${s}`,`0px 3px 5px -1px ${t},0px 5px 8px 0px ${n},0px 1px 14px 0px ${s}`,`0px 3px 5px -1px ${t},0px 6px 10px 0px ${n},0px 1px 18px 0px ${s}`,`0px 4px 5px -2px ${t},0px 7px 10px 1px ${n},0px 2px 16px 1px ${s}`,`0px 5px 5px -3px ${t},0px 8px 10px 1px ${n},0px 3px 14px 2px ${s}`,`0px 5px 6px -3px ${t},0px 9px 12px 1px ${n},0px 3px 16px 2px ${s}`,`0px 6px 6px -3px ${t},0px 10px 14px 1px ${n},0px 4px 18px 3px ${s}`,`0px 6px 7px -4px ${t},0px 11px 15px 1px ${n},0px 4px 20px 3px ${s}`,`0px 7px 8px -4px ${t},0px 12px 17px 2px ${n},0px 5px 22px 4px ${s}`,`0px 7px 8px -4px ${t},0px 13px 19px 2px ${n},0px 5px 24px 4px ${s}`,`0px 7px 9px -4px ${t},0px 14px 21px 2px ${n},0px 5px 26px 4px ${s}`,`0px 8px 9px -5px ${t},0px 15px 22px 2px ${n},0px 6px 28px 5px ${s}`,`0px 8px 10px -5px ${t},0px 16px 24px 2px ${n},0px 6px 30px 5px ${s}`,`0px 8px 11px -5px ${t},0px 17px 26px 2px ${n},0px 6px 32px 5px ${s}`,`0px 9px 11px -5px ${t},0px 18px 28px 2px ${n},0px 7px 34px 6px ${s}`,`0px 9px 12px -6px ${t},0px 19px 29px 2px ${n},0px 7px 36px 6px ${s}`,`0px 10px 13px -6px ${t},0px 20px 31px 3px ${n},0px 8px 38px 7px ${s}`,`0px 10px 13px -6px ${t},0px 21px 33px 3px ${n},0px 8px 40px 7px ${s}`,`0px 10px 14px -6px ${t},0px 22px 35px 3px ${n},0px 8px 42px 7px ${s}`,`0px 11px 14px -7px ${t},0px 23px 36px 3px ${n},0px 9px 44px 8px ${s}`,`0px 11px 15px -7px ${t},0px 24px 38px 3px ${n},0px 9px 46px 8px ${s}`]}function tr(t){return{MuiCssBaseline:{styleOverrides:{"*":{boxSizing:"border-box"},html:{margin:0,padding:0,width:"100%",height:"100%",WebkitOverflowScrolling:"touch"},body:{margin:0,padding:0,width:"100%",height:"100%"},"#root":{width:"100%",height:"100%"},input:{"&[type=number]":{MozAppearance:"textfield","&::-webkit-outer-spin-button":{margin:0,WebkitAppearance:"none"},"&::-webkit-inner-spin-button":{margin:0,WebkitAppearance:"none"}}},img:{maxWidth:"100%",display:"inline-block",verticalAlign:"bottom"}}},MuiBackdrop:{styleOverrides:{root:{backgroundColor:T(t.palette.grey[900],.8)},invisible:{background:"transparent"}}},MuiButton:{styleOverrides:{containedInherit:{color:t.palette.common.white,backgroundColor:t.palette.grey[800],"&:hover":{color:t.palette.common.white,backgroundColor:t.palette.grey[800]}},sizeLarge:{minHeight:48}}},MuiCard:{styleOverrides:{root:{boxShadow:t.customShadows.card,borderRadius:Number(t.shape.borderRadius)*2,position:"relative",zIndex:0}}},MuiCardHeader:{defaultProps:{titleTypographyProps:{variant:"h6"},subheaderTypographyProps:{variant:"body2"}},styleOverrides:{root:{padding:t.spacing(3,3,0)}}},MuiOutlinedInput:{styleOverrides:{root:{[`& .${Wn.notchedOutline}`]:{borderColor:T(t.palette.grey[500],.24)}}}},MuiPaper:{defaultProps:{elevation:0}},MuiTableCell:{styleOverrides:{head:{color:t.palette.text.secondary,backgroundColor:t.palette.background.neutral}}},MuiTooltip:{styleOverrides:{tooltip:{backgroundColor:t.palette.grey[800]},arrow:{color:t.palette.grey[800]}}},MuiTypography:{styleOverrides:{paragraph:{marginBottom:t.spacing(2)},gutterBottom:{marginBottom:t.spacing(1)}}},MuiMenuItem:{styleOverrides:{root:{...t.typography.body2}}}}}function J(t){return`${t/16}rem`}function le({sm:t,md:n,lg:s}){return{"@media (min-width:600px)":{fontSize:J(t)},"@media (min-width:900px)":{fontSize:J(n)},"@media (min-width:1200px)":{fontSize:J(s)}}}const nr="Public Sans, sans-serif",sr="Barlow, sans-serif",rr={fontFamily:nr,fontSecondaryFamily:sr,fontWeightRegular:400,fontWeightMedium:500,fontWeightSemiBold:600,fontWeightBold:700,h1:{fontWeight:800,lineHeight:80/64,fontSize:J(40),...le({sm:52,md:58,lg:64})},h2:{fontWeight:800,lineHeight:64/48,fontSize:J(32),...le({sm:40,md:44,lg:48})},h3:{fontWeight:700,lineHeight:1.5,fontSize:J(24),...le({sm:26,md:30,lg:32})},h4:{fontWeight:700,lineHeight:1.5,fontSize:J(20),...le({sm:20,md:24,lg:24})},h5:{fontWeight:700,lineHeight:1.5,fontSize:J(18),...le({sm:19,md:20,lg:20})},h6:{fontWeight:700,lineHeight:28/18,fontSize:J(17),...le({sm:18,md:18,lg:18})},subtitle1:{fontWeight:600,lineHeight:1.5,fontSize:J(16)},subtitle2:{fontWeight:600,lineHeight:22/14,fontSize:J(14)},body1:{lineHeight:1.5,fontSize:J(16)},body2:{lineHeight:22/14,fontSize:J(14)},caption:{lineHeight:1.5,fontSize:J(12)},overline:{fontWeight:700,lineHeight:1.5,fontSize:J(12),textTransform:"uppercase"},button:{fontWeight:700,lineHeight:24/14,fontSize:J(14),textTransform:"unset"}};function or(){const t=T(B[500],.16);return{z1:`0 1px 2px 0 ${t}`,z4:`0 4px 8px 0 ${t}`,z8:`0 8px 16px 0 ${t}`,z12:`0 12px 24px -4px ${t}`,z16:`0 16px 32px -4px ${t}`,z20:`0 20px 40px -4px ${t}`,z24:`0 24px 48px 0 ${t}`,card:`0 0 2px 0 ${T(B[500],.08)}, 0 12px 24px -4px ${T(B[500],.08)}`,dropdown:`0 0 2px 0 ${T(B[500],.24)}, -20px 20px 40px -4px ${T(B[500],.24)}`,dialog:`-40px 40px 80px -8px ${T(Ht.black,.24)}`,primary:`0 8px 16px 0 ${T(Bt.main,.24)}`,info:`0 8px 16px 0 ${T(Wt.main,.24)}`,secondary:`0 8px 16px 0 ${T(Nt.main,.24)}`,success:`0 8px 16px 0 ${T(zt.main,.24)}`,warning:`0 8px 16px 0 ${T(Mt.main,.24)}`,error:`0 8px 16px 0 ${T(qt.main,.24)}`}}function Vt({children:t}){const n=a.useMemo(()=>({palette:Qs(),typography:rr,shadows:er(),customShadows:or(),shape:{borderRadius:8}}),[]),s=zn(n);return s.components=tr(s),e.jsxs(Mn,{theme:s,children:[e.jsx(qn,{}),t]})}Vt.propTypes={children:i.node};function ir(){return Xs(),e.jsx(Ft,{children:e.jsx(Vt,{children:e.jsx(Ys,{})})})}const ar=Pn.createRoot(document.getElementById("root"));ar.render(e.jsx(Tn,{children:e.jsx(Rn,{children:e.jsx(a.Suspense,{children:e.jsx(ir,{})})})}));function lr(t){const n=typeof t<"u"?xs(t).format("0.00a"):"";return nt(n,".00")}function _t(t){const n=typeof t<"u"?`${(t/1e3/1e3*60).toFixed(2)} kw/h`:"";return nt(n,"")}function me(t){const n=typeof t<"u"?`${(t/1e3*60).toFixed(2)} w/h`:"";return nt(n,"")}function nt(t,n){return t.includes(n)?t.replace(n,""):t}const st=({title:t})=>e.jsx($,{direction:"row",sx:{justifyContent:"space-between",alignItems:"baseline"},children:e.jsx(k,{variant:"h4",children:t})});st.propTypes={title:i.string};const cr=()=>{const t=ue();return[t.palette.success.darker,t.palette.info.main,t.palette.error.main,t.palette.warning.main,t.palette.success.main,t.palette.warning.dark,t.palette.info.dark,t.palette.info.darker,t.palette.primary.main]},dr=Ee(gs)(({theme:t})=>({"& .apexcharts-canvas":{"& .apexcharts-tooltip":{...Pe({color:t.palette.background.default}),color:t.palette.text.primary,boxShadow:t.customShadows.dropdown,borderRadius:t.shape.borderRadius*1.25,"&.apexcharts-theme-light":{borderColor:"transparent",...Pe({color:t.palette.background.default})}},"& .apexcharts-xaxistooltip":{...Pe({color:t.palette.background.default}),borderColor:"transparent",color:t.palette.text.primary,boxShadow:t.customShadows.dropdown,borderRadius:t.shape.borderRadius*1.25,"&:before":{borderBottomColor:T(t.palette.grey[500],.24)},"&:after":{borderBottomColor:T(t.palette.background.default,.8)}},"& .apexcharts-tooltip-title":{textAlign:"center",fontWeight:t.typography.fontWeightBold,backgroundColor:T(t.palette.grey[500],.08),color:t.palette.text[t.palette.mode==="light"?"secondary":"primary"]},"& .apexcharts-legend":{padding:0},"& .apexcharts-legend-series":{display:"inline-flex !important",alignItems:"center"},"& .apexcharts-legend-marker":{marginRight:8},"& .apexcharts-legend-text":{lineHeight:"18px",textTransform:"capitalize"}}})),Gt=a.memo(dr);function ge({title:t,subtitle:n,icon:s,color:r="primary",sx:o,...d}){return e.jsxs(ie,{component:$,spacing:3,direction:"row",sx:{px:3,py:5,borderRadius:2,...o},...d,children:[s&&e.jsx(O,{sx:{width:64,height:64},children:s}),e.jsxs($,{spacing:.5,children:[e.jsx(k,{variant:"h5",children:t}),e.jsx(k,{variant:"subtitle2",sx:{color:"text.disabled"},children:n})]})]})}ge.propTypes={color:i.string,icon:i.oneOfType([i.element,i.string]),sx:i.object,title:i.string,subtitle:i.string};function Jt(t,n){var l,c;let s,r=0,o=!1;const d=[];for(let h=0;h<=3;h+=1)if(s=n[`switch:${h}`],typeof((l=s==null?void 0:s.aenergy)==null?void 0:l.by_minute)<"u"){o=!0;const u=Number(s.aenergy.by_minute[0]);u>0&&(r+=u,d.push({label:`${t} switch:${h}`,value:u}))}if(s=n["rgbw:0"],typeof((c=s==null?void 0:s.aenergy)==null?void 0:c.by_minute)<"u"){o=!0;const h=Number(s.aenergy.by_minute[0]);h>0&&(r+=h,d.push({label:`${t} rgbw:0`,value:h}))}return{hasSwitch:o,totalPower:r,powerPerDevice:d}}function ur(t){let n=0,s=0,r=0,o=0,d=0,l=[];const c=[];let h={hasSwitch:!1,totalPower:0,powerPerDevice:[]};return Object.values(t).forEach((u,m)=>{var _,j,v;const g=(j=(_=u==null?void 0:u.wsmessages)==null?void 0:_.NotifyFullStatus)==null?void 0:j.params;if(u.online&&(r+=1),typeof g<"u"&&(h=Jt(u.cname,g),h.totalPower>0&&c.push(u.chartColor),l=l.concat(h.powerPerDevice),d+=h.totalPower,typeof((v=g==null?void 0:g.cloud)==null?void 0:v.connected)<"u"&&g.cloud.connected&&(o+=1),typeof u.scripts<"u")){let b;Object.values(u.scripts).forEach(P=>{b=g[`script:${P.id}`],b!=="undefined"&&(n+=1,b.running&&(s+=1),P.running=b.running)})}}),{currentPower:d,powerPerDevice:l,colorPerDevice:c,scriptsRunning:s,scriptsCount:n,cloudCount:o,onlineCount:r}}function pr(t){const n=ue();Ie("up","sm");const s={show:!0,label:"Total",color:n.palette.text.secondary,fontSize:n.typography.subtitle2.fontSize,fontWeight:n.typography.subtitle2.fontWeight,lineHeight:n.typography.subtitle2.lineHeight},r={offsetY:8,color:n.palette.text.primary,fontSize:n.typography.h3.fontSize,fontWeight:n.typography.h3.fontWeight,lineHeight:n.typography.h3.lineHeight},o={chart:{toolbar:{show:!1},zoom:{enabled:!1,type:"xy"},animations:{enabled:!0},foreColor:n.palette.text.disabled,fontFamily:n.typography.fontFamily},states:{hover:{filter:{type:"lighten",value:.04}},active:{filter:{type:"darken",value:.88}}},fill:{opacity:1,gradient:{type:"vertical",shadeIntensity:0,opacityFrom:.4,opacityTo:0,stops:[0,100]}},dataLabels:{enabled:!1},stroke:{width:3,curve:"smooth",lineCap:"round"},grid:{strokeDashArray:3,borderColor:n.palette.divider,xaxis:{lines:{show:!1}}},xaxis:{tickPlacement:"on",axisBorder:{show:!1},axisTicks:{show:!1}},markers:{size:0,strokeColors:n.palette.background.paper},tooltip:{theme:!1,x:{show:!0}},legend:{show:!0,showForSingleSeries:!0,fontSize:13,position:"bottom",horizontalAlign:"center",markers:{radius:12},fontWeight:500,itemMargin:{horizontal:8},labels:{colors:n.palette.text.primary}},plotOptions:{bar:{borderRadius:0},pie:{donut:{labels:{show:!0,value:r,total:s}}},radialBar:{track:{strokeWidth:"100%",background:T(n.palette.grey[500],.16)},dataLabels:{value:r,total:s}},radar:{polygons:{fill:{colors:["transparent"]},strokeColors:n.palette.divider,connectorColors:n.palette.divider}},polarArea:{rings:{strokeColor:n.palette.divider},spokes:{connectorColors:n.palette.divider}}},responsive:[{breakpoint:n.breakpoints.values.sm,options:{plotOptions:{bar:{columnWidth:"40%"}}}},{breakpoint:n.breakpoints.values.md,options:{plotOptions:{bar:{columnWidth:"32%"}}}}]};return ps(o,t)}function Kt({title:t,subheader:n,colors:s,series:r,...o}){const d=ue(),l=[],c=[];r.forEach(u=>{l.push(u.label),c.push(u.value)});const h={labels:l,stroke:{colors:[d.palette.background.paper]},legend:{show:!0,position:"bottom"},colors:s,dataLabels:{enabled:!0,dropShadow:{enabled:!1}},tooltip:{fillSeriesColor:!1,shared:!0,intersect:!1,y:{formatter:u=>typeof u<"u"?me(u):u}}};return e.jsxs(ie,{...o,children:[e.jsx(Xe,{title:t,subheader:n,sx:{mb:5}}),e.jsx(Gt,{dir:"ltr",type:"pie",series:c,options:h,width:"100%",height:280})]})}Kt.propTypes={chart:i.object,subheader:i.string,title:i.string,colors:i.array,series:i.array};function Yt({title:t,subheader:n,chart:s,handleTimelineChange:r,selection:o,...d}){const{labels:l,colors:c,series:h,timeline:u,maxConsumption:m}=s,{t:g}=A(),_=pr({colors:c,plotOptions:{bar:{columnWidth:"28%"}},chart:{stacked:u.data!=="Minute"},yaxis:{labels:{formatter(j){return u.data==="Minute"?m/1e3*60<1e3?me(j):_t(j):m/1e3<1e3?`${(j/1e3).toFixed(2)} w/h`:`${(j/1e3/1e3).toFixed(2)} kw/h`}},forceNiceScale:!0},xaxis:{type:"datetime",labels:{format:u.format,datetimeUTC:!1}},tooltip:{shared:!0,intersect:!1,x:{show:!0,format:u.format||"undefined"},y:{formatter(j){return u.data==="Minute"?m/1e3*60<9e3?me(j):_t(j):m/1e3<9e3?`${(j/1e3).toFixed(2)} w/h`:`${(j/1e3/1e3).toFixed(2)} kw/h`}}}});return e.jsxs(ie,{...d,children:[e.jsx(Xe,{title:t,subheader:n,action:e.jsx(Je,{sx:{m:1,minWidth:120},size:"small",children:e.jsxs(Hn,{value:o,onChange:r,children:[e.jsx(M,{value:"0",children:g("_byminute_")}),e.jsx(M,{value:"1",children:g("_byhour_")}),e.jsx(M,{value:"2",children:g("_byday_")}),e.jsx(M,{value:"3",children:g("_bymonth_")}),e.jsx(M,{value:"4",children:g("_byyear_")})]})})}),e.jsx(O,{sx:{p:3,pb:1},children:e.jsx(Gt,{dir:"ltr",type:h[0].type,series:h,options:_,width:"100%",height:364})})]})}Yt.propTypes={chart:i.object,subheader:i.string,title:i.string,handleTimelineChange:i.func,selection:i.number};function hr(t){const n={};switch(t){case 1:n.data="Hour",n.format="HH:00",n.catformat="yyyy-MM-dd HH:00";break;case 2:n.data="Day",n.format="d.MM",n.catformat="yyyy-MM-dd";break;case 3:n.data="Month",n.format="MMM.yyyy",n.catformat="yyyy-MM";break;case 4:n.data="Year",n.format="yyyy",n.catformat="yyyy";break;default:n.data="Minute",n.format="H:mm",n.catformat="yyyy-MM-dd HH:mm"}return n}function xr(t,n,s){const r=[],o=[],d=[],l=[];let c=0;return n.forEach((h,u)=>{h.consumption>c&&(c=h.consumption);const m=It(h.ts,s.catformat);r.includes(m)||r.push(m);const g=d.indexOf(h.device_id);if(g===-1){const _=t.findIndex(j=>j.id===h.device_id);_!==-1?(d.push(h.device_id),l.push(t[_].chartColor),o.push({name:h.device_cname,type:s.data==="Minute"?"line":"bar",data:[{x:m,y:h.consumption}]})):console.error(`Could not finde device with id ${h.device_id}`)}else o[g].data.push({x:m,y:h.consumption})}),{labels:r,series:o,colors:l,maxConsumption:c}}function gr(){const[t,n]=a.useState(0),[s,r]=a.useState({running:0,count:0}),[o,d]=a.useState(0),[l,c]=a.useState([]),[h,u]=a.useState([]),[m,g]=a.useState({online:0,count:0}),[_,j]=a.useState({labels:[],colors:[],series:[],timeline:{},maxConsumption:0}),[v,b]=a.useState([]),{t:P}=A(),[F,S]=a.useState(0),y=a.useRef({data:"Minute",format:"HH:mm",catformat:"yyyy-MM-dd HH:mm"}),{user:R,request:x,subscribe:p,unsubscribe:C}=V(),I=cr(),N=a.useRef(f()),G=a.useCallback(W=>{let L;if(v.length!==0)L=v;else if(typeof W.data.devices<"u")L=W.data.devices;else return;const{rows:ee}=W.data,Z=xr(L,ee,y.current);L.length>0&&j({labels:Z.labels,colors:Z.colors,series:Z.series,timeline:y.current,maxConsumption:Z.maxConsumption})},[v]),U=a.useCallback(W=>{const L=ur(W),{currentPower:ee}=L;r({running:L.scriptsRunning,count:L.scriptsCount}),d(L.cloudCount),c(L.powerPerDevice),u(L.colorPerDevice),n(ee),g({online:L.onlineCount,count:W.length}),b(W),x({event:`getTimeline${y.current.data}`,data:{name:"App View",message:"App View needs timeline for a device"}},G)},[x,G]),Q=a.useCallback(W=>{const L=W.data.device;if(W.event==="ShellyUpdate"&&W.type==="ws"){const ee=v.map((Z,_e)=>Z.id===L.id?(L.chartColor=I[se(_e+1,I.length)],L):Z);U(ee)}},[U,v,I]),Ue=W=>{const L=Number(W.target.value);S(L),y.current=hr(L),x({event:`getTimeline${y.current.data}`,data:{source:"App View",message:"App View needs timeline for a device"}},G)},je=a.useCallback(W=>{const L=W.data.devices.map((ee,Z)=>(ee.chartColor=I[se(Z+1,I.length)],ee));G(W),U(L)},[I,U,G]);return a.useEffect(()=>{const W=N.current;return v.length===0&&x({event:"devices timeline get",data:{name:"App View",message:"App View needs the list of devices and the timeline"}},je),p({subscriptionID:W,callback:Q,all:!0},["ShellyUpdate"]),()=>{C(W,["ShellyUpdate"])}},[v.length,je,Q,C,p,x]),v.length===0?null:e.jsxs(he,{maxWidth:"xl",children:[e.jsx($,{direction:"row",children:e.jsx(st,{title:`${P("_welcome_")} ${R.firstname!==null?R.firstname:R.alias}`})}),e.jsxs(Y,{container:!0,spacing:3,children:[e.jsx(Y,{size:{xs:12,sm:6,md:3},children:e.jsx(ge,{title:`${m.online}/${m.count}`,subtitle:`Shellies ${P("Connected")}`,color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/overview/S-Shelly-Icon.svg"})})}),e.jsx(Y,{size:{xs:12,sm:6,md:3},children:e.jsx(ge,{title:me(t),subtitle:P("_consumption_"),color:"info",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/overview/consumption.svg"})})}),e.jsx(Y,{size:{xs:12,sm:6,md:3},children:e.jsx(ge,{title:`${s.running}/${s.count}`,subtitle:P("Running"),color:"success",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/overview/script.svg"})})}),e.jsx(Y,{size:{xs:12,sm:6,md:3},children:e.jsx(ge,{title:lr(o),subtitle:P("Connected"),color:"error",icon:e.jsx("img",{alt:"icon",src:"/assets/icons/overview/cloud.svg"})})}),e.jsx(Y,{size:{xs:12,sm:12,md:12,lg:12},children:e.jsx(Kt,{title:P("_consumption_"),subheader:P("_perShelly_"),colors:h,series:l})}),e.jsx(Y,{size:{xs:12,sm:12,md:12,lg:12},children:e.jsx(Yt,{title:"Timeline",subheader:P("_perShelly_"),chart:_,handleTimelineChange:Ue,selection:F})})]})]})}function fr(){const{user:t}=V();return e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("title",{children:" Dashboard"})}),t?e.jsx(gr,{}):null]})}const mr=Object.freeze(Object.defineProperty({__proto__:null,default:fr},Symbol.toStringTag,{value:"Module"}));function Xt({handleContentChange:t,content:n}){const{t:s}=A(),r=["heading","bold","italic","strike","link","underline","code","orderedList","bulletList","align","codeBlock","blockquote","history","color"],o={editor:{editor:"Editor",preview:s("_editor-preview_")},toolbar:{bold:s("_editor-bold_"),italic:s("_editor-italic_"),strike:s("_editor-strike_"),underline:s("_editor-underline_"),link:s("_editor-link_"),bulletList:s("_editor-bulletlist_"),orderedList:s("_editor-orderedlist_"),alignLeft:s("_editor-alignleft_"),alignCenter:s("_editor-aligncenter_"),alignRight:s("_editor-alignright_"),alignJustify:s("_editor-alignjustify_"),blockquote:s("_editor-blockquote_"),codeBlock:s("_editor-codeblock_"),color:s("_editor-color_"),table:"Table",youtube:"Youtube",undo:s("_editor-undo_"),redo:s("_editor-redo_"),mention:"Mention"},headings:{normalText:s("_editor-normaltext_"),h1:s("_editor-h1_"),h2:s("_editor-h2_"),h3:s("_editor-h3_"),h4:s("_editor-h4_"),h5:s("_editor-h5_"),h6:s("_editor-h6_")},table:{table:"Tableau",addColumnBefore:"Ajouter une colonne avant",addColumnAfter:"Ajouter une colonne apr칟s",deleteColumn:"Supprimer la colonne",addRowBefore:"Ajouter une ligne avant",addRowAfter:"Ajouter une ligne apr칟s",deleteRow:"Supprimer la ligne",mergeCells:"Fusionner les cellules",splitCell:"Diviser la cellule",deleteTable:"Supprimer le tableau",insertTable:"Ins칠rer un tableau",toggleHeaderCell:"Basculer la cellule d'en-t칡te",toggleHeaderColumn:"Basculer la colonne d'en-t칡te",toggleHeaderRow:"Basculer la ligne d'en-t칡te",mergeOrSplit:"Fusionner ou diviser",setCellAttribute:"D칠finir l'attribut de cellule"},link:{link:s("_editor-link_"),insert:s("_editor-insertlink_"),invalid:s("_editor-invalidlink_")},youtube:{link:"Lien",insert:"Ins칠rer la vid칠o Youtube",title:"Ins칠rer une vid칠o Youtube",invalid:"Lien invalide",enter:"Entrer le lien",height:"Hauteur",width:"Largeur"}};return e.jsx("div",{children:e.jsx(ms,{value:n,onChange:t,toolbar:r,placeholder:s("_editor-placeholder_"),disableTabs:!0,toolbarPosition:"top",labels:o,withBubbleMenu:!1})})}Xt.propTypes={handleContentChange:i.func.isRequired,content:i.string};const rt=({type:t,handleUpdatePost:n,updatepost:s,handleBlogpostsReceived:r})=>{const{user:o,request:d}=V(),[l,c]=a.useState(t==="update"?s:{title:"",content:"",public:0}),{t:h}=A(),[u,m]=a.useState({success:!0,message:""}),g=F=>{m({success:F.data.success,message:F.data.message}),F.data.success&&r(F)},_=F=>{m({success:F.data.success,message:F.data.message}),F.data.success&&n(l)},j=({target:F})=>{const S={...l};F.name==="public"?S.public=F.checked?1:0:S[F.name]=F.value,c(S)},v=F=>{const S={...l};S.content=F,c(S)},b=F=>{F.preventDefault(),t==="create"?(l.userid=o.id,l.createdAt=Date.now(),d({event:"blogpost create",data:{name:"Blogpost Form",message:"Blogpost Form wants to create a new post",blogpost:l}},g)):t==="update"&&d({event:"blogpost update",data:{name:"Blogpost Form",message:"Blogpost Form wants to update a post",blogpost:l}},_)},P=()=>typeof l.title>"u"||l.title.length===0||typeof l.content>"u"||l.content.length===0||kt(s,l);return e.jsx("form",{onSubmit:b,children:e.jsx(Je,{fullWidth:!0,size:"subtitle2",children:e.jsxs($,{spacing:3,sx:{px:3,py:3},children:[e.jsxs($,{direction:"row",spacing:3,children:[e.jsx(te,{required:!0,value:l.title,name:"title",label:h("Title"),slotProps:{htmlInput:{maxLength:40}},onChange:j,sx:{width:280}}),e.jsx(Me,{control:e.jsx(Vn,{name:"public",size:"medium",checked:l.public===1,onChange:j}),label:"Public",labelPlacement:"bottom"})]}),e.jsx(Xt,{handleContentChange:v,content:l.content}),e.jsx(k,{variant:"subtitle2",color:u.success?"success":"error",children:h(u.message)}),e.jsx(X,{disabled:P(),fullWidth:!0,size:"large",type:"submit",color:"inherit",variant:"outlined",startIcon:e.jsx(w,{icon:"formkit:submit"}),children:h("Save")})]})})})};rt.propTypes={type:i.string.isRequired,handleBlogpostsReceived:i.func,updatepost:i.object,handleUpdatePost:i.func};function Zt({openUpdate:t,updatepost:n,onCloseUpdate:s,handleUpdatePost:r}){const{t:o}=A();return e.jsxs(pe,{anchor:"right",open:t,onClose:s,PaperProps:{sx:{width:1,border:"none",overflow:"auto"}},children:[e.jsxs($,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{px:1,py:2},children:[e.jsx(k,{variant:"h6",sx:{ml:1},children:o("_editpost_")}),e.jsx(H,{onClick:s,children:e.jsx(w,{icon:"eva:close-fill"})})]}),e.jsx(ne,{}),e.jsx(rt,{type:"update",handleUpdatePost:r,updatepost:n})]})}Zt.propTypes={openUpdate:i.bool.isRequired,updatepost:i.object,handleUpdatePost:i.func,onCloseUpdate:i.func.isRequired};function ot({blogpost:t,index:n,handleDeletePost:s}){const[r,o]=a.useState(null),[d,l]=a.useState(!1),[c,h]=a.useState(!1),[u,m]=a.useState(!1),[g,_]=a.useState(t),{t:j}=A(),{user:v}=V(),b=n===0,P=n===1||n===2,F=U=>{const Q={...g};Q.title=U.title,Q.content=U.content,Q.public=U.public,_(Q)},S=U=>{o(U.currentTarget),m(!1)},y=()=>{o(null)},R=()=>{l(!1)},x=()=>{l(!0),o(null)},p=()=>{m(!0)},C=e.jsx(de,{alt:g.author.name,src:g.author.avatarUrl,sx:{zIndex:9,width:32,height:32,position:"absolute",left:U=>U.spacing(3),bottom:U=>U.spacing(-2),...(b||P)&&{zIndex:9,top:24,left:24,width:40,height:40}}}),I=e.jsx(O,{sx:b||P?{position:"absolute",top:80,left:25}:{pl:3,pt:4},children:e.jsxs($,{children:[e.jsx(k,{variant:"caption",component:"div",sx:{mb:2,color:"text.disabled",...(b||P)&&{opacity:.48,color:"common.white"}},children:Bs(g.createdAt)}),e.jsxs($,{direction:"row",spacing:2,children:[e.jsx(k,{color:"inherit",variant:"subtitle2",sx:{height:44,overflow:"hidden",WebkitLineClamp:2,display:"-webkit-box",WebkitBoxOrient:"vertical",...b&&{typography:"h5",height:60},...(b||P)&&{color:"common.white"}},children:g.title}),e.jsx(w,{icon:"mdi:text-box",onClick:()=>h(!c),sx:{cursor:"pointer",...(b||P)&&{color:"white"}}})]}),e.jsx(k,{variant:"caption",color:"inherit",sx:{...(b||P)&&{color:"common.white"}},children:e.jsx(ht,{value:`${g.content.substring(0,150)} ${g.content.length>150?"...":""}`})})]})}),N=e.jsx(O,{component:"img",alt:g.title,src:g.cover,sx:{top:0,width:1,height:1,objectFit:"cover",position:"absolute"}}),G=e.jsx(et,{color:"paper",src:"/assets/icons/shape-avatar.svg",sx:{width:80,height:36,zIndex:9,bottom:-15,position:"absolute",color:"background.paper",...(b||P)&&{display:"none"}}});return e.jsxs(Y,{size:c?{xs:12,sm:12,md:12}:{xs:12,sm:b?12:6,md:b?6:3},children:[e.jsxs(ie,{children:[e.jsxs(O,{sx:{position:"relative",pt:"calc(100% * 3 / 4)",...(b||P)&&{pt:"calc(100% * 4 / 3)","&:after":{top:0,content:"''",width:"100%",height:"100%",position:"absolute",bgcolor:U=>T(U.palette.grey[900],.72)}},...b&&{pt:{xs:"calc(100% * 4 / 3)",sm:"calc(100% * 3 / 4.66)"}}},children:[v!==null&&v.roleid<3&&e.jsx(H,{onClick:S,sx:{zIndex:9,position:"absolute",top:24,right:20,width:40,height:40},children:e.jsx(w,{icon:"eva:more-vertical-fill",color:"white"})}),G,C,N]}),I]}),c&&e.jsx(O,{sx:{m:3,display:"flex",width:1,overflowX:"auto",overflowY:"auto"},children:e.jsx(ht,{value:g.content})}),v!==null&&v.roleid<3&&e.jsxs(be,{open:!!r,anchorEl:r,onClose:y,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{width:200}}},children:[e.jsxs(M,{onClick:x,children:[e.jsx(w,{icon:"eva:edit-fill",sx:{mr:2}}),j("Edit")]}),!u&&e.jsxs(M,{onClick:p,sx:{color:"error.main"},children:[e.jsx(w,{icon:"eva:trash-2-outline",sx:{mr:2}}),j("Delete")]}),u&&e.jsxs(M,{onClick:s,sx:{color:"error.main"},children:[e.jsx(w,{icon:"eva:question-mark-circle-outline",sx:{mr:2}}),j("_reallydelete_")]})]}),e.jsx(Zt,{title:j("_editpost_"),openUpdate:d,type:"update",updatepost:g,onCloseUpdate:R,handleUpdatePost:F})]})}ot.propTypes={blogpost:i.object.isRequired,index:i.number.isRequired,handleDeletePost:i.func};function Qt({openCreate:t,onOpenCreate:n,onCloseCreate:s,handleBlogpostsReceived:r}){const{t:o}=A();return e.jsxs(e.Fragment,{children:[e.jsx(X,{variant:"contained",color:"inherit",startIcon:e.jsx(w,{icon:"eva:plus-fill"}),onClick:n,children:o("_newpost_")}),e.jsxs(pe,{anchor:"right",open:t,onClose:s,PaperProps:{sx:{width:1,border:"none",overflow:"auto"}},children:[e.jsxs($,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{px:1,py:2},children:[e.jsx(k,{variant:"h6",sx:{ml:1},children:o("_newpost_")}),e.jsx(H,{onClick:s,children:e.jsx(w,{icon:"eva:close-fill"})})]}),e.jsx(ne,{}),e.jsx(rt,{type:"create",handleBlogpostsReceived:r})]})]})}Qt.propTypes={openCreate:i.bool.isRequired,onOpenCreate:i.func.isRequired,onCloseCreate:i.func.isRequired,handleBlogpostsReceived:i.func.isRequired};function br(){const[t,n]=a.useState([]),{request:s,user:r}=V(),o=a.useRef(!1),[d,l]=a.useState(!1),c=a.useCallback(g=>{o.current=!0;const _=g.data.blogposts.map((j,v)=>({id:j.blogpostid,cover:`/assets/images/covers/cover_${v+1}.jpg`,title:j.title,content:j.content,createdAt:j.createdAt,public:j.public,author:{name:j.alias,avatarUrl:`/assets/images/avatars/avatar_${se(j.userid,25)}.jpg`}}));n(_)},[n]);a.useEffect(()=>{o.current||s({event:"blogposts get all",data:{name:"BlowView",message:"BlowView  needs the list of blogposts"}},c)},[c,s]);const h=()=>{l(!0)},u=()=>{l(!1)},m=g=>{s({event:"blogpost delete",data:{source:"Blog View",message:"Blog View wants to delete a post",ids:[g]}},c)};return e.jsxs(he,{children:[e.jsxs($,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsx(k,{variant:"h4",children:"Blog"}),r.roleid<3&&e.jsx(Qt,{openCreate:d,onOpenCreate:h,onCloseCreate:u,handleBlogpostsReceived:c})]}),e.jsx(Y,{container:!0,spacing:3,children:t.map((g,_)=>e.jsx(ot,{blogpost:g,index:_,handleDeletePost:j=>m(g.id)},f()))})]})}function yr(){const{user:t}=V();return e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("title",{children:" Blog"})}),t?e.jsx(br,{}):null]})}const jr=Object.freeze(Object.defineProperty({__proto__:null,default:yr},Symbol.toStringTag,{value:"Module"}));function en({openCreate:t,onOpenCreate:n,onCloseCreate:s,handleUsersReceived:r}){const{t:o}=A();return e.jsxs(e.Fragment,{children:[e.jsx(X,{variant:"contained",color:"inherit",startIcon:e.jsx(w,{icon:"eva:plus-fill"}),onClick:n,children:o("_newuser_")}),e.jsxs(pe,{anchor:"right",open:t,onClose:s,PaperProps:{sx:{width:300,border:"none",overflow:"hidden"}},children:[e.jsxs($,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{px:1,py:2},children:[e.jsx(k,{variant:"h6",sx:{ml:1},children:o("_newuser_")}),e.jsx(H,{onClick:s,children:e.jsx(w,{icon:"eva:close-fill"})})]}),e.jsx(ne,{}),e.jsx(Le,{type:"create",handleUsersReceived:r})]})]})}en.propTypes={openCreate:i.bool.isRequired,onOpenCreate:i.func.isRequired,onCloseCreate:i.func.isRequired,handleUsersReceived:i.func.isRequired};function tn({query:t}){const{t:n}=A();return e.jsx(De,{children:e.jsx(K,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(Gn,{sx:{textAlign:"center"},children:[e.jsx(k,{variant:"h6",paragraph:!0,children:n("_notfound_")}),e.jsxs(k,{variant:"body2",children:[n("_noresultsfor_")," ",e.jsxs("strong",{children:['"',t,'"']}),"."]})]})})})}tn.propTypes={query:i.string};function nn({id:t,selected:n,alias:s,avatarUrl:r,firstname:o,lastname:d,roleid:l,role:c,email:h,home:u,handleClick:m,handleDeleteUser:g,handleUpdateUser:_}){const[j,v]=a.useState(null),[b,P]=a.useState(!1),{t:F}=A(),[S,y]=a.useState({open:!1,type:""}),R=N=>{p(),y({open:!0,type:N})},x=N=>{v(N.currentTarget),P(!1)},p=()=>{v(null)},C=()=>{y({open:!1,type:""})},I=()=>{P(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs(De,{hover:!0,tabIndex:-1,role:"checkbox",selected:n,children:[e.jsx(K,{padding:"checkbox",children:t!==1&&e.jsx(Fe,{disableRipple:!0,checked:n,onChange:m})}),e.jsx(K,{component:"th",scope:"row",padding:"none",children:e.jsxs($,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(de,{alt:s,src:r}),e.jsx(k,{variant:"subtitle2",noWrap:!0,children:s})]})}),e.jsx(K,{children:o}),e.jsx(K,{children:d}),e.jsx(K,{children:c}),e.jsx(K,{children:h}),e.jsx(K,{children:u}),e.jsx(K,{align:"right",children:e.jsx(H,{onClick:x,children:e.jsx(w,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(be,{open:!!j,anchorEl:j,onClose:p,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{width:200}}},children:[e.jsxs(M,{onClick:()=>R("profile"),children:[e.jsx(w,{icon:"eva:edit-fill",sx:{mr:2}}),F("Edit")]}),!b&&t!==1&&e.jsxs(M,{onClick:I,sx:{color:"error.main"},children:[e.jsx(w,{icon:"eva:trash-2-outline",sx:{mr:2}}),F("Delete")]}),b&&e.jsxs(M,{onClick:g,sx:{color:"error.main"},children:[e.jsx(w,{icon:"eva:question-mark-circle-outline",sx:{mr:2}}),F("_reallydelete_")]})]}),e.jsx(tt,{title:F("_edituserprofile_"),openUpdate:S.open,type:S.type,updateuser:{alias:s,email:h,firstname:o,lastname:d,home:u,id:t,roleid:l,role:c},onCloseUpdate:C,handleUpdateUser:_})]})}nn.propTypes={id:i.number,avatarUrl:i.any,firstname:i.any,lastname:i.any,handleClick:i.func,handleDeleteUser:i.func,handleUpdateUser:i.func,email:i.any,home:i.any,alias:i.any,role:i.any,roleid:i.any,selected:i.any};const _r={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function vr(t,n,s){return t?Math.max(0,(1+t)*n-s):0}function vt(t,n,s){return t[s]===null?1:n[s]===null||n[s]<t[s]?-1:n[s]>t[s]?1:0}function wr(t,n){return t==="desc"?(s,r)=>vt(s,r,n):(s,r)=>-vt(s,r,n)}function Cr({inputData:t,comparator:n,filterName:s,field:r}){const o=t.map((d,l)=>[d,l]);return o.sort((d,l)=>{const c=n(d[0],l[0]);return c!==0?c:d[1]-l[1]}),t=o.map(d=>d[0]),s&&(t=t.filter(d=>d[r].toLowerCase().indexOf(s.toLowerCase())!==-1)),t}function sn({order:t,orderBy:n,rowCount:s,headLabel:r,numSelected:o,onRequestSort:d,onSelectAllClick:l}){const c=h=>u=>{d(u,h)};return e.jsx(Jn,{children:e.jsxs(De,{children:[e.jsx(K,{padding:"checkbox",children:e.jsx(Fe,{indeterminate:o>0&&o<s,checked:s>0&&o===s,onChange:l})}),r.map(h=>e.jsx(K,{align:h.align||"left",sortDirection:n===h.id?t:!1,sx:{width:h.width,minWidth:h.minWidth},children:e.jsxs(Kn,{hideSortIcon:!0,active:n===h.id,direction:n===h.id?t:"asc",onClick:c(h.id),children:[h.label,n===h.id?e.jsx(O,{sx:{..._r},children:t==="desc"?"sorted descending":"sorted ascending"}):null]})},h.id))]})})}sn.propTypes={order:i.oneOf(["asc","desc"]),orderBy:i.string,rowCount:i.number,headLabel:i.array,numSelected:i.number,onRequestSort:i.func,onSelectAllClick:i.func};function rn({emptyRows:t,height:n}){return t?e.jsx(De,{sx:{...n&&{height:n*t}},children:e.jsx(K,{colSpan:9})}):null}rn.propTypes={emptyRows:i.number,height:i.number};function on({selected:t,filterName:n,onFilterName:s,placeholder:r,handleDeleteSelected:o,showReallyDelete:d,handleShowReallyDelete:l}){const{t:c}=A();return e.jsxs(St,{sx:{height:96,display:"flex",justifyContent:"space-between",p:h=>h.spacing(0,1,0,3),...t.length>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[t.length>0?e.jsxs(k,{component:"div",variant:"subtitle1",children:[t.length," ",c("selected")]}):e.jsx(Yn,{value:n,onChange:s,placeholder:r,startAdornment:e.jsx(ze,{position:"start",children:e.jsx(w,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),t.length>0&&!d&&e.jsx(Ye,{title:c("Delete"),children:e.jsx(H,{onClick:()=>l(!0),children:e.jsx(w,{icon:"eva:trash-2-fill"})})}),t.length>0&&d&&e.jsx(X,{color:"error",variant:"contained",startIcon:e.jsx(w,{icon:"eva:question-mark-circle-outline"}),onClick:()=>{o(),l(!1)},children:e.jsx(k,{variant:"subtitle1",children:c("_reallydelete_")})})]})}on.propTypes={selected:i.array,filterName:i.string,onFilterName:i.func,placeholder:i.string,handleDeleteSelected:i.func,showReallyDelete:i.bool,handleShowReallyDelete:i.func};function Sr(){const[t,n]=a.useState(0),[s,r]=a.useState([]),[o,d]=a.useState("asc"),[l,c]=a.useState([]),[h,u]=a.useState("name"),[m,g]=a.useState(""),[_,j]=a.useState(5),{t:v}=A(),{request:b}=V(),[P,F]=a.useState(!1),S=a.useRef(!1),[y,R]=a.useState(!1),x=E=>{const q=E.data.users.map((z,Xr)=>({id:z.userid,avatarUrl:`/assets/images/avatars/avatar_${se(z.userid,25)}.jpg`,alias:z.alias,firstname:z.firstname,lastname:z.lastname,role:z.rolename,email:z.email,home:z.home,roleid:z.roleid}));S.current=!0,r(q)},p=a.useCallback(E=>{const D=[...s],q=D.findIndex(z=>z.id===E.id);D[q]=E,D[q].avatarUrl=`/assets/images/avatars/avatar_${se(E.id,25)}.jpg`,r(D)},[s]),C=a.useCallback(E=>{E!==null&&p(E.detail)},[p]);a.useEffect(()=>{$t("userUpdated",C),S.current||b({event:"users get all",data:{name:"Users View",message:"User View needs the list of users"}},x)},[b,C]);const I=()=>{F(!0)},N=()=>{F(!1)},G=E=>{R(E)},U=(E,D)=>{D!==""&&(d(h===D&&o==="asc"?"desc":"asc"),u(D))},Q=E=>{if(E.target.checked){const D=s.filter(q=>q.id!==1).map(q=>q.alias);c(D);return}c([]),R(!1)},Ue=(E,D)=>{const q=l.indexOf(D);let z=[];q===-1?z=z.concat(l,D):q===0?z=z.concat(l.slice(1)):q===l.length-1?z=z.concat(l.slice(0,-1)):q>0&&(z=z.concat(l.slice(0,q),l.slice(q+1))),c(z),R(!1)},je=E=>{b({event:"user delete",source:{name:"Users View",message:"User View wants to delete a user",ids:[E]}},x)},W=()=>{const E=s.filter(D=>l.includes(D.alias)&&D.id!==1).map(D=>D.id);c([]),b({event:"user delete",data:{source:"Users View",message:"User View wants to delete users",ids:E}},x)},L=(E,D)=>{n(D)},ee=E=>{n(0),j(parseInt(E.target.value,10))},Z=E=>{n(0),g(E.target.value)},_e=Cr({inputData:s,comparator:wr(o,h),filterName:m,field:"alias"}),$n=!_e.length&&!!m;return e.jsxs(he,{children:[e.jsxs($,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsx(k,{variant:"h4",children:v("Users")}),e.jsx(en,{openCreate:P,onOpenCreate:I,onCloseCreate:N,handleUsersReceived:x})]}),e.jsxs(ie,{children:[e.jsx(on,{selected:l,filterName:m,onFilterName:Z,placeholder:v("_searchuser_"),handleDeleteSelected:W,showReallyDelete:y,handleShowReallyDelete:G}),e.jsx(Ae,{children:e.jsx(Xn,{sx:{overflow:"unset"},children:e.jsxs(Zn,{sx:{minWidth:800},children:[e.jsx(sn,{order:o,orderBy:h,rowCount:s.length,numSelected:l.length,onRequestSort:U,onSelectAllClick:Q,headLabel:[{id:"alias",label:v("Alias")},{id:"firstname",label:v("Firstname")},{id:"lastname",label:v("Lastname")},{id:"role",label:v("Role")},{id:"email",label:v("Email")},{id:"home",label:v("Home")},{id:""}]}),e.jsxs(Qn,{children:[_e.slice(t*_,t*_+_).map(E=>e.jsx(nn,{id:E.id,alias:E.alias,firstname:E.firstname,lastname:E.lastname,role:E.role,email:E.email,home:E.home,roleid:E.roleid,avatarUrl:E.avatarUrl,selected:l.indexOf(E.alias)!==-1,handleClick:D=>Ue(D,E.alias),handleDeleteUser:D=>je(E.id),handleUpdateUser:p},E.id)),e.jsx(rn,{height:77,emptyRows:vr(t,_,s.length)}),$n&&e.jsx(tn,{query:m})]})]})})}),e.jsx(es,{page:t,component:"div",count:s.length,rowsPerPage:_,onPageChange:L,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:ee,labelRowsPerPage:v("_rowsperpage_"),labelDisplayedRows:({from:E,to:D,count:q})=>`${E}${D} ${v("of")} ${q!==-1?q:`${v("_morethan_")} ${D}`}`})]})]})}function kr(){const{user:t}=V();return e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("title",{children:" User"})}),t?e.jsx(Sr,{}):null]})}const $r=Object.freeze(Object.defineProperty({__proto__:null,default:kr},Symbol.toStringTag,{value:"Module"}));function Pr(){const t=["Plus1PM","Plus1PMMini","PlusI4","PlusRGBWPM","SHBDUO-1","SHPLG-S"],[n,s]=a.useState(0),r=(o,d)=>{s(o)};return e.jsx("div",{children:e.jsx(fs,{index:n,onChange:r,interval:4e3,animation:"fade",indicators:!0,stopAutoPlayOnHover:!0,children:t.map((o,d)=>e.jsx(O,{component:"img",src:`/assets/images/devices/${o}.png`,sx:{width:200,hight:200,objectFit:"scale-down"}},f()))})})}function Fr(){const t=ue();return e.jsx(O,{display:"flex",justifyContent:"center",alignItems:"center",sx:{...Us({color:T(t.palette.background.default,.9),imgUrl:"/assets/background/overlay_4.jpg"}),height:1},children:e.jsx(ie,{sx:{p:5,width:1,maxWidth:420},children:e.jsxs($,{sx:{alignItems:"center",justifyContent:"center",height:1},children:[e.jsx(ye,{sx:{mt:3}}),e.jsx(Pr,{}),e.jsx(Le,{type:"login"})]})})})}function Rr(){return e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("title",{children:" Login"})}),e.jsx(Fr,{})]})}const Tr=Object.freeze(Object.defineProperty({__proto__:null,default:Rr},Symbol.toStringTag,{value:"Module"}));function Or(){const[t,n]=a.useState([]),{request:s}=V(),r=a.useRef(!1),o=Oe(),d=a.useCallback(c=>{if(r.current=!0,c.data.blogposts.length>0){const h=c.data.blogposts.map((u,m)=>({id:u.blogpostid,cover:`/assets/images/covers/cover_${m+1}.jpg`,title:u.title,content:u.content,createdAt:u.createdAt,view:23,comment:45,share:45,favorite:5,author:{name:u.alias,avatarUrl:`/assets/images/avatars/avatar_${se(u.userid,25)}.jpg`}}));n(h)}else o("/login")},[n,o]);a.useEffect(()=>{r.current||s({event:"blogposts get public",data:{name:"LandingView",message:"LandingView  needs the list of public blogposts"}},d)},[d,s]);const l=()=>{o("/login")};return e.jsxs(he,{children:[e.jsx(O,{sx:{flexGrow:1},children:e.jsxs($,{direction:"row",spacing:10,sx:{justifyContent:"space-between"},children:[e.jsx(ye,{sx:{mt:3}}),e.jsx($,{direction:"row",sx:{alignItems:"center"},children:e.jsxs(H,{onClick:l,sx:{pt:3},"aria-label":"Login",children:[e.jsx(w,{icon:"eva:lock-fill"}),e.jsx(k,{variant:"h6",children:"Login"})]})})]})}),e.jsx(Y,{container:!0,spacing:3,sx:{pt:5},children:t.map((c,h)=>e.jsx(ot,{blogpost:c,index:h},f()))})]})}function Er(){return e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("title",{children:" Shelly Central"})}),e.jsx(Or,{})]})}const Dr=Object.freeze(Object.defineProperty({__proto__:null,default:Er},Symbol.toStringTag,{value:"Module"}));function Ir(t,n){return t.sort((s,r)=>s[n]-r[n])}function Ar(t,n){return t.sort((s,r)=>s[n].localeCompare(r[n]))}const an=({online:t})=>e.jsx(w,{icon:t?"material-symbols:wifi":"material-symbols:wifi-off",sx:{color:t?"green":"red"}});an.propTypes={online:i.bool.isRequired};function ln({ip:t,switches:n,handleClick:s}){return typeof n>"u"?null:n.map((r,o)=>(r.ip=t,r.index=o,e.jsx(Ye,{title:`Switch ${r.id}`,children:e.jsx(w,{icon:"icomoon-free:switch",sx:{cursor:"pointer",color:r.output?"green":"black"},onClick:()=>s(r)},f())},f())))}ln.propTypes={ip:i.string.isRequired,switches:i.array,handleClick:i.func.isRequired};const cn=({device:t,handleSwitchToggle:n})=>{const[s,r]=a.useState(t.switches),o=d=>{d.output=!d.output,t.switches[d.index]=d,r([...t.switches]),n(d)};return e.jsxs(e.Fragment,{children:[e.jsxs($,{direction:"row",sx:{minHeight:35,maxHeight:35,pr:1,pl:1,alignItems:"center",justifyContent:"space-between"},children:[e.jsx(an,{online:t.online}),e.jsx(ln,{ip:t.ip,switches:s,handleClick:o})]}),e.jsx(Xe,{title:e.jsx(Ke,{href:`http://${t.ip}`,target:"_blank",color:"inherit",underline:"hover",children:t.cname}),subheader:`${t.name} ${t.gen>0?`(Gen ${t.gen})`:""}`,sx:{minWidth:200,minHeight:50,maxHeight:50,pt:1}}),e.jsx(ts,{sx:{minWidth:160,maxWidth:160,minHeight:120,objectFit:"scale-down"},image:t.image,title:t.name,component:"img",alt:t.name})]})},Lr=a.memo(cn);cn.propTypes={device:i.object.isRequired,handleSwitchToggle:i.func.isRequired};const dn=({scripts:t})=>typeof t>"u"?null:t.map(n=>{var s;return((s=n==null?void 0:n.logmessages)==null?void 0:s.length)>0?e.jsxs($,{spacing:0,children:[e.jsx(k,{variant:"subtitle2",children:n.name},f()),n.logmessages.map(r=>{const o=new Date(r.ts*1e3).toTimeString().substring(0,8);return e.jsxs($,{direction:"row",spacing:1,sx:{minWidth:0},children:[e.jsx(k,{variant:"caption",children:o},f()),e.jsx(k,{variant:"caption",noWrap:!0,children:r.msg},f())]},f())})]},f()):null}),Ur=a.memo(dn);dn.propTypes={scripts:i.array.isRequired};const Br=a.forwardRef(({colors:t,selected:n,onSelectColor:s,limit:r="auto",sx:o,...d},l)=>{const c=typeof n=="string",h=a.useCallback(u=>{if(c)u!==n&&s(u);else{const m=n.includes(u)?n.filter(g=>g!==u):[...n,u];s(m)}},[s,n,c]);return e.jsx($,{ref:l,direction:"row",display:"inline-flex",sx:{flexWrap:"wrap",...r!=="auto"&&{width:r*36,justifyContent:"flex-end"},...o},...d,children:t.map(u=>{const m=c?n===u:n.includes(u);return e.jsx(ns,{sx:{width:36,height:36,borderRadius:"50%"},onClick:()=>{h(u)},children:e.jsx($,{alignItems:"center",justifyContent:"center",sx:{width:20,height:20,bgcolor:u,borderRadius:"50%",border:g=>`solid 1px ${T(g.palette.grey[500],.16)}`,...m&&{transform:"scale(1.3)",boxShadow:`4px 4px 8px 0 ${T(u,.48)}`,outline:`solid 2px ${T(u,.08)}`,transition:g=>g.transitions.create("all",{duration:g.transitions.duration.shortest})}},children:e.jsx(w,{width:m?12:0,icon:"eva:checkmark-fill",sx:{color:g=>g.palette.getContrastText(u),transition:g=>g.transitions.create("all",{duration:g.transitions.duration.shortest})}})})},u)})})});Br.propTypes={colors:i.oneOfType([i.string,i.arrayOf(i.string)]),limit:i.number,onSelectColor:i.func,selected:i.oneOfType([i.string,i.arrayOf(i.string)]),sx:i.object};function it({colors:t,limit:n=3,sx:s}){const r=t.slice(0,n),o=t.length-n;return e.jsxs($,{component:"span",direction:"row",alignItems:"center",justifyContent:"flex-end",sx:s,children:[r.map((d,l)=>e.jsx(O,{sx:{ml:-.75,width:16,height:16,bgcolor:d,borderRadius:"50%",border:c=>`solid 2px ${c.palette.background.paper}`,boxShadow:c=>`inset -1px 1px 2px ${T(c.palette.common.black,.24)}`}},d+l)),t.length>n&&e.jsx(O,{component:"span",sx:{typography:"subtitle2"},children:`+${o}`})]})}it.propTypes={colors:i.arrayOf(i.string),limit:i.number,sx:i.object};const wt=["#00AB55","#D22B2B","#000000"];function un({kvs:t}){return t.map((n,s)=>{const r=typeof n.display<"u"?n.display:n.key,o=d=>{switch(typeof n.style<"u"?n.style:n.value){case"boolean":return Number(n.value)===1?"true":"false";case"color":return e.jsx(it,{colors:Number(n.value)===1?wt.slice(0,1):wt.slice(1,2),sx:{pt:"5px"}},f());default:return n.value}};return e.jsx(a.Fragment,{children:e.jsxs($,{direction:"row",justifyContent:"space-between",style:{gap:20},useFlexGap:!0,flexWrap:"wrap",children:[e.jsx(k,{variant:"caption",sx:{minWidth:100},children:r},f()),e.jsx(k,{variant:"caption",children:o()},f())]},f())},f())})}un.propTypes={kvs:i.array.isRequired};const pn=({device:t,handleSwitchSet:n})=>{const[s,r]=a.useState(t.switches),{t:o}=A(),d=s.find(S=>typeof S.brightness<"u"),l=s.find(S=>typeof S.white<"u"),c=s.find(S=>typeof S.rgb<"u"),[h,u]=a.useState(typeof c<"u"?`rgb (${c.rgb[0]}, ${c.rgb[1]}, ${c.rgb[2]})`:"rgb (255, 0, 0)"),[m,g]=a.useState(typeof d<"u"?d.brightness:0),[_,j]=a.useState(typeof l<"u"?l.white:0),v=a.useMemo(()=>hs(n,30,{leading:!1,trailing:!0}),[n]),b=(S,y)=>{u(S),c.ip=t.ip,c.rgb=y.rgb,v(c)},P=(S,y)=>{g(y),d.ip=t.ip,d.brightness=y,v(d)},F=(S,y)=>{j(y),l.ip=t.ip,l.white=y,v(l)};return a.useEffect(()=>{r(t.switches)},[t,r]),e.jsxs($,{alignItems:"flex-start",children:[typeof d<"u"&&e.jsxs(e.Fragment,{children:[e.jsx(k,{variant:"subtitle",children:o("Brightness")}),e.jsx(dt,{value:m,min:0,max:100,step:10,marks:!0,valueLabelDisplay:"auto",size:"small",onChange:P,"aria-label":"Brighness slider"})]}),typeof l<"u"&&e.jsxs(e.Fragment,{children:[e.jsx(k,{variant:"subtitle",children:o("White")}),e.jsx(dt,{value:_,min:0,max:t.gen===1?100:255,step:t.gen===1?10:25,marks:!0,valueLabelDisplay:"auto",size:"small",onChange:F,"aria-label":"White slider"})]}),typeof c<"u"&&e.jsx(_s,{format:"rgb",isAlphaHidden:!0,value:h,onChange:b,size:"small",variant:"outlined","aria-label":"Color Selection",sx:{pt:1}})]})};pn.propTypes={device:i.object,handleSwitchSet:i.func};const He=({white:t})=>e.jsxs($,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:.5,children:[e.jsx(w,{icon:"stash:circle-dot"},f()),e.jsx(k,{variant:"caption",children:t},f())]},f());He.propTypes={white:i.number};const hn=({data:t})=>{if(typeof t.motion<"u")return e.jsx(w,{icon:Number(t.motion)===1?"material-symbols:directions-walk":"fa6-solid:person",sx:{color:Number(t.motion)===1?"blue":"black"}},f());if(typeof t.window<"u")return Number(t.window)===1?e.jsx(w,{icon:"material-symbols:door-open-rounded",sx:{color:"black"}},f()):e.jsx(w,{icon:"material-symbols:door-front-rounded",sx:{color:"black"}},f());if(typeof t.button<"u")switch(Number(t.button)){case 1:return e.jsx(w,{icon:"mdi:number-1-box",sx:{color:"blue"}},f());case 2:return e.jsx(w,{icon:"mdi:number-2-box",sx:{color:"blue"}},f());case 3:return e.jsx(w,{icon:"mdi:number-3-box",sx:{color:"blue"}},f());case 4:return e.jsx(w,{icon:"mdi:number-4-box",sx:{color:"blue"}},f());case 254:return e.jsx(w,{icon:"f7:hand-point-left-fill",sx:{color:"blue"}},f());default:return e.jsx(w,{icon:"f7:hand-point-left-fill",sx:{color:"blue"}},f())}return e.jsx(w,{icon:"material-symbols:event-busy",sx:{color:"black"}},f())};hn.propTypes={data:i.object.isRequired};const xn=({event:t})=>{let n;switch(Number(t.id)){case 0:n=180;break;case 1:n=270;break;case 2:n=90;break;default:n=0}return e.jsxs($,{direction:"row",children:[e.jsx(w,{icon:"system-uicons:grid-squares-add",sx:{color:"black"},className:`rotate${n}`},f()),t.event==="single_push"&&e.jsx(w,{icon:"mdi:number-1-box",sx:{color:"blue"}},f()),t.event==="double_push"&&e.jsx(w,{icon:"mdi:number-2-box",sx:{color:"blue"}},f()),t.event==="triple_push"&&e.jsx(w,{icon:"mdi:number-3-box",sx:{color:"blue"}},f()),(t.event==="long_push"||t.event==="btn_up")&&e.jsx(w,{icon:"f7:hand-point-left-fill",sx:{color:"blue"}},f())]},f())};xn.propTypes={event:i.object.isRequired};const gn=({events:t})=>{const n=t.map(s=>s.event==="shelly-blu"&&typeof s.data<"u"?e.jsx(hn,{data:s.data},f()):["single_push","double_push","triple_push","long_push"].includes(s.event)?e.jsx(xn,{event:s},f()):s.event==="btn_up"||s.event==="btn_down"?null:s.event==="scheduled_restart"?e.jsx(w,{icon:"solar:restart-square-bold",sx:{color:"black"}},f()):e.jsx(w,{icon:"ic:sharp-help",sx:{color:"black"}},f()));return n.length>0?n:e.jsx(w,{icon:"mdi:bug",sx:{color:"red"}},f())};gn.propTypes={events:i.array.isRequired};const Ve=({consume:t})=>e.jsxs($,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:.5,children:[e.jsx(w,{icon:"material-symbols-light:bolt",sx:{color:+(t>0)?"blue":"black"}},f()),e.jsx(k,{variant:"caption",children:me(t)},f())]},f());Ve.propTypes={consume:i.number.isRequired};const fn=({params:t})=>{const n=[];return Object.keys(t).forEach(r=>{if(r.startsWith("script")){const o=t[r];n.push(e.jsxs($,{justifyContent:"flex-start",alignItems:"center",spacing:.5,direction:"row",children:[e.jsxs(k,{variant:"subtitle2",color:o.running?"green":"red",children:["{",o.id,"}"]},f()),e.jsxs(k,{variant:"caption",children:[Math.round(Number(o.mem_free)/1024)," kb free"]},f())]},f()))}}),n};fn.propTypes={params:i.object.isRequired};const mn=({version:t})=>e.jsxs($,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:.5,children:[e.jsx(w,{icon:"material-symbols:system-update-alt",sx:{color:"green"}},f()),e.jsx(k,{variant:"caption",children:t},f())]},f());mn.propTypes={version:i.string.isRequired};const Ge=({brightness:t})=>e.jsxs($,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:.5,children:[e.jsx(w,{icon:"subway:black-white",width:18,height:18},f()),e.jsxs(k,{variant:"caption",children:[t,"%"]},f())]},f());Ge.propTypes={brightness:i.number};const bn=({sys:t})=>e.jsxs($,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:.5,children:[e.jsx(w,{icon:"material-symbols-light:sd",sx:{color:"black"}},f()),e.jsxs(k,{variant:"caption",children:[Math.round(Number(t.ram_free)/1024)," kb free"]},f()),e.jsx(w,{icon:"material-symbols:storage-rounded",sx:{color:"black"}},f()),e.jsxs(k,{variant:"caption",children:[Math.round(Number(t.fs_free)/1024)," kb free"]},f())]},f());bn.propTypes={sys:i.object.isRequired};const yn=({deviceName:t,wsMessage:n})=>{var d,l,c,h,u,m,g,_,j;const{params:s}=n;if(typeof s>"u")return[];const r=[];let o;if(n.method!=="NotifyEvent"&&(o=Jt(t,s)),n.method==="NotifyFullStatus"){if(typeof(s==null?void 0:s.sys)<"u"&&r.push(e.jsx(bn,{sys:s.sys},f())),typeof((d=s==null?void 0:s.cloud)==null?void 0:d.connected)<"u"&&r.push(e.jsx(w,{icon:"material-symbols-light:cloud",sx:{color:s.cloud.connected?"green":"black"}},f())),typeof((h=(c=(l=s==null?void 0:s.sys)==null?void 0:l.available_updates)==null?void 0:c.stable)==null?void 0:h.version)<"u"&&r.push(e.jsx(mn,{version:s.sys.available_updates.stable.version},f())),r.push(e.jsx(fn,{params:n.params},f())),o.hasSwitch&&r.push(e.jsx(Ve,{consume:o.totalPower},f())),typeof((u=s["rgbw:0"])==null?void 0:u.brightness)<"u"&&r.push(e.jsx(Ge,{brightness:s["rgbw:0"].brightness},f())),typeof((m=s["switch:0"])==null?void 0:m.brightness)<"u"&&r.push(e.jsx(Ge,{brightness:s["switch:0"].brightness},f())),typeof((g=s["rgbw:0"])==null?void 0:g.white)<"u"&&r.push(e.jsx(He,{white:s["rgbw:0"].white},f())),typeof((_=s["switch:0"])==null?void 0:_.white)<"u"&&r.push(e.jsx(He,{white:s["switch:0"].white},f())),typeof((j=s["rgbw:0"])==null?void 0:j.rgb)<"u"){const{rgb:v}=s["rgbw:0"],b=`rgb(${v[0]}, ${v[1]}, ${v[2]})`;r.push(e.jsx(w,{icon:"material-symbols:light-mode",sx:{color:b}},f()))}}else n.method==="NotifyStatus"?o.hasSwitch&&r.push(e.jsx(Ve,{consume:o.totalPower},f())):n.method==="NotifyEvent"?typeof(s==null?void 0:s.events)<"u"&&r.push(e.jsx(gn,{events:s.events},f())):r.push(e.jsx(w,{icon:"ic:sharp-help",sx:{color:"black"}},f()));return r};yn.propTypes={deviceName:i.string.isRequired,wsMessage:i.object.isRequired};const jn=({ts:t})=>e.jsx(k,{variant:"subtitle2",children:It(t,"HH:mm")},f());jn.propTypes={ts:i.number.isRequired};const _n=({deviceName:t,wsmessages:n})=>typeof n>"u"?null:Object.keys(n).map(r=>{var d;const o=n[r];return e.jsxs(a.Fragment,{children:[e.jsxs($,{direction:"row",justifyContent:"left",alignItems:"center",spacing:2,children:[typeof((d=o==null?void 0:o.params)==null?void 0:d.ts)<"u"&&e.jsx(jn,{ts:o.params.ts},f()),e.jsx(k,{variant:"subtitle2",children:r},f()),e.jsx(yn,{deviceName:t,wsMessage:o},f())]},f()),e.jsx(k,{variant:"caption",children:JSON.stringify(o)},f())]},f())}),Nr=a.memo(_n);_n.propTypes={deviceName:i.string.isRequired,wsmessages:i.object.isRequired};const ce=["#00AB55","#D22B2B","#000000"],vn=({deviceIP:t,deviceOnline:n,scripts:s})=>{if(typeof s>"u"||s==null||typeof s[Symbol.iterator]!="function")s=[{name:"n/a",colors:ce.slice(-1)},{name:"n/a",colors:ce.slice(-1)},{name:"n/a",colors:ce.slice(-1)}];else{s=[...s];for(let r=0;r<=2;r+=1)typeof s[r]>"u"?s.push({name:"n/a",colors:ce.slice(-1)}):s[r].colors=s[r].running&&n?ce.slice(0,1):ce.slice(1,2)}return s.map((r,o)=>e.jsx(a.Fragment,{children:e.jsxs($,{direction:"row",style:{gap:20},useFlexGap:!0,flexWrap:"wrap",children:[e.jsx(Ke,{href:r.id!==0?`http://${t}/#/script/${r.id}`:`http://${t}/#/scripts`,target:"_blank",color:"inherit",underline:"hover",variant:"subtitle2",noWrap:!0,sx:{minWidth:100},children:e.jsx(k,{noWrap:!0,variant:"caption",children:r.name},f())}),e.jsx(it,{colors:r.colors,sx:{pt:"5px"}},f())]},f())},f()))};vn.propTypes={deviceIP:i.string.isRequired,deviceOnline:i.bool.isRequired,scripts:i.array.isRequired};function Wr(t,n){let s=!t.online;if(typeof t.scripts<"u"){let r;Object.values(t.scripts).forEach(o=>{r=n[`script:${o.id}`],o.running!==r.running&&(s=!0,o.running=r.running)})}if(typeof t.switches<"u"){let r;t.switches.forEach((o,d)=>{r=n[`switch:${o.id}`]||n[`rgbw:${o.id}`];const l=typeof o.ts>"u"||n.ts*1e3>o.ts;typeof r<"u"&&l&&(o.output!==r.output&&(s=!0,o.output=r.output,console.log(`Switch ${o.key} of device ${t.cname} output was set to ${o.output}`)),o.brightness!==r.brightness&&(s=!0,o.brightness=r.brightness,console.log(`Switch ${o.key} of device ${t.cname} brightness was set to ${o.brightness}`)),o.white!==r.white&&(s=!0,o.white=r.white,console.log(`Switch ${o.key} of device ${t.cname} white was set to ${o.white}`)),kt(o.rgb,r.rgb)||(s=!0,o.rgb=r.rgb,console.log(`Switch ${o.key} of device ${t.cname} rgb was set to ${o.rgb}`)))})}return s?{...t}:null}const zr=Ee(t=>{const{expand:n,...s}=t;return e.jsx(H,{...s})})(({theme:t,expand:n})=>({transform:n?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest})})),wn=({shelly:t,type:n})=>{var y,R;const[s,r]=a.useState(!1),[o,d]=a.useState(t),[l,c]=a.useState(t.scripts),[h,u]=a.useState(t.wsmessages),[m,g]=a.useState(t.kvs),{subscribe:_,unsubscribe:j,send:v}=V(),b=a.useCallback(x=>{var I,N;const p=x.type,C=x.data.device;switch(p){case"script":c(G=>C.scripts);break;case"kvs":g(G=>C.kvs);break;case"log":c(G=>C.scripts);break;case"ws":{const G=(N=(I=C==null?void 0:C.wsmessages)==null?void 0:I.NotifyFullStatus)==null?void 0:N.params;if(typeof G<"u"){const U=Wr(o,G);U!==null&&d(Q=>U)}u(U=>C.wsmessages);break}default:d(G=>C)}},[o]);a.useEffect(()=>{if(t.gen!==0)return _({subscriptionID:t.id,callback:b,all:!1},["ShellyUpdate"]),()=>{j(t.id,["ShellyUpdate"])}},[t,_,j,b]);const P=()=>{r(!s)},F=x=>{x.ts=Date.now(),v({event:"toggleSwitch",data:{name:"Shelly Device",message:`${t.cname} wants to toggle a switch`,switch:x}})},S=x=>{if(x.ts=Date.now(),typeof x.rgb<"u"&&!(x.rgb instanceof Array)){let p=x.rgb.substring(x.rgb.indexOf("(")+1,x.rgb.indexOf(")")).split(",");p=p.map(C=>Number(C)),x.rgb=p}v({event:"setSwitch",data:{name:"Shelly Device",message:`${t.cname} wants to toggle a switch`,switch:x}})};return e.jsx(ie,{raised:!0,children:e.jsxs($,{direction:n==="ctrl"?"column":"row",children:[e.jsxs($,{children:[e.jsx(Lr,{device:o,handleSwitchToggle:F}),n==="sk"&&e.jsxs(e.Fragment,{children:[e.jsx(Ce,{sx:{minWidth:200,pt:0},children:e.jsx($,{justifyContent:"left",alignItems:"flex-start",children:e.jsx(vn,{deviceIP:o.ip,deviceOnline:o.online,scripts:l})})}),e.jsxs(ss,{disableSpacing:!0,children:[e.jsx(H,{href:`http://${o.ip}/#/key-value-store`,target:"_blank","aria-label":"show KVS entries",children:e.jsx(w,{icon:"material-symbols:storage-rounded",sx:{color:((y=o==null?void 0:o.kvs)==null?void 0:y.length)===0?"grey":"green"}},f())}),e.jsx(zr,{disabled:((R=o==null?void 0:o.kvs)==null?void 0:R.length)===0,onClick:P,expand:s,"aria-expanded":s,"aria-label":"show KVS entries",children:e.jsx(w,{icon:"mdi:expand-more",sx:{color:"gray"}},f())})]}),e.jsx(rs,{in:s,timeout:"auto",mountOnEnter:!0,unmountOnExit:!0,children:e.jsx(Ce,{sx:{pt:0},children:e.jsx($,{justifyContent:"left",alignItems:"flex-start",children:e.jsx(un,{kvs:m})})})})]})]}),n==="ws"&&e.jsx(Ce,{sx:{display:"flex",width:1,overflowX:"auto",overflowY:"auto"},children:e.jsx($,{children:e.jsx(Nr,{deviceName:o.name,wsmessages:h})})}),n==="log"&&e.jsx(Ce,{sx:{display:"flex",width:1,overflowX:"auto",overflowY:"auto"},children:e.jsx($,{children:e.jsx(Ur,{scripts:l})})}),n==="ctrl"&&e.jsx(O,{bgcolor:"white",sx:{minWidth:220,maxWidth:220,maxHeight:180,minHeight:180,mb:2,pl:2,pr:2},children:e.jsx(pn,{device:o,handleSwitchSet:S})})]})})},Mr=a.memo(wn);wn.propTypes={shelly:i.object.isRequired,type:i.string.isRequired};const Cn=({index:t,devices:n})=>{const r=["sk","ctrl","log","ws"][t],o=12,d=r==="sk"||r==="ctrl"?4:12,l=r==="sk"||r==="ctrl"?2:12,c=r==="sk"||r==="ctrl"?2:12,h=r==="sk"||r==="ctrl"?2:12;return e.jsx(Y,{container:!0,spacing:2,size:{xs:{xs:o},sm:{sm:d},md:{md:l},lg:{lg:c},xl:{xl:h}},children:n.map(u=>{const m=u.switches.find(v=>typeof v.brightness<"u"),g=u.switches.find(v=>typeof v.white<"u"),_=u.switches.find(v=>typeof v.rgb<"u");return r==="sk"||r==="ws"&&u.gen>0||r==="log"&&u.gen>1||r==="ctrl"&&(m||g||_)?e.jsx(Y,{sx:{minWidth:r==="sk"||r==="ctrl"?0:1},children:e.jsx(Mr,{shelly:u,type:r},u.id)},f()):null})})},qr=a.memo(Cn);Cn.propTypes={index:i.number.isRequired,devices:i.array};const We=[{value:"config",label:"Config"},{value:"cname",label:"Name"},{value:"name",label:"Model"},{value:"gen",label:"Gen"}];function Sn({handleSort:t}){const[n,s]=a.useState(null),[r,o]=a.useState(0),{t:d}=A(),l=u=>{s(u.currentTarget)},c=()=>{s(null)},h=(u,m)=>{s(null),o(m),t(We[m])};return e.jsxs(e.Fragment,{children:[e.jsxs(X,{disableRipple:!0,color:"inherit",onClick:l,endIcon:e.jsx(w,{icon:n?"eva:chevron-up-fill":"eva:chevron-down-fill"}),children:[d("_sortby_"),":",e.jsx(k,{component:"span",variant:"subtitle2",sx:{color:"text.secondary"},children:d(We[r].label)})]}),e.jsx(os,{open:!!n,anchorEl:n,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{[`& .${is.root}`]:{p:0}}}},children:We.map((u,m)=>e.jsx(M,{onClick:g=>h(g,m),selected:m===r,children:d(u.label)},u.value))})]})}Sn.propTypes={handleSort:i.func.isRequired};function kn({openFilter:t,onOpenFilter:n,onCloseFilter:s,filter:r,handleDeviceFilter:o}){const[d,l]=a.useState([]),[c,h]=a.useState([]),{t:u}=A();if(a.useEffect(()=>{l(Array.from(r.mChecked)),h(Array.from(r.gChecked))},[r]),typeof r>"u")return null;const m=b=>{const P=d.map((F,S)=>S===b?!F:F);l(P)},g=b=>{const P=c.map((F,S)=>S===b?!F:F);h(P)},_=e.jsxs($,{spacing:1,children:[e.jsx(k,{variant:"subtitle2",children:u("Model")}),e.jsx(ut,{children:r.models.map((b,P)=>e.jsx(Me,{control:e.jsx(Fe,{checked:!!d[P],onChange:()=>m(P)}),label:b},b))})]}),j=e.jsxs($,{spacing:1,children:[e.jsx(k,{variant:"subtitle2",children:u("Generation")}),e.jsx(ut,{children:r.generations.map((b,P)=>e.jsx(Me,{value:b,control:e.jsx(Fe,{checked:!!c[P],onChange:()=>g(P)}),label:b!==""?`Gen ${b}`:"no Gen"},b))})]}),v=()=>{l(new Array(r.mChecked.length).fill(!1)),h(new Array(r.gChecked.length).fill(!1))};return e.jsxs(e.Fragment,{children:[e.jsxs(X,{disableRipple:!0,color:r.isFilter?"success":"inherit",endIcon:e.jsx(w,{icon:"ic:round-filter-list"}),onClick:n,children:[u("Filters"),""]}),e.jsxs(pe,{anchor:"right",open:t,onClose:s,PaperProps:{sx:{width:300,border:"none",overflow:"hidden"}},children:[e.jsxs($,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{px:1,py:2},children:[e.jsx(k,{variant:"h6",sx:{ml:1},children:u("Filters")}),e.jsx(H,{onClick:s,children:e.jsx(w,{icon:"eva:close-fill"})})]}),e.jsx(ne,{}),e.jsx(Ae,{children:e.jsxs($,{spacing:3,sx:{p:3},children:[_,j]})}),e.jsx(O,{sx:{p:3},children:e.jsxs($,{direction:"row",spacing:2,children:[e.jsx(X,{fullWidth:!0,size:"large",color:"inherit",variant:"outlined",startIcon:e.jsx(w,{icon:"formkit:submit"}),onClick:b=>o(d,c),children:u("Submit")}),e.jsx(X,{fullWidth:!0,size:"large",color:"inherit",variant:"outlined",startIcon:e.jsx(w,{icon:"ic:round-clear-all"}),onClick:b=>v(),children:u("Clear")})]})})]})]})}kn.propTypes={openFilter:i.bool.isRequired,onOpenFilter:i.func.isRequired,onCloseFilter:i.func.isRequired,filter:i.object,handleDeviceFilter:i.func.isRequired};function Hr(){const{request:t}=V(),[n,s]=a.useState(!1),[r,o]=a.useState(0),[d,l]=a.useState([]),[c,h]=a.useState({models:[],generations:[],mChecked:[],gChecked:[],isFilter:!1}),u=a.useRef([]),{t:m}=A();a.useEffect(()=>{d.length===0&&t({event:"devices get all",data:{name:"Shelly View",message:"Shelly View needs the list of devices"}},g)},[d,t]);const g=S=>{const y=S.data.devices,R=[],x=[];y.forEach(C=>{R.includes(C.name)||R.push(C.name),x.includes(C.gen)||x.push(C.gen)});const p={models:R,generations:x,mChecked:new Array(R.length).fill(!1),gChecked:new Array(x.length).fill(!1),isFilter:!1};h(()=>p),l(()=>y),u.current=y},_=(S,y)=>{o(y)},j=()=>{s(!0)},v=()=>{s(!1)},b=S=>{let y;switch(S.value){case"config":l(R=>u.current);break;case"gen":y=[...d],y=Ir(y,"gen"),l(()=>y);break;default:y=[...d],y=Ar(y,S.value),l(()=>y)}},P=S=>u.current.filter(R=>{for(const x in S)if(R[x]===void 0||!S[x].includes(R[x]))return!1;return!0}),F=(S,y)=>{let R=!1;const x={};c.models.forEach((p,C)=>{S[C]&&(R=!0,typeof x.name>"u"&&(x.name=[]),x.name.push(p))}),c.generations.forEach((p,C)=>{y[C]&&(R=!0,typeof x.gen>"u"&&(x.gen=[]),x.gen.push(p))}),l(R?()=>P(x):()=>u.current),h({models:c.models,generations:c.generations,mChecked:S,gChecked:y,isFilter:R}),s(!1)};return e.jsxs(he,{children:[e.jsx(st,{title:"Shellies"}),e.jsx($,{direction:"row",alignItems:"center",flexWrap:"wrap-reverse",justifyContent:"flex-end",sx:{mb:5},children:e.jsxs($,{direction:"row",spacing:1,flexShrink:0,sx:{my:1},children:[e.jsx(kn,{openFilter:n,onOpenFilter:j,onCloseFilter:v,filter:c,handleDeviceFilter:F}),e.jsx(Sn,{handleSort:b})]})}),e.jsx(O,{sx:{pb:2,borderBottom:1,borderColor:"divider"},children:e.jsxs(as,{value:r,onChange:_,variant:"scrollable",scrollButtons:"auto","aria-label":"shelly tabs",children:[e.jsx(Se,{label:"Script / KVS"}),e.jsx(Se,{label:m("Control")}),e.jsx(Se,{label:"Logs"}),e.jsx(Se,{label:"WS Inspector"})]})}),e.jsx(qr,{index:r,devices:d},"shelliesTab")]})}function Vr(){const{user:t}=V();return e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("title",{children:" Shellies"})}),t?e.jsx(Hr,{}):null]})}const Gr=Object.freeze(Object.defineProperty({__proto__:null,default:Vr},Symbol.toStringTag,{value:"Module"}));function Jr(){const t=e.jsx(O,{component:"header",sx:{top:0,left:0,width:1,lineHeight:0,position:"fixed",p:n=>({xs:n.spacing(3,3,0),sm:n.spacing(5,5,0)})},children:e.jsx(ye,{sx:{mt:3,ml:4}})});return e.jsxs(e.Fragment,{children:[t,e.jsx(he,{children:e.jsxs(O,{sx:{py:12,maxWidth:480,mx:"auto",display:"flex",minHeight:"100vh",textAlign:"center",alignItems:"center",flexDirection:"column",justifyContent:"center"},children:[e.jsx(k,{variant:"h3",sx:{mb:3},children:"Sorry, page not found!"}),e.jsx(k,{sx:{color:"text.secondary"},children:"Sorry, we couldn뗪 find the page youre looking for. Perhaps you뗬e mistyped the URL? Be sure to check your spelling."}),e.jsx(O,{component:"img",src:"/assets/illustrations/illustration_404.svg",sx:{mx:"auto",height:260,my:{xs:5,sm:10}}}),e.jsx(X,{href:"/",size:"large",variant:"contained",component:Qe,children:"Go to Home"})]})})]})}function Kr(){return e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("title",{children:" 404 Page Not Found "})}),e.jsx(Jr,{})]})}const Yr=Object.freeze(Object.defineProperty({__proto__:null,default:Kr},Symbol.toStringTag,{value:"Module"}));export{li as a,ai as c,ci as g};
