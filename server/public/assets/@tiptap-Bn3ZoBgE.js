import{E as bs,N as vt,T as Y,P as q,a as J,S as yt,A as vs}from"./prosemirror-state-BLwXW4Ka.js";import{t as vn}from"./tippy.js-T2NbCdtq.js";import{d as V,r as j}from"./react-BAvqZb1q.js";import{r as ws,a as Ms}from"./react-dom-Dt4_rkyf.js";import{r as Be,t as Es,f as wn,a as ks}from"./linkifyjs-DVrXeg1a.js";import{E as Ss,D as ye,a as be}from"./prosemirror-view-CBcoWX2f.js";import{c as xs,t as Ts,C as Mn,f as Cs,g as je,s as As,m as Fe,a as ze,b as Os,d as Ue,e as Ls,h as Ps,i as _s,j as Rs,k as Ns,l as Is,n as $s}from"./prosemirror-tables-Db2HToAo.js";import{d as Hs}from"./prosemirror-dropcursor-3jZb0A5n.js";import{g as Ds}from"./prosemirror-gapcursor-CsD_MK6O.js";import{h as Bs,r as js,u as Fs}from"./prosemirror-history-CP70DM9h.js";import{D as zs,S as En,F as ut,N as kn,a as re,b as Us}from"./prosemirror-model-CRZLy2j9.js";import{k as Ws}from"./prosemirror-keymap-CKVplV9_.js";import{T as Vs,f as Ks,c as ve,a as zt,j as Sn,l as qs,R as Gs,b as Qs}from"./prosemirror-transform-C09io-ca.js";import{w as Js,s as We,a as Xs,b as Ys,c as Zs,d as tr,e as er,n as nr,l as sr,f as rr,j as or,g as ir,h as ar,i as lr,k as cr,m as ur,o as dr,p as pr,q as hr}from"./prosemirror-commands-CQrOMeus.js";import{w as fr,s as mr,l as gr}from"./prosemirror-schema-list-cRCmABXK.js";function qt(t){const{state:e,transaction:n}=t;let{selection:s}=n,{doc:r}=n,{storedMarks:o}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return s},get doc(){return r},get tr(){return s=n.selection,r=n.doc,o=n.storedMarks,n}}}class Gt{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:s}=this,{view:r}=n,{tr:o}=s,i=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...d)=>{const u=l(...d)(i);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(o),u}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:s,editor:r,state:o}=this,{view:i}=r,a=[],l=!!e,c=e||o.tr,d=()=>(!l&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(c),a.every(p=>p===!0)),u={...Object.fromEntries(Object.entries(s).map(([p,h])=>[p,(...m)=>{const f=this.buildProps(c,n),g=h(...m)(f);return a.push(g),u}])),run:d};return u}createCan(e){const{rawCommands:n,state:s}=this,r=!1,o=e||s.tr,i=this.buildProps(o,r);return{...Object.fromEntries(Object.entries(n).map(([l,c])=>[l,(...d)=>c(...d)({...i,dispatch:void 0})])),chain:()=>this.createChain(o,r)}}buildProps(e,n=!0){const{rawCommands:s,editor:r,state:o}=this,{view:i}=r,a={tr:e,editor:r,view:i,state:qt({state:o,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(s).map(([l,c])=>[l,(...d)=>c(...d)(a)]))}};return a}}class yr{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const s=this.callbacks[e];return s&&s.forEach(r=>r.apply(this,n)),this}off(e,n){const s=this.callbacks[e];return s&&(n?this.callbacks[e]=s.filter(r=>r!==n):delete this.callbacks[e]),this}once(e,n){const s=(...r)=>{this.off(e,s),n.apply(this,r)};return this.on(e,s)}removeAllListeners(){this.callbacks={}}}function M(t,e,n){return t.config[e]===void 0&&t.parent?M(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?M(t.parent,e,n):null}):t.config[e]}function Qt(t){const e=t.filter(r=>r.type==="extension"),n=t.filter(r=>r.type==="node"),s=t.filter(r=>r.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:s}}function xn(t){const e=[],{nodeExtensions:n,markExtensions:s}=Qt(t),r=[...n,...s],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage,extensions:r},l=M(i,"addGlobalAttributes",a);if(!l)return;l().forEach(d=>{d.types.forEach(u=>{Object.entries(d.attributes).forEach(([p,h])=>{e.push({type:u,name:p,attribute:{...o,...h}})})})})}),r.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage},l=M(i,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([d,u])=>{const p={...o,...u};typeof p?.default=="function"&&(p.default=p.default()),p?.isRequired&&p?.default===void 0&&delete p.default,e.push({type:i.name,name:d,attribute:p})})}),e}function K(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function $(...t){return t.filter(e=>!!e).reduce((e,n)=>{const s={...e};return Object.entries(n).forEach(([r,o])=>{if(!s[r]){s[r]=o;return}if(r==="class"){const a=o?String(o).split(" "):[],l=s[r]?s[r].split(" "):[],c=a.filter(d=>!l.includes(d));s[r]=[...l,...c].join(" ")}else if(r==="style"){const a=o?o.split(";").map(d=>d.trim()).filter(Boolean):[],l=s[r]?s[r].split(";").map(d=>d.trim()).filter(Boolean):[],c=new Map;l.forEach(d=>{const[u,p]=d.split(":").map(h=>h.trim());c.set(u,p)}),a.forEach(d=>{const[u,p]=d.split(":").map(h=>h.trim());c.set(u,p)}),s[r]=Array.from(c.entries()).map(([d,u])=>`${d}: ${u}`).join("; ")}else s[r]=o}),s},{})}function Wt(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,s)=>$(n,s),{})}function Tn(t){return typeof t=="function"}function L(t,e=void 0,...n){return Tn(t)?e?t.bind(e)(...n):t(...n):t}function br(t={}){return Object.keys(t).length===0&&t.constructor===Object}function vr(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function Ve(t,e){return"style"in t?t:{...t,getAttrs:n=>{const s=t.getAttrs?t.getAttrs(n):t.attrs;if(s===!1)return!1;const r=e.reduce((o,i)=>{const a=i.attribute.parseHTML?i.attribute.parseHTML(n):vr(n.getAttribute(i.name));return a==null?o:{...o,[i.name]:a}},{});return{...s,...r}}}}function Ke(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&br(n)?!1:n!=null))}function wr(t,e){var n;const s=xn(t),{nodeExtensions:r,markExtensions:o}=Qt(t),i=(n=r.find(c=>M(c,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(r.map(c=>{const d=s.filter(g=>g.type===c.name),u={name:c.name,options:c.options,storage:c.storage,editor:e},p=t.reduce((g,x)=>{const w=M(x,"extendNodeSchema",u);return{...g,...w?w(c):{}}},{}),h=Ke({...p,content:L(M(c,"content",u)),marks:L(M(c,"marks",u)),group:L(M(c,"group",u)),inline:L(M(c,"inline",u)),atom:L(M(c,"atom",u)),selectable:L(M(c,"selectable",u)),draggable:L(M(c,"draggable",u)),code:L(M(c,"code",u)),whitespace:L(M(c,"whitespace",u)),linebreakReplacement:L(M(c,"linebreakReplacement",u)),defining:L(M(c,"defining",u)),isolating:L(M(c,"isolating",u)),attrs:Object.fromEntries(d.map(g=>{var x;return[g.name,{default:(x=g?.attribute)===null||x===void 0?void 0:x.default}]}))}),y=L(M(c,"parseHTML",u));y&&(h.parseDOM=y.map(g=>Ve(g,d)));const m=M(c,"renderHTML",u);m&&(h.toDOM=g=>m({node:g,HTMLAttributes:Wt(g,d)}));const f=M(c,"renderText",u);return f&&(h.toText=f),[c.name,h]})),l=Object.fromEntries(o.map(c=>{const d=s.filter(f=>f.type===c.name),u={name:c.name,options:c.options,storage:c.storage,editor:e},p=t.reduce((f,g)=>{const x=M(g,"extendMarkSchema",u);return{...f,...x?x(c):{}}},{}),h=Ke({...p,inclusive:L(M(c,"inclusive",u)),excludes:L(M(c,"excludes",u)),group:L(M(c,"group",u)),spanning:L(M(c,"spanning",u)),code:L(M(c,"code",u)),attrs:Object.fromEntries(d.map(f=>{var g;return[f.name,{default:(g=f?.attribute)===null||g===void 0?void 0:g.default}]}))}),y=L(M(c,"parseHTML",u));y&&(h.parseDOM=y.map(f=>Ve(f,d)));const m=M(c,"renderHTML",u);return m&&(h.toDOM=f=>m({mark:f,HTMLAttributes:Wt(f,d)})),[c.name,h]}));return new En({topNode:i,nodes:a,marks:l})}function oe(t,e){return e.nodes[t]||e.marks[t]||null}function qe(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function we(t,e){const n=zs.fromSchema(e).serializeFragment(t),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}const Mr=(t,e=500)=>{let n="";const s=t.parentOffset;return t.parent.nodesBetween(Math.max(0,s-e),s,(r,o,i,a)=>{var l,c;const d=((c=(l=r.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:r,pos:o,parent:i,index:a}))||r.textContent||"%leaf%";n+=r.isAtom&&!r.isText?d:d.slice(0,Math.max(0,s-o))}),n};function Me(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class _t{constructor(e){this.find=e.find,this.handler=e.handler}}const Er=(t,e)=>{if(Me(e))return e.exec(t);const n=e(t);if(!n)return null;const s=[n.text];return s.index=n.index,s.input=t,s.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),s.push(n.replaceWith)),s};function $t(t){var e;const{editor:n,from:s,to:r,text:o,rules:i,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(s);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(p=>p.type.spec.code))return!1;let d=!1;const u=Mr(c)+o;return i.forEach(p=>{if(d)return;const h=Er(u,p.find);if(!h)return;const y=l.state.tr,m=qt({state:l.state,transaction:y}),f={from:s-(h[0].length-o.length),to:r},{commands:g,chain:x,can:w}=new Gt({editor:n,state:m});p.handler({state:m,range:f,match:h,commands:g,chain:x,can:w})===null||!y.steps.length||(y.setMeta(a,{transform:y,from:s,to:r,text:o}),l.dispatch(y),d=!0)}),d}function kr(t){const{editor:e,rules:n}=t,s=new q({state:{init(){return null},apply(r,o,i){const a=r.getMeta(s);if(a)return a;const l=r.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:d}=l;typeof d=="string"?d=d:d=we(ut.from(d),i.schema);const{from:u}=l,p=u+d.length;$t({editor:e,from:u,to:p,text:d,rules:n,plugin:s})}),r.selectionSet||r.docChanged?null:o}},props:{handleTextInput(r,o,i,a){return $t({editor:e,from:o,to:i,text:a,rules:n,plugin:s})},handleDOMEvents:{compositionend:r=>(setTimeout(()=>{const{$cursor:o}=r.state.selection;o&&$t({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:s})}),!1)},handleKeyDown(r,o){if(o.key!=="Enter")return!1;const{$cursor:i}=r.state.selection;return i?$t({editor:e,from:i.pos,to:i.pos,text:`
`,rules:n,plugin:s}):!1}},isInputRules:!0});return s}function Sr(t){return Object.prototype.toString.call(t).slice(8,-1)}function Ht(t){return Sr(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Jt(t,e){const n={...t};return Ht(t)&&Ht(e)&&Object.keys(e).forEach(s=>{Ht(e[s])&&Ht(t[s])?n[s]=Jt(t[s],e[s]):n[s]=e[s]}),n}class nt{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=L(M(this,"addOptions",{name:this.name}))),this.storage=L(M(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new nt(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Jt(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new nt(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=L(M(n,"addOptions",{name:n.name})),n.storage=L(M(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:s}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){const i=r.marks();if(!!!i.find(c=>c?.type.name===n.name))return!1;const l=i.find(c=>c?.type.name===n.name);return l&&s.removeStoredMark(l),s.insertText(" ",r.pos),e.view.dispatch(s),!0}return!1}}function xr(t){return typeof t=="number"}class Cn{constructor(e){this.find=e.find,this.handler=e.handler}}const Tr=(t,e,n)=>{if(Me(e))return[...t.matchAll(e)];const s=e(t,n);return s?s.map(r=>{const o=[r.text];return o.index=r.index,o.input=t,o.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(r.replaceWith)),o}):[]};function Cr(t){const{editor:e,state:n,from:s,to:r,rule:o,pasteEvent:i,dropEvent:a}=t,{commands:l,chain:c,can:d}=new Gt({editor:e,state:n}),u=[];return n.doc.nodesBetween(s,r,(h,y)=>{if(!h.isTextblock||h.type.spec.code)return;const m=Math.max(s,y),f=Math.min(r,y+h.content.size),g=h.textBetween(m-y,f-y,void 0,"￼");Tr(g,o.find,i).forEach(w=>{if(w.index===void 0)return;const k=m+w.index+1,C=k+w[0].length,T={from:n.tr.mapping.map(k),to:n.tr.mapping.map(C)},R=o.handler({state:n,range:T,match:w,commands:l,chain:c,can:d,pasteEvent:i,dropEvent:a});u.push(R)})}),u.every(h=>h!==null)}let Dt=null;const Ar=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)===null||e===void 0||e.setData("text/html",t),n};function Or(t){const{editor:e,rules:n}=t;let s=null,r=!1,o=!1,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:d,from:u,to:p,rule:h,pasteEvt:y})=>{const m=d.tr,f=qt({state:d,transaction:m});if(!(!Cr({editor:e,state:f,from:Math.max(u-1,0),to:p.b-1,rule:h,pasteEvent:y,dropEvent:a})||!m.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,m}};return n.map(d=>new q({view(u){const p=y=>{var m;s=!((m=u.dom.parentElement)===null||m===void 0)&&m.contains(y.target)?u.dom.parentElement:null,s&&(Dt=e)},h=()=>{Dt&&(Dt=null)};return window.addEventListener("dragstart",p),window.addEventListener("dragend",h),{destroy(){window.removeEventListener("dragstart",p),window.removeEventListener("dragend",h)}}},props:{handleDOMEvents:{drop:(u,p)=>{if(o=s===u.dom.parentElement,a=p,!o){const h=Dt;h?.isEditable&&setTimeout(()=>{const y=h.state.selection;y&&h.commands.deleteRange({from:y.from,to:y.to})},10)}return!1},paste:(u,p)=>{var h;const y=(h=p.clipboardData)===null||h===void 0?void 0:h.getData("text/html");return i=p,r=!!y?.includes("data-pm-slice"),!1}}},appendTransaction:(u,p,h)=>{const y=u[0],m=y.getMeta("uiEvent")==="paste"&&!r,f=y.getMeta("uiEvent")==="drop"&&!o,g=y.getMeta("applyPasteRules"),x=!!g;if(!m&&!f&&!x)return;if(x){let{text:C}=g;typeof C=="string"?C=C:C=we(ut.from(C),h.schema);const{from:T}=g,R=T+C.length,A=Ar(C);return l({rule:d,state:h,from:T,to:{b:R},pasteEvt:A})}const w=p.doc.content.findDiffStart(h.doc.content),k=p.doc.content.findDiffEnd(h.doc.content);if(!(!xr(w)||!k||w===k.b))return l({rule:d,state:h,from:w,to:k,pasteEvt:i})}}))}function Lr(t){const e=t.filter((n,s)=>t.indexOf(n)!==s);return Array.from(new Set(e))}class St{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=St.resolve(e),this.schema=wr(this.extensions,n),this.setupExtensions()}static resolve(e){const n=St.sort(St.flatten(e)),s=Lr(n.map(r=>r.name));return s.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${s.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const s={name:n.name,options:n.options,storage:n.storage},r=M(n,"addExtensions",s);return r?[n,...this.flatten(r())]:n}).flat(10)}static sort(e){return e.sort((s,r)=>{const o=M(s,"priority")||100,i=M(r,"priority")||100;return o>i?-1:o<i?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const s={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:oe(n.name,this.schema)},r=M(n,"addCommands",s);return r?{...e,...r()}:e},{})}get plugins(){const{editor:e}=this,n=St.sort([...this.extensions].reverse()),s=[],r=[],o=n.map(i=>{const a={name:i.name,options:i.options,storage:i.storage,editor:e,type:oe(i.name,this.schema)},l=[],c=M(i,"addKeyboardShortcuts",a);let d={};if(i.type==="mark"&&M(i,"exitable",a)&&(d.ArrowRight=()=>nt.handleExit({editor:e,mark:i})),c){const m=Object.fromEntries(Object.entries(c()).map(([f,g])=>[f,()=>g({editor:e})]));d={...d,...m}}const u=Ws(d);l.push(u);const p=M(i,"addInputRules",a);qe(i,e.options.enableInputRules)&&p&&s.push(...p());const h=M(i,"addPasteRules",a);qe(i,e.options.enablePasteRules)&&h&&r.push(...h());const y=M(i,"addProseMirrorPlugins",a);if(y){const m=y();l.push(...m)}return l}).flat();return[kr({editor:e,rules:s}),...Or({editor:e,rules:r}),...o]}get attributes(){return xn(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=Qt(this.extensions);return Object.fromEntries(n.filter(s=>!!M(s,"addNodeView")).map(s=>{const r=this.attributes.filter(l=>l.type===s.name),o={name:s.name,options:s.options,storage:s.storage,editor:e,type:K(s.name,this.schema)},i=M(s,"addNodeView",o);if(!i)return[];const a=(l,c,d,u,p)=>{const h=Wt(l,r);return i()({node:l,view:c,getPos:d,decorations:u,innerDecorations:p,editor:e,extension:s,HTMLAttributes:h})};return[s.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var n;this.editor.extensionStorage[e.name]=e.storage;const s={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:oe(e.name,this.schema)};e.type==="mark"&&(!((n=L(M(e,"keepOnSplit",s)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(e.name);const r=M(e,"onBeforeCreate",s),o=M(e,"onCreate",s),i=M(e,"onUpdate",s),a=M(e,"onSelectionUpdate",s),l=M(e,"onTransaction",s),c=M(e,"onFocus",s),d=M(e,"onBlur",s),u=M(e,"onDestroy",s);r&&this.editor.on("beforeCreate",r),o&&this.editor.on("create",o),i&&this.editor.on("update",i),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),d&&this.editor.on("blur",d),u&&this.editor.on("destroy",u)})}}class z{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=L(M(this,"addOptions",{name:this.name}))),this.storage=L(M(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new z(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Jt(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new z({...this.config,...e});return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=L(M(n,"addOptions",{name:n.name})),n.storage=L(M(n,"addStorage",{name:n.name,options:n.options})),n}}function An(t,e,n){const{from:s,to:r}=e,{blockSeparator:o=`

`,textSerializers:i={}}=n||{};let a="";return t.nodesBetween(s,r,(l,c,d,u)=>{var p;l.isBlock&&c>s&&(a+=o);const h=i?.[l.type.name];if(h)return d&&(a+=h({node:l,pos:c,parent:d,index:u,range:e})),!1;l.isText&&(a+=(p=l?.text)===null||p===void 0?void 0:p.slice(Math.max(s,c)-c,r-c))}),a}function Ee(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const Pr=z.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new q({key:new J("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:s,selection:r}=e,{ranges:o}=r,i=Math.min(...o.map(d=>d.$from.pos)),a=Math.max(...o.map(d=>d.$to.pos)),l=Ee(n);return An(s,{from:i,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),_r=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window?.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),Rr=(t=!1)=>({commands:e})=>e.setContent("",t),Nr=()=>({state:t,tr:e,dispatch:n})=>{const{selection:s}=e,{ranges:r}=s;return n&&r.forEach(({$from:o,$to:i})=>{t.doc.nodesBetween(o.pos,i.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:d}=e,u=c.resolve(d.map(l)),p=c.resolve(d.map(l+a.nodeSize)),h=u.blockRange(p);if(!h)return;const y=qs(h);if(a.type.isTextblock){const{defaultType:m}=u.parent.contentMatchAt(u.index());e.setNodeMarkup(h.start,m)}(y||y===0)&&e.lift(h,y)})}),!0},Ir=t=>e=>t(e),$r=()=>({state:t,dispatch:e})=>hr(t,e),Hr=(t,e)=>({editor:n,tr:s})=>{const{state:r}=n,o=r.doc.slice(t.from,t.to);s.deleteRange(t.from,t.to);const i=s.mapping.map(e);return s.insert(i,o.content),s.setSelection(new Y(s.doc.resolve(Math.max(i-1,0)))),!0},Dr=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,s=n.$anchor.node();if(s.content.size>0)return!1;const r=t.selection.$anchor;for(let o=r.depth;o>0;o-=1)if(r.node(o).type===s.type){if(e){const a=r.before(o),l=r.after(o);t.delete(a,l).scrollIntoView()}return!0}return!1},Br=t=>({tr:e,state:n,dispatch:s})=>{const r=K(t,n.schema),o=e.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===r){if(s){const l=o.before(i),c=o.after(i);e.delete(l,c).scrollIntoView()}return!0}return!1},jr=t=>({tr:e,dispatch:n})=>{const{from:s,to:r}=t;return n&&e.delete(s,r),!0},Fr=()=>({state:t,dispatch:e})=>pr(t,e),zr=()=>({commands:t})=>t.keyboardShortcut("Enter"),Ur=()=>({state:t,dispatch:e})=>dr(t,e);function Vt(t,e,n={strict:!0}){const s=Object.keys(e);return s.length?s.every(r=>n.strict?e[r]===t[r]:Me(e[r])?e[r].test(t[r]):e[r]===t[r]):!0}function On(t,e,n={}){return t.find(s=>s.type===e&&Vt(Object.fromEntries(Object.keys(n).map(r=>[r,s.attrs[r]])),n))}function Ge(t,e,n={}){return!!On(t,e,n)}function ke(t,e,n){var s;if(!t||!e)return;let r=t.parent.childAfter(t.parentOffset);if((!r.node||!r.node.marks.some(d=>d.type===e))&&(r=t.parent.childBefore(t.parentOffset)),!r.node||!r.node.marks.some(d=>d.type===e)||(n=n||((s=r.node.marks[0])===null||s===void 0?void 0:s.attrs),!On([...r.node.marks],e,n)))return;let i=r.index,a=t.start()+r.offset,l=i+1,c=a+r.node.nodeSize;for(;i>0&&Ge([...t.parent.child(i-1).marks],e,n);)i-=1,a-=t.parent.child(i).nodeSize;for(;l<t.parent.childCount&&Ge([...t.parent.child(l).marks],e,n);)c+=t.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function dt(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const Wr=(t,e={})=>({tr:n,state:s,dispatch:r})=>{const o=dt(t,s.schema),{doc:i,selection:a}=n,{$from:l,from:c,to:d}=a;if(r){const u=ke(l,o,e);if(u&&u.from<=c&&u.to>=d){const p=Y.create(i,u.from,u.to);n.setSelection(p)}}return!0},Vr=t=>e=>{const n=typeof t=="function"?t(e):t;for(let s=0;s<n.length;s+=1)if(n[s](e))return!0;return!1};function Se(t){return t instanceof Y}function at(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function Ln(t,e=null){if(!e)return null;const n=yt.atStart(t),s=yt.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return s;const r=n.from,o=s.to;return e==="all"?Y.create(t,at(0,r,o),at(t.content.size,r,o)):Y.create(t,at(e,r,o),at(e,r,o))}function Pn(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Xt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Kr=(t=null,e={})=>({editor:n,view:s,tr:r,dispatch:o})=>{e={scrollIntoView:!0,...e};const i=()=>{(Xt()||Pn())&&s.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(s.focus(),e?.scrollIntoView&&n.commands.scrollIntoView())})};if(s.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!Se(n.state.selection))return i(),!0;const a=Ln(r.doc,t)||n.state.selection,l=n.state.selection.eq(a);return o&&(l||r.setSelection(a),l&&r.storedMarks&&r.setStoredMarks(r.storedMarks),i()),!0},qr=(t,e)=>n=>t.every((s,r)=>e(s,{...n,index:r})),Gr=(t,e)=>({tr:n,commands:s})=>s.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),_n=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const s=e[n];s.nodeType===3&&s.nodeValue&&/^(\n\s\s|\n)$/.test(s.nodeValue)?t.removeChild(s):s.nodeType===1&&_n(s)}return t};function Bt(t){const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return _n(n)}function Ct(t,e,n){if(t instanceof kn||t instanceof ut)return t;n={slice:!0,parseOptions:{},...n};const s=typeof t=="object"&&t!==null,r=typeof t=="string";if(s)try{if(Array.isArray(t)&&t.length>0)return ut.fromArray(t.map(a=>e.nodeFromJSON(a)));const i=e.nodeFromJSON(t);return n.errorOnInvalidContent&&i.check(),i}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),Ct("",e,n)}if(r){if(n.errorOnInvalidContent){let i=!1,a="";const l=new En({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(i=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(n.slice?re.fromSchema(l).parseSlice(Bt(t),n.parseOptions):re.fromSchema(l).parse(Bt(t),n.parseOptions),n.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=re.fromSchema(e);return n.slice?o.parseSlice(Bt(t),n.parseOptions).content:o.parse(Bt(t),n.parseOptions)}return Ct("",e,n)}function Qr(t,e,n){const s=t.steps.length-1;if(s<e)return;const r=t.steps[s];if(!(r instanceof Gs||r instanceof Qs))return;const o=t.mapping.maps[s];let i=0;o.forEach((a,l,c,d)=>{i===0&&(i=d)}),t.setSelection(yt.near(t.doc.resolve(i),n))}const Jr=t=>!("type"in t),Xr=(t,e,n)=>({tr:s,dispatch:r,editor:o})=>{var i;if(r){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;const l=f=>{o.emit("contentError",{editor:o,error:f,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{Ct(e,o.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(f){l(f)}try{a=Ct(e,o.schema,{parseOptions:c,errorOnInvalidContent:(i=n.errorOnInvalidContent)!==null&&i!==void 0?i:o.options.enableContentCheck})}catch(f){return l(f),!1}let{from:d,to:u}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},p=!0,h=!0;if((Jr(a)?a:[a]).forEach(f=>{f.check(),p=p?f.isText&&f.marks.length===0:!1,h=h?f.isBlock:!1}),d===u&&h){const{parent:f}=s.doc.resolve(d);f.isTextblock&&!f.type.spec.code&&!f.childCount&&(d-=1,u+=1)}let m;if(p){if(Array.isArray(e))m=e.map(f=>f.text||"").join("");else if(e instanceof ut){let f="";e.forEach(g=>{g.text&&(f+=g.text)}),m=f}else typeof e=="object"&&e&&e.text?m=e.text:m=e;s.insertText(m,d,u)}else m=a,s.replaceWith(d,u,m);n.updateSelection&&Qr(s,s.steps.length-1,-1),n.applyInputRules&&s.setMeta("applyInputRules",{from:d,text:m}),n.applyPasteRules&&s.setMeta("applyPasteRules",{from:d,text:m})}return!0},Yr=()=>({state:t,dispatch:e})=>or(t,e),Zr=()=>({state:t,dispatch:e})=>cr(t,e),to=()=>({state:t,dispatch:e})=>ur(t,e),eo=()=>({state:t,dispatch:e})=>lr(t,e),no=()=>({state:t,dispatch:e,tr:n})=>{try{const s=Sn(t.doc,t.selection.$from.pos,-1);return s==null?!1:(n.join(s,2),e&&e(n),!0)}catch{return!1}},so=()=>({state:t,dispatch:e,tr:n})=>{try{const s=Sn(t.doc,t.selection.$from.pos,1);return s==null?!1:(n.join(s,2),e&&e(n),!0)}catch{return!1}},ro=()=>({state:t,dispatch:e})=>ar(t,e),oo=()=>({state:t,dispatch:e})=>ir(t,e);function Rn(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function io(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let s,r,o,i;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))s=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))Xt()||Rn()?i=!0:r=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return s&&(n=`Alt-${n}`),r&&(n=`Ctrl-${n}`),i&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}const ao=t=>({editor:e,view:n,tr:s,dispatch:r})=>{const o=io(t).split(/-(?!$)/),i=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))});return l?.steps.forEach(c=>{const d=c.map(s.mapping);d&&r&&s.maybeStep(d)}),!0};function At(t,e,n={}){const{from:s,to:r,empty:o}=t.selection,i=e?K(e,t.schema):null,a=[];t.doc.nodesBetween(s,r,(u,p)=>{if(u.isText)return;const h=Math.max(s,p),y=Math.min(r,p+u.nodeSize);a.push({node:u,from:h,to:y})});const l=r-s,c=a.filter(u=>i?i.name===u.node.type.name:!0).filter(u=>Vt(u.node.attrs,n,{strict:!1}));return o?!!c.length:c.reduce((u,p)=>u+p.to-p.from,0)>=l}const lo=(t,e={})=>({state:n,dispatch:s})=>{const r=K(t,n.schema);return At(n,r,e)?rr(n,s):!1},co=()=>({state:t,dispatch:e})=>sr(t,e),uo=t=>({state:e,dispatch:n})=>{const s=K(t,e.schema);return gr(s)(e,n)},po=()=>({state:t,dispatch:e})=>nr(t,e);function Yt(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Qe(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((s,r)=>(n.includes(r)||(s[r]=t[r]),s),{})}const ho=(t,e)=>({tr:n,state:s,dispatch:r})=>{let o=null,i=null;const a=Yt(typeof t=="string"?t:t.name,s.schema);return a?(a==="node"&&(o=K(t,s.schema)),a==="mark"&&(i=dt(t,s.schema)),r&&n.selection.ranges.forEach(l=>{s.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,d)=>{o&&o===c.type&&n.setNodeMarkup(d,void 0,Qe(c.attrs,e)),i&&c.marks.length&&c.marks.forEach(u=>{i===u.type&&n.addMark(d,d+c.nodeSize,i.create(Qe(u.attrs,e)))})})}),!0):!1},fo=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),mo=()=>({tr:t,dispatch:e})=>{if(e){const n=new vs(t.doc);t.setSelection(n)}return!0},go=()=>({state:t,dispatch:e})=>er(t,e),yo=()=>({state:t,dispatch:e})=>tr(t,e),bo=()=>({state:t,dispatch:e})=>Zs(t,e),vo=()=>({state:t,dispatch:e})=>Ys(t,e),wo=()=>({state:t,dispatch:e})=>Xs(t,e);function de(t,e,n={},s={}){return Ct(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:s.errorOnInvalidContent})}const Mo=(t,e=!1,n={},s={})=>({editor:r,tr:o,dispatch:i,commands:a})=>{var l,c;const{doc:d}=o;if(n.preserveWhitespace!=="full"){const u=de(t,r.schema,n,{errorOnInvalidContent:(l=s.errorOnInvalidContent)!==null&&l!==void 0?l:r.options.enableContentCheck});return i&&o.replaceWith(0,d.content.size,u).setMeta("preventUpdate",!e),!0}return i&&o.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:d.content.size},t,{parseOptions:n,errorOnInvalidContent:(c=s.errorOnInvalidContent)!==null&&c!==void 0?c:r.options.enableContentCheck})};function Nn(t,e){const n=dt(e,t.schema),{from:s,to:r,empty:o}=t.selection,i=[];o?(t.storedMarks&&i.push(...t.storedMarks),i.push(...t.selection.$head.marks())):t.doc.nodesBetween(s,r,l=>{i.push(...l.marks)});const a=i.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function Eo(t,e){const n=new Vs(t);return e.forEach(s=>{s.steps.forEach(r=>{n.step(r)})}),n}function ko(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function pe(t,e){const n=[];return t.descendants((s,r)=>{e(s)&&n.push({node:s,pos:r})}),n}function So(t,e,n){const s=[];return t.nodesBetween(e.from,e.to,(r,o)=>{n(r)&&s.push({node:r,pos:o})}),s}function In(t,e){for(let n=t.depth;n>0;n-=1){const s=t.node(n);if(e(s))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:s}}}function xe(t){return e=>In(e.$from,t)}function $n(t,e){const n={from:0,to:t.content.size};return An(t,n,e)}function xo(t,e){const n=K(e,t.schema),{from:s,to:r}=t.selection,o=[];t.doc.nodesBetween(s,r,a=>{o.push(a)});const i=o.reverse().find(a=>a.type.name===n.name);return i?{...i.attrs}:{}}function Hn(t,e){const n=Yt(typeof e=="string"?e:e.name,t.schema);return n==="node"?xo(t,e):n==="mark"?Nn(t,e):{}}function To(t,e=JSON.stringify){const n={};return t.filter(s=>{const r=e(s);return Object.prototype.hasOwnProperty.call(n,r)?!1:n[r]=!0})}function Co(t){const e=To(t);return e.length===1?e:e.filter((n,s)=>!e.filter((o,i)=>i!==s).some(o=>n.oldRange.from>=o.oldRange.from&&n.oldRange.to<=o.oldRange.to&&n.newRange.from>=o.newRange.from&&n.newRange.to<=o.newRange.to))}function Ao(t){const{mapping:e,steps:n}=t,s=[];return e.maps.forEach((r,o)=>{const i=[];if(r.ranges.length)r.forEach((a,l)=>{i.push({from:a,to:l})});else{const{from:a,to:l}=n[o];if(a===void 0||l===void 0)return;i.push({from:a,to:l})}i.forEach(({from:a,to:l})=>{const c=e.slice(o).map(a,-1),d=e.slice(o).map(l),u=e.invert().map(c,-1),p=e.invert().map(d);s.push({oldRange:{from:u,to:p},newRange:{from:c,to:d}})})}),Co(s)}function Te(t,e,n){const s=[];return t===e?n.resolve(t).marks().forEach(r=>{const o=n.resolve(t),i=ke(o,r.type);i&&s.push({mark:r,...i})}):n.nodesBetween(t,e,(r,o)=>{!r||r?.nodeSize===void 0||s.push(...r.marks.map(i=>({from:o,to:o+r.nodeSize,mark:i})))}),s}function Ut(t,e,n){return Object.fromEntries(Object.entries(n).filter(([s])=>{const r=t.find(o=>o.type===e&&o.name===s);return r?r.attribute.keepOnSplit:!1}))}function he(t,e,n={}){const{empty:s,ranges:r}=t.selection,o=e?dt(e,t.schema):null;if(s)return!!(t.storedMarks||t.selection.$from.marks()).filter(u=>o?o.name===u.type.name:!0).find(u=>Vt(u.attrs,n,{strict:!1}));let i=0;const a=[];if(r.forEach(({$from:u,$to:p})=>{const h=u.pos,y=p.pos;t.doc.nodesBetween(h,y,(m,f)=>{if(!m.isText&&!m.marks.length)return;const g=Math.max(h,f),x=Math.min(y,f+m.nodeSize),w=x-g;i+=w,a.push(...m.marks.map(k=>({mark:k,from:g,to:x})))})}),i===0)return!1;const l=a.filter(u=>o?o.name===u.mark.type.name:!0).filter(u=>Vt(u.mark.attrs,n,{strict:!1})).reduce((u,p)=>u+p.to-p.from,0),c=a.filter(u=>o?u.mark.type!==o&&u.mark.type.excludes(o):!0).reduce((u,p)=>u+p.to-p.from,0);return(l>0?l+c:l)>=i}function Oo(t,e,n={}){if(!e)return At(t,null,n)||he(t,null,n);const s=Yt(e,t.schema);return s==="node"?At(t,e,n):s==="mark"?he(t,e,n):!1}function Je(t,e){const{nodeExtensions:n}=Qt(e),s=n.find(i=>i.name===t);if(!s)return!1;const r={name:s.name,options:s.options,storage:s.storage},o=L(M(s,"group",r));return typeof o!="string"?!1:o.split(" ").includes("list")}function Zt(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var s;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((s=t.text)!==null&&s!==void 0?s:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let r=!0;return t.content.forEach(o=>{r!==!1&&(Zt(o,{ignoreWhitespace:n,checkChildren:e})||(r=!1))}),r}return!1}function Dn(t){return t instanceof vt}function Bn(t,e,n){const r=t.state.doc.content.size,o=at(e,0,r),i=at(n,0,r),a=t.coordsAtPos(o),l=t.coordsAtPos(i,-1),c=Math.min(a.top,l.top),d=Math.max(a.bottom,l.bottom),u=Math.min(a.left,l.left),p=Math.max(a.right,l.right),h=p-u,y=d-c,g={top:c,bottom:d,left:u,right:p,width:h,height:y,x:u,y:c};return{...g,toJSON:()=>g}}function Lo(t,e,n){var s;const{selection:r}=e;let o=null;if(Se(r)&&(o=r.$cursor),o){const a=(s=t.storedMarks)!==null&&s!==void 0?s:o.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:i}=r;return i.some(({$from:a,$to:l})=>{let c=a.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(a.pos,l.pos,(d,u,p)=>{if(c)return!1;if(d.isInline){const h=!p||p.type.allowsMarkType(n),y=!!n.isInSet(d.marks)||!d.marks.some(m=>m.type.excludes(n));c=h&&y}return!c}),c})}const Po=(t,e={})=>({tr:n,state:s,dispatch:r})=>{const{selection:o}=n,{empty:i,ranges:a}=o,l=dt(t,s.schema);if(r)if(i){const c=Nn(s,l);n.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const d=c.$from.pos,u=c.$to.pos;s.doc.nodesBetween(d,u,(p,h)=>{const y=Math.max(h,d),m=Math.min(h+p.nodeSize,u);p.marks.find(g=>g.type===l)?p.marks.forEach(g=>{l===g.type&&n.addMark(y,m,l.create({...g.attrs,...e}))}):n.addMark(y,m,l.create(e))})});return Lo(s,n,l)},_o=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),Ro=(t,e={})=>({state:n,dispatch:s,chain:r})=>{const o=K(t,n.schema);let i;return n.selection.$anchor.sameParent(n.selection.$head)&&(i=n.selection.$anchor.parent.attrs),o.isTextblock?r().command(({commands:a})=>We(o,{...i,...e})(n)?!0:a.clearNodes()).command(({state:a})=>We(o,{...i,...e})(a,s)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},No=t=>({tr:e,dispatch:n})=>{if(n){const{doc:s}=e,r=at(t,0,s.content.size),o=vt.create(s,r);e.setSelection(o)}return!0},Io=t=>({tr:e,dispatch:n})=>{if(n){const{doc:s}=e,{from:r,to:o}=typeof t=="number"?{from:t,to:t}:t,i=Y.atStart(s).from,a=Y.atEnd(s).to,l=at(r,i,a),c=at(o,i,a),d=Y.create(s,l,c);e.setSelection(d)}return!0},$o=t=>({state:e,dispatch:n})=>{const s=K(t,e.schema);return mr(s)(e,n)};function Xe(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const s=n.filter(r=>e?.includes(r.type.name));t.tr.ensureMarks(s)}}const Ho=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:s,editor:r})=>{const{selection:o,doc:i}=e,{$from:a,$to:l}=o,c=r.extensionManager.attributes,d=Ut(c,a.node().type.name,a.node().attrs);if(o instanceof vt&&o.node.isBlock)return!a.parentOffset||!zt(i,a.pos)?!1:(s&&(t&&Xe(n,r.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const u=l.parentOffset===l.parent.content.size,p=a.depth===0?void 0:ko(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=u&&p?[{type:p,attrs:d}]:void 0,y=zt(e.doc,e.mapping.map(a.pos),1,h);if(!h&&!y&&zt(e.doc,e.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(y=!0,h=p?[{type:p,attrs:d}]:void 0),s){if(y&&(o instanceof Y&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,h),p&&!u&&!a.parentOffset&&a.parent.type!==p)){const m=e.mapping.map(a.before()),f=e.doc.resolve(m);a.node(-1).canReplaceWith(f.index(),f.index()+1,p)&&e.setNodeMarkup(e.mapping.map(a.before()),p)}t&&Xe(n,r.extensionManager.splittableMarks),e.scrollIntoView()}return y},Do=(t,e={})=>({tr:n,state:s,dispatch:r,editor:o})=>{var i;const a=K(t,s.schema),{$from:l,$to:c}=s.selection,d=s.selection.node;if(d&&d.isBlock||l.depth<2||!l.sameParent(c))return!1;const u=l.node(-1);if(u.type!==a)return!1;const p=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(r){let g=ut.empty;const x=l.index(-1)?1:l.index(-2)?2:3;for(let A=l.depth-x;A>=l.depth-3;A-=1)g=ut.from(l.node(A).copy(g));const w=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,k={...Ut(p,l.node().type.name,l.node().attrs),...e},C=((i=a.contentMatch.defaultType)===null||i===void 0?void 0:i.createAndFill(k))||void 0;g=g.append(ut.from(a.createAndFill(null,C)||void 0));const T=l.before(l.depth-(x-1));n.replace(T,l.after(-w),new Us(g,4-x,0));let R=-1;n.doc.nodesBetween(T,n.doc.content.size,(A,W)=>{if(R>-1)return!1;A.isTextblock&&A.content.size===0&&(R=W+1)}),R>-1&&n.setSelection(Y.near(n.doc.resolve(R))),n.scrollIntoView()}return!0}const h=c.pos===l.end()?u.contentMatchAt(0).defaultType:null,y={...Ut(p,u.type.name,u.attrs),...e},m={...Ut(p,l.node().type.name,l.node().attrs),...e};n.delete(l.pos,c.pos);const f=h?[{type:a,attrs:y},{type:h,attrs:m}]:[{type:a,attrs:y}];if(!zt(n.doc,l.pos,2))return!1;if(r){const{selection:g,storedMarks:x}=s,{splittableMarks:w}=o.extensionManager,k=x||g.$to.parentOffset&&g.$from.marks();if(n.split(l.pos,2,f).scrollIntoView(),!k||!r)return!0;const C=k.filter(T=>w.includes(T.type.name));n.ensureMarks(C)}return!0},ie=(t,e)=>{const n=xe(i=>i.type===e)(t.selection);if(!n)return!0;const s=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(s===void 0)return!0;const r=t.doc.nodeAt(s);return n.node.type===r?.type&&ve(t.doc,n.pos)&&t.join(n.pos),!0},ae=(t,e)=>{const n=xe(i=>i.type===e)(t.selection);if(!n)return!0;const s=t.doc.resolve(n.start).after(n.depth);if(s===void 0)return!0;const r=t.doc.nodeAt(s);return n.node.type===r?.type&&ve(t.doc,s)&&t.join(s),!0},Bo=(t,e,n,s={})=>({editor:r,tr:o,state:i,dispatch:a,chain:l,commands:c,can:d})=>{const{extensions:u,splittableMarks:p}=r.extensionManager,h=K(t,i.schema),y=K(e,i.schema),{selection:m,storedMarks:f}=i,{$from:g,$to:x}=m,w=g.blockRange(x),k=f||m.$to.parentOffset&&m.$from.marks();if(!w)return!1;const C=xe(T=>Je(T.type.name,u))(m);if(w.depth>=1&&C&&w.depth-C.depth<=1){if(C.node.type===h)return c.liftListItem(y);if(Je(C.node.type.name,u)&&h.validContent(C.node.content)&&a)return l().command(()=>(o.setNodeMarkup(C.pos,h),!0)).command(()=>ie(o,h)).command(()=>ae(o,h)).run()}return!n||!k||!a?l().command(()=>d().wrapInList(h,s)?!0:c.clearNodes()).wrapInList(h,s).command(()=>ie(o,h)).command(()=>ae(o,h)).run():l().command(()=>{const T=d().wrapInList(h,s),R=k.filter(A=>p.includes(A.type.name));return o.ensureMarks(R),T?!0:c.clearNodes()}).wrapInList(h,s).command(()=>ie(o,h)).command(()=>ae(o,h)).run()},jo=(t,e={},n={})=>({state:s,commands:r})=>{const{extendEmptyMarkRange:o=!1}=n,i=dt(t,s.schema);return he(s,i,e)?r.unsetMark(i,{extendEmptyMarkRange:o}):r.setMark(i,e)},Fo=(t,e,n={})=>({state:s,commands:r})=>{const o=K(t,s.schema),i=K(e,s.schema),a=At(s,o,n);let l;return s.selection.$anchor.sameParent(s.selection.$head)&&(l=s.selection.$anchor.parent.attrs),a?r.setNode(i,l):r.setNode(o,{...l,...n})},zo=(t,e={})=>({state:n,commands:s})=>{const r=K(t,n.schema);return At(n,r,e)?s.lift(r):s.wrapIn(r,e)},Uo=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let s=0;s<n.length;s+=1){const r=n[s];let o;if(r.spec.isInputRules&&(o=r.getState(t))){if(e){const i=t.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)i.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,t.schema.text(o.text,l))}else i.delete(o.from,o.to)}return!0}}return!1},Wo=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:s,ranges:r}=n;return s||e&&r.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},Vo=(t,e={})=>({tr:n,state:s,dispatch:r})=>{var o;const{extendEmptyMarkRange:i=!1}=e,{selection:a}=n,l=dt(t,s.schema),{$from:c,empty:d,ranges:u}=a;if(!r)return!0;if(d&&i){let{from:p,to:h}=a;const y=(o=c.marks().find(f=>f.type===l))===null||o===void 0?void 0:o.attrs,m=ke(c,l,y);m&&(p=m.from,h=m.to),n.removeMark(p,h,l)}else u.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,l)});return n.removeStoredMark(l),!0},Ko=(t,e={})=>({tr:n,state:s,dispatch:r})=>{let o=null,i=null;const a=Yt(typeof t=="string"?t:t.name,s.schema);return a?(a==="node"&&(o=K(t,s.schema)),a==="mark"&&(i=dt(t,s.schema)),r&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,d=l.$to.pos;let u,p,h,y;n.selection.empty?s.doc.nodesBetween(c,d,(m,f)=>{o&&o===m.type&&(h=Math.max(f,c),y=Math.min(f+m.nodeSize,d),u=f,p=m)}):s.doc.nodesBetween(c,d,(m,f)=>{f<c&&o&&o===m.type&&(h=Math.max(f,c),y=Math.min(f+m.nodeSize,d),u=f,p=m),f>=c&&f<=d&&(o&&o===m.type&&n.setNodeMarkup(f,void 0,{...m.attrs,...e}),i&&m.marks.length&&m.marks.forEach(g=>{if(i===g.type){const x=Math.max(f,c),w=Math.min(f+m.nodeSize,d);n.addMark(x,w,i.create({...g.attrs,...e}))}}))}),p&&(u!==void 0&&n.setNodeMarkup(u,void 0,{...p.attrs,...e}),i&&p.marks.length&&p.marks.forEach(m=>{i===m.type&&n.addMark(h,y,i.create({...m.attrs,...e}))}))}),!0):!1},qo=(t,e={})=>({state:n,dispatch:s})=>{const r=K(t,n.schema);return Js(r,e)(n,s)},Go=(t,e={})=>({state:n,dispatch:s})=>{const r=K(t,n.schema);return fr(r,e)(n,s)};var Qo=Object.freeze({__proto__:null,blur:_r,clearContent:Rr,clearNodes:Nr,command:Ir,createParagraphNear:$r,cut:Hr,deleteCurrentNode:Dr,deleteNode:Br,deleteRange:jr,deleteSelection:Fr,enter:zr,exitCode:Ur,extendMarkRange:Wr,first:Vr,focus:Kr,forEach:qr,insertContent:Gr,insertContentAt:Xr,joinBackward:to,joinDown:Zr,joinForward:eo,joinItemBackward:no,joinItemForward:so,joinTextblockBackward:ro,joinTextblockForward:oo,joinUp:Yr,keyboardShortcut:ao,lift:lo,liftEmptyBlock:co,liftListItem:uo,newlineInCode:po,resetAttributes:ho,scrollIntoView:fo,selectAll:mo,selectNodeBackward:go,selectNodeForward:yo,selectParentNode:bo,selectTextblockEnd:vo,selectTextblockStart:wo,setContent:Mo,setMark:Po,setMeta:_o,setNode:Ro,setNodeSelection:No,setTextSelection:Io,sinkListItem:$o,splitBlock:Ho,splitListItem:Do,toggleList:Bo,toggleMark:jo,toggleNode:Fo,toggleWrap:zo,undoInputRule:Uo,unsetAllMarks:Wo,unsetMark:Vo,updateAttributes:Ko,wrapIn:qo,wrapInList:Go});const Jo=z.create({name:"commands",addCommands(){return{...Qo}}}),Xo=z.create({name:"drop",addProseMirrorPlugins(){return[new q({key:new J("tiptapDrop"),props:{handleDrop:(t,e,n,s)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:s})}}})]}}),Yo=z.create({name:"editable",addProseMirrorPlugins(){return[new q({key:new J("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Zo=new J("focusEvents"),ti=z.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new q({key:Zo,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const s=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(s),!1},blur:(e,n)=>{t.isFocused=!1;const s=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(s),!1}}}})]}}),ei=z.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:d,$anchor:u}=l,{pos:p,parent:h}=u,y=u.parent.isTextblock&&p>0?a.doc.resolve(p-1):u,m=y.parent.type.spec.isolating,f=u.pos-u.parentOffset,g=m&&y.parent.childCount===1?f===u.pos:yt.atStart(c).from===p;return!d||!h.type.isTextblock||h.textContent.length||!g||g&&u.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),s={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},r={...s},o={...s,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Xt()||Rn()?o:r},addProseMirrorPlugins(){return[new q({key:new J("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(m=>m.getMeta("composition")))return;const s=t.some(m=>m.docChanged)&&!e.doc.eq(n.doc),r=t.some(m=>m.getMeta("preventClearDocument"));if(!s||r)return;const{empty:o,from:i,to:a}=e.selection,l=yt.atStart(e.doc).from,c=yt.atEnd(e.doc).to;if(o||!(i===l&&a===c)||!Zt(n.doc))return;const p=n.tr,h=qt({state:n,transaction:p}),{commands:y}=new Gt({editor:this.editor,state:h});if(y.clearNodes(),!!p.steps.length)return p}})]}}),ni=z.create({name:"paste",addProseMirrorPlugins(){return[new q({key:new J("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),si=z.create({name:"tabindex",addProseMirrorPlugins(){return[new q({key:new J("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class gt{get name(){return this.node.type.name}constructor(e,n,s=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=s,this.resolvedPos=e,this.editor=n,this.currentNode=r}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,s=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,s=this.to-1}this.editor.commands.insertContentAt({from:n,to:s},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new gt(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new gt(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new gt(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,s)=>{const r=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,i=this.pos+s+(o?0:1);if(i<0||i>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(i);if(!r&&a.depth<=this.depth)return;const l=new gt(a,this.editor,r,r?n:null);r&&(l.actualDepth=this.depth+1),e.push(new gt(a,this.editor,r,r?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let s=null,r=this.parent;for(;r&&!s;){if(r.node.type.name===e)if(Object.keys(n).length>0){const o=r.node.attrs,i=Object.keys(n);for(let a=0;a<i.length;a+=1){const l=i[a];if(o[l]!==n[l])break}}else s=r;r=r.parent}return s}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},s=!1){let r=[];if(!this.children||this.children.length===0)return r;const o=Object.keys(n);return this.children.forEach(i=>{s&&r.length>0||(i.node.type.name===e&&o.every(l=>n[l]===i.node.attrs[l])&&r.push(i),!(s&&r.length>0)&&(r=r.concat(i.querySelectorAll(e,n,s))))}),r}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}}const ri=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function oi(t,e,n){const s=document.querySelector("style[data-tiptap-style]");if(s!==null)return s;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style",""),r.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(r),r}class ii extends yr{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:s,moved:r})=>this.options.onDrop(n,s,r)),this.on("paste",({event:n,slice:s})=>this.options.onPaste(n,s)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=oi(ri,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const s=Tn(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:s});return this.view.updateState(r),r}unregisterPlugin(e){if(this.isDestroyed)return;const n=this.state.plugins;let s=n;if([].concat(e).forEach(o=>{const i=typeof o=="string"?`${o}$`:o.key;s=s.filter(a=>!a.key.startsWith(i))}),n.length===s.length)return;const r=this.state.reconfigure({plugins:s});return this.view.updateState(r),r}createExtensionManager(){var e,n;const r=[...this.options.enableCoreExtensions?[Yo,Pr.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),Jo,ti,ei,si,Xo,ni].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o?.type));this.extensionManager=new St(r,this)}createCommandManager(){this.commandManager=new Gt({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let n;try{n=de(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(i){if(!(i instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(i.message))throw i;this.emit("contentError",{editor:this,error:i,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),n=de(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const s=Ln(n,this.options.autofocus);this.view=new Ss(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:bs.create({doc:n,selection:s||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(i=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(i)});return}const n=this.state.apply(e),s=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),s&&this.emit("selectionUpdate",{editor:this,transaction:e});const r=e.getMeta("focus"),o=e.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return Hn(this.state,e)}isActive(e,n){const s=typeof e=="string"?e:null,r=typeof e=="string"?n:e;return Oo(this.state,s,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return we(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:s={}}=e||{};return $n(this.state.doc,{blockSeparator:n,textSerializers:{...Ee(this.schema),...s}})}get isEmpty(){return Zt(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,n){var s;return((s=this.$doc)===null||s===void 0?void 0:s.querySelector(e,n))||null}$nodes(e,n){var s;return((s=this.$doc)===null||s===void 0?void 0:s.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new gt(n,this)}get $doc(){return this.$pos(0)}}function xt(t){return new _t({find:t.find,handler:({state:e,range:n,match:s})=>{const r=L(t.getAttributes,void 0,s);if(r===!1||r===null)return null;const{tr:o}=e,i=s[s.length-1],a=s[0];if(i){const l=a.search(/\S/),c=n.from+a.indexOf(i),d=c+i.length;if(Te(n.from,n.to,e.doc).filter(h=>h.mark.type.excluded.find(m=>m===t.type&&m!==h.mark.type)).filter(h=>h.to>c).length)return null;d<n.to&&o.delete(d,n.to),c>n.from&&o.delete(n.from+l,c);const p=n.from+l+i.length;o.addMark(n.from+l,p,t.type.create(r||{})),o.removeStoredMark(t.type)}}})}function jn(t){return new _t({find:t.find,handler:({state:e,range:n,match:s})=>{const r=L(t.getAttributes,void 0,s)||{},{tr:o}=e,i=n.from;let a=n.to;const l=t.type.create(r);if(s[1]){const c=s[0].lastIndexOf(s[1]);let d=i+c;d>a?d=a:a=d+s[1].length;const u=s[0][s[0].length-1];o.insertText(u,i+s[0].length-1),o.replaceWith(d,a,l)}else if(s[0]){const c=t.type.isInline?i:i-1;o.insert(c,t.type.create(r)).delete(o.mapping.map(i),o.mapping.map(a))}o.scrollIntoView()}})}function fe(t){return new _t({find:t.find,handler:({state:e,range:n,match:s})=>{const r=e.doc.resolve(n.from),o=L(t.getAttributes,void 0,s)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,o)}})}function F(t){return new _t({find:t.find,handler:({state:e,range:n,match:s})=>{let r=t.replace,o=n.from;const i=n.to;if(s[1]){const a=s[0].lastIndexOf(s[1]);r+=s[0].slice(a+s[1].length),o+=a;const l=o-i;l>0&&(r=s[0].slice(a-l,a)+r,o=i)}e.tr.insertText(r,o,i)}})}function Ot(t){return new _t({find:t.find,handler:({state:e,range:n,match:s,chain:r})=>{const o=L(t.getAttributes,void 0,s)||{},i=e.tr.delete(n.from,n.to),l=i.doc.resolve(n.from).blockRange(),c=l&&Ks(l,t.type,o);if(!c)return null;if(i.wrap(l,c),t.keepMarks&&t.editor){const{selection:u,storedMarks:p}=e,{splittableMarks:h}=t.editor.extensionManager,y=p||u.$to.parentOffset&&u.$from.marks();if(y){const m=y.filter(f=>h.includes(f.type.name));i.ensureMarks(m)}}if(t.keepAttributes){const u=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";r().updateAttributes(u,o).run()}const d=i.doc.resolve(n.from-1).nodeBefore;d&&d.type===t.type&&ve(i.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(s,d))&&i.join(n.from-1)}})}class U{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=L(M(this,"addOptions",{name:this.name}))),this.storage=L(M(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new U(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Jt(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new U(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=L(M(n,"addOptions",{name:n.name})),n.storage=L(M(n,"addStorage",{name:n.name,options:n.options})),n}}class ai{constructor(e,n,s){this.isDragging=!1,this.component=e,this.editor=n.editor,this.options={stopEvent:null,ignoreMutation:null,...s},this.extension=n.extension,this.node=n.node,this.decorations=n.decorations,this.innerDecorations=n.innerDecorations,this.view=n.view,this.HTMLAttributes=n.HTMLAttributes,this.getPos=n.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(e){var n,s,r,o,i,a,l;const{view:c}=this.editor,d=e.target,u=d.nodeType===3?(n=d.parentElement)===null||n===void 0?void 0:n.closest("[data-drag-handle]"):d.closest("[data-drag-handle]");if(!this.dom||!((s=this.contentDOM)===null||s===void 0)&&s.contains(d)||!u)return;let p=0,h=0;if(this.dom!==u){const x=this.dom.getBoundingClientRect(),w=u.getBoundingClientRect(),k=(r=e.offsetX)!==null&&r!==void 0?r:(o=e.nativeEvent)===null||o===void 0?void 0:o.offsetX,C=(i=e.offsetY)!==null&&i!==void 0?i:(a=e.nativeEvent)===null||a===void 0?void 0:a.offsetY;p=w.x-x.x+k,h=w.y-x.y+C}const y=this.dom.cloneNode(!0);(l=e.dataTransfer)===null||l===void 0||l.setDragImage(y,p,h);const m=this.getPos();if(typeof m!="number")return;const f=vt.create(c.state.doc,m),g=c.state.tr.setSelection(f);c.dispatch(g)}stopEvent(e){var n;if(!this.dom)return!1;if(typeof this.options.stopEvent=="function")return this.options.stopEvent({event:e});const s=e.target;if(!(this.dom.contains(s)&&!(!((n=this.contentDOM)===null||n===void 0)&&n.contains(s))))return!1;const o=e.type.startsWith("drag"),i=e.type==="drop";if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(s.tagName)||s.isContentEditable)&&!i&&!o)return!0;const{isEditable:l}=this.editor,{isDragging:c}=this,d=!!this.node.type.spec.draggable,u=vt.isSelectable(this.node),p=e.type==="copy",h=e.type==="paste",y=e.type==="cut",m=e.type==="mousedown";if(!d&&u&&o&&e.target===this.dom&&e.preventDefault(),d&&o&&!c&&e.target===this.dom)return e.preventDefault(),!1;if(d&&l&&!c&&m){const f=s.closest("[data-drag-handle]");f&&(this.dom===f||this.dom.contains(f))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(c||i||p||h||y||m&&u)}ignoreMutation(e){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:e}):this.node.isLeaf||this.node.isAtom?!0:e.type==="selection"||this.dom.contains(e.target)&&e.type==="childList"&&(Xt()||Pn())&&this.editor.isFocused&&[...Array.from(e.addedNodes),...Array.from(e.removedNodes)].every(s=>s.isContentEditable)?!1:this.contentDOM===e.target&&e.type==="attributes"?!0:!this.contentDOM.contains(e.target)}updateAttributes(e){this.editor.commands.command(({tr:n})=>{const s=this.getPos();return typeof s!="number"?!1:(n.setNodeMarkup(s,void 0,{...this.node.attrs,...e}),!0)})}deleteNode(){const e=this.getPos();if(typeof e!="number")return;const n=e+this.node.nodeSize;this.editor.commands.deleteRange({from:e,to:n})}}function wt(t){return new Cn({find:t.find,handler:({state:e,range:n,match:s,pasteEvent:r})=>{const o=L(t.getAttributes,void 0,s,r);if(o===!1||o===null)return null;const{tr:i}=e,a=s[s.length-1],l=s[0];let c=n.to;if(a){const d=l.search(/\S/),u=n.from+l.indexOf(a),p=u+a.length;if(Te(n.from,n.to,e.doc).filter(y=>y.mark.type.excluded.find(f=>f===t.type&&f!==y.mark.type)).filter(y=>y.to>u).length)return null;p<n.to&&i.delete(p,n.to),u>n.from&&i.delete(n.from+d,u),c=n.from+d+a.length,i.addMark(n.from+d,c,t.type.create(o||{})),i.removeStoredMark(t.type)}}})}function li(t,e){const{selection:n}=t,{$from:s}=n;if(n instanceof vt){const o=s.index();return s.parent.canReplaceWith(o,o+1,e)}let r=s.depth;for(;r>=0;){const o=s.index(r);if(s.node(r).contentMatchAt(o).matchType(e))return!0;r-=1}return!1}function ci(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function ui(t){return new Cn({find:t.find,handler({match:e,chain:n,range:s,pasteEvent:r}){const o=L(t.getAttributes,void 0,e,r),i=L(t.getContent,void 0,o);if(o===!1||o===null)return null;const a={type:t.type.name,attrs:o};i&&(a.content=i),e.input&&n().deleteRange(s).insertContentAt(s.from,a)}})}class di{constructor({editor:e,element:n,view:s,tippyOptions:r={},updateDelay:o=250,shouldShow:i}){this.preventHide=!1,this.shouldShow=({view:a,state:l,from:c,to:d})=>{const{doc:u,selection:p}=l,{empty:h}=p,y=!u.textBetween(c,d).length&&Se(l.selection),m=this.element.contains(document.activeElement);return!(!(a.hasFocus()||m)||h||y||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var l;if(this.preventHide){this.preventHide=!1;return}a?.relatedTarget&&(!((l=this.element.parentNode)===null||l===void 0)&&l.contains(a.relatedTarget))||a?.relatedTarget!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.handleDebouncedUpdate=(a,l)=>{const c=!l?.selection.eq(a.state.selection),d=!l?.doc.eq(a.state.doc);!c&&!d||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(a,c,d,l)},this.updateDelay))},this.updateHandler=(a,l,c,d)=>{var u,p,h;const{state:y,composing:m}=a,{selection:f}=y;if(m||!l&&!c)return;this.createTooltip();const{ranges:x}=f,w=Math.min(...x.map(T=>T.$from.pos)),k=Math.max(...x.map(T=>T.$to.pos));if(!((u=this.shouldShow)===null||u===void 0?void 0:u.call(this,{editor:this.editor,element:this.element,view:a,state:y,oldState:d,from:w,to:k}))){this.hide();return}(p=this.tippy)===null||p===void 0||p.setProps({getReferenceClientRect:((h=this.tippyOptions)===null||h===void 0?void 0:h.getReferenceClientRect)||(()=>{if(Dn(y.selection)){let T=a.nodeDOM(w);if(T){const R=T.dataset.nodeViewWrapper?T:T.querySelector("[data-node-view-wrapper]");if(R&&(T=R.firstChild),T)return T.getBoundingClientRect()}}return Bn(a,w,k)})}),this.show()},this.editor=e,this.element=n,this.view=s,this.updateDelay=o,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,n=!!e.parentElement;this.element.tabIndex=0,!(this.tippy||!n)&&(this.tippy=vn(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,n){const{state:s}=e,r=s.selection.from!==s.selection.to;if(this.updateDelay>0&&r){this.handleDebouncedUpdate(e,n);return}const o=!n?.selection.eq(e.state.selection),i=!n?.doc.eq(e.state.doc);this.updateHandler(e,o,i,n)}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,n;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const Fn=t=>new q({key:typeof t.pluginKey=="string"?new J(t.pluginKey):t.pluginKey,view:e=>new di({view:e,...t})}),bc=z.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[Fn({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});class pi{getTextContent(e){return $n(e,{textSerializers:Ee(this.editor.schema)})}constructor({editor:e,element:n,view:s,tippyOptions:r={},shouldShow:o}){this.preventHide=!1,this.shouldShow=({view:i,state:a})=>{const{selection:l}=a,{$anchor:c,empty:d}=l,u=c.depth===1,p=c.parent.isTextblock&&!c.parent.type.spec.code&&!c.parent.textContent&&c.parent.childCount===0&&!this.getTextContent(c.parent);return!(!i.hasFocus()||!d||!u||!p||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:i})=>{var a;if(this.preventHide){this.preventHide=!1;return}i?.relatedTarget&&(!((a=this.element.parentNode)===null||a===void 0)&&a.contains(i.relatedTarget))||i?.relatedTarget!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=i=>{this.blurHandler({event:i})},this.editor=e,this.element=n,this.view=s,o&&(this.shouldShow=o),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,n=!!e.parentElement;this.element.tabIndex=0,!(this.tippy||!n)&&(this.tippy=vn(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,n){var s,r,o;const{state:i}=e,{doc:a,selection:l}=i,{from:c,to:d}=l;if(n&&n.doc.eq(a)&&n.selection.eq(l))return;if(this.createTooltip(),!((s=this.shouldShow)===null||s===void 0?void 0:s.call(this,{editor:this.editor,view:e,state:i,oldState:n}))){this.hide();return}(r=this.tippy)===null||r===void 0||r.setProps({getReferenceClientRect:((o=this.tippyOptions)===null||o===void 0?void 0:o.getReferenceClientRect)||(()=>Bn(e,c,d))}),this.show()}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,n;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const zn=t=>new q({key:typeof t.pluginKey=="string"?new J(t.pluginKey):t.pluginKey,view:e=>new pi({view:e,...t})});z.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[zn({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});function hi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Un={exports:{}},le={};var Ye;function fi(){if(Ye)return le;Ye=1;var t=V;function e(u,p){return u===p&&(u!==0||1/u===1/p)||u!==u&&p!==p}var n=typeof Object.is=="function"?Object.is:e,s=t.useState,r=t.useEffect,o=t.useLayoutEffect,i=t.useDebugValue;function a(u,p){var h=p(),y=s({inst:{value:h,getSnapshot:p}}),m=y[0].inst,f=y[1];return o(function(){m.value=h,m.getSnapshot=p,l(m)&&f({inst:m})},[u,h,p]),r(function(){return l(m)&&f({inst:m}),u(function(){l(m)&&f({inst:m})})},[u]),i(h),h}function l(u){var p=u.getSnapshot;u=u.value;try{var h=p();return!n(u,h)}catch{return!0}}function c(u,p){return p()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return le.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:d,le}Un.exports=fi();var Ce=Un.exports;const mi=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},gi=({contentComponent:t})=>{const e=Ce.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return V.createElement(V.Fragment,null,Object.values(e))};function yi(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,s){e={...e,[n]:Ms.createPortal(s.reactElement,s.element,n)},t.forEach(r=>r())},removeRenderer(n){const s={...e};delete s[n],e=s,t.forEach(r=>r())}}}class bi extends V.Component{constructor(e){var n;super(e),this.editorContentRef=V.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=e.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=yi(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(s=>s.hasContentComponentInitialized?s:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,innerRef:n,...s}=this.props;return V.createElement(V.Fragment,null,V.createElement("div",{ref:mi(n,this.editorContentRef),...s}),e?.contentComponent&&V.createElement(gi,{contentComponent:e.contentComponent}))}}const vi=j.forwardRef((t,e)=>{const n=V.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return V.createElement(bi,{key:n,innerRef:e,...t})}),vc=V.memo(vi);var wi=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var s,r,o;if(Array.isArray(e)){if(s=e.length,s!=n.length)return!1;for(r=s;r--!==0;)if(!t(e[r],n[r]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(r of e.entries())if(!n.has(r[0]))return!1;for(r of e.entries())if(!t(r[1],n.get(r[0])))return!1;return!0}if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(r of e.entries())if(!n.has(r[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(s=e.length,s!=n.length)return!1;for(r=s;r--!==0;)if(e[r]!==n[r])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(o=Object.keys(e),s=o.length,s!==Object.keys(n).length)return!1;for(r=s;r--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[r]))return!1;for(r=s;r--!==0;){var i=o[r];if(!(i==="_owner"&&e.$$typeof)&&!t(e[i],n[i]))return!1}return!0}return e!==e&&n!==n},Mi=hi(wi),Wn={exports:{}},ce={};var Ze;function Ei(){if(Ze)return ce;Ze=1;var t=V,e=Ce;function n(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var s=typeof Object.is=="function"?Object.is:n,r=e.useSyncExternalStore,o=t.useRef,i=t.useEffect,a=t.useMemo,l=t.useDebugValue;return ce.useSyncExternalStoreWithSelector=function(c,d,u,p,h){var y=o(null);if(y.current===null){var m={hasValue:!1,value:null};y.current=m}else m=y.current;y=a(function(){function g(T){if(!x){if(x=!0,w=T,T=p(T),h!==void 0&&m.hasValue){var R=m.value;if(h(R,T))return k=R}return k=T}if(R=k,s(w,T))return R;var A=p(T);return h!==void 0&&h(R,A)?R:(w=T,k=A)}var x=!1,w,k,C=u===void 0?null:u;return[function(){return g(d())},C===null?void 0:function(){return g(C())}]},[d,u,p,h]);var f=r(c,y[0],y[1]);return i(function(){m.hasValue=!0,m.value=f},[f]),l(f),f},ce}Wn.exports=Ei();var ki=Wn.exports;const Si=typeof window<"u"?j.useLayoutEffect:j.useEffect;class xi{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},s=this.editor;return s.on("transaction",n),()=>{s.off("transaction",n)}}}}function Ti(t){var e;const[n]=j.useState(()=>new xi(t.editor)),s=ki.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!==null&&e!==void 0?e:Mi);return Si(()=>n.watch(t.editor),[t.editor,n]),j.useDebugValue(s),s}const Ci=!1,me=typeof window>"u",Ai=me||!!(typeof window<"u"&&window.next);class Ae{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?me||Ai?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...s)=>{var r,o;return(o=(r=this.options.current).onBeforeCreate)===null||o===void 0?void 0:o.call(r,...s)},onBlur:(...s)=>{var r,o;return(o=(r=this.options.current).onBlur)===null||o===void 0?void 0:o.call(r,...s)},onCreate:(...s)=>{var r,o;return(o=(r=this.options.current).onCreate)===null||o===void 0?void 0:o.call(r,...s)},onDestroy:(...s)=>{var r,o;return(o=(r=this.options.current).onDestroy)===null||o===void 0?void 0:o.call(r,...s)},onFocus:(...s)=>{var r,o;return(o=(r=this.options.current).onFocus)===null||o===void 0?void 0:o.call(r,...s)},onSelectionUpdate:(...s)=>{var r,o;return(o=(r=this.options.current).onSelectionUpdate)===null||o===void 0?void 0:o.call(r,...s)},onTransaction:(...s)=>{var r,o;return(o=(r=this.options.current).onTransaction)===null||o===void 0?void 0:o.call(r,...s)},onUpdate:(...s)=>{var r,o;return(o=(r=this.options.current).onUpdate)===null||o===void 0?void 0:o.call(r,...s)},onContentError:(...s)=>{var r,o;return(o=(r=this.options.current).onContentError)===null||o===void 0?void 0:o.call(r,...s)},onDrop:(...s)=>{var r,o;return(o=(r=this.options.current).onDrop)===null||o===void 0?void 0:o.call(r,...s)},onPaste:(...s)=>{var r,o;return(o=(r=this.options.current).onPaste)===null||o===void 0?void 0:o.call(r,...s)}};return new ii(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(s=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(s)?!0:s==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((r,o)=>{var i;return r===((i=n.extensions)===null||i===void 0?void 0:i[o])}):e[s]===n[s])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?Ae.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((s,r)=>s===e[r]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function wc(t={},e=[]){const n=j.useRef(t);n.current=t;const[s]=j.useState(()=>new Ae(n)),r=Ce.useSyncExternalStore(s.subscribe,s.getEditor,s.getServerSnapshot);return j.useDebugValue(r),j.useEffect(s.onRender(e)),Ti({editor:r,selector:({transactionNumber:o})=>t.shouldRerenderOnTransaction===!1?null:t.immediatelyRender&&o===0?0:o+1}),r}const Vn=j.createContext({editor:null});Vn.Consumer;const Kn=()=>j.useContext(Vn),Mc=t=>{const[e,n]=j.useState(null),{editor:s}=Kn();return j.useEffect(()=>{var r;if(!e||!((r=t.editor)===null||r===void 0)&&r.isDestroyed||s?.isDestroyed)return;const{pluginKey:o="bubbleMenu",editor:i,tippyOptions:a={},updateDelay:l,shouldShow:c=null}=t,d=i||s;if(!d){console.warn("BubbleMenu component is not rendered inside of an editor component or does not have editor prop.");return}const u=Fn({updateDelay:l,editor:d,element:e,pluginKey:o,shouldShow:c,tippyOptions:a});return d.registerPlugin(u),()=>{d.unregisterPlugin(o)}},[t.editor,s,e]),V.createElement("div",{ref:n,className:t.className,style:{visibility:"hidden"}},t.children)},Ec=t=>{const[e,n]=j.useState(null),{editor:s}=Kn();return j.useEffect(()=>{var r;if(!e||!((r=t.editor)===null||r===void 0)&&r.isDestroyed||s?.isDestroyed)return;const{pluginKey:o="floatingMenu",editor:i,tippyOptions:a={},shouldShow:l=null}=t,c=i||s;if(!c){console.warn("FloatingMenu component is not rendered inside of an editor component or does not have editor prop.");return}const d=zn({pluginKey:o,editor:c,element:e,tippyOptions:a,shouldShow:l});return c.registerPlugin(d),()=>{c.unregisterPlugin(o)}},[t.editor,s,e]),V.createElement("div",{ref:n,className:t.className,style:{visibility:"hidden"}},t.children)},qn=j.createContext({onDragStart:void 0}),Gn=()=>j.useContext(qn),kc=t=>{const e=t.as||"div",{nodeViewContentRef:n}=Gn();return V.createElement(e,{...t,ref:n,"data-node-view-content":"",style:{whiteSpace:"pre-wrap",...t.style}})},Sc=V.forwardRef((t,e)=>{const{onDragStart:n}=Gn(),s=t.as||"div";return V.createElement(s,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});function tn(t){return!!(typeof t=="function"&&t.prototype&&t.prototype.isReactComponent)}function en(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.forward_ref)"||t.$$typeof.description==="react.forward_ref"))}function Oi(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.memo)"||t.$$typeof.description==="react.memo"))}function Li(t){if(tn(t)||en(t))return!0;if(Oi(t)){const e=t.type;if(e)return tn(e)||en(e)}return!1}function Pi(){try{if(j.version)return parseInt(j.version.split(".")[0],10)>=19}catch{}return!1}class _i{constructor(e,{editor:n,props:s={},as:r="div",className:o=""}){this.ref=null,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=e,this.editor=n,this.props=s,this.element=document.createElement(r),this.element.classList.add("react-renderer"),o&&this.element.classList.add(...o.split(" ")),this.editor.isInitialized?ws.flushSync(()=>{this.render()}):queueMicrotask(()=>{this.render()})}render(){var e;const n=this.component,s=this.props,r=this.editor,o=Pi(),i=Li(n),a={...s};a.ref&&!(o||i)&&delete a.ref,!a.ref&&(o||i)&&(a.ref=l=>{this.ref=l}),this.reactElement=V.createElement(n,{...a}),(e=r?.contentComponent)===null||e===void 0||e.setRenderer(this.id,this)}updateProps(e={}){this.props={...this.props,...e},this.render()}destroy(){var e;const n=this.editor;(e=n?.contentComponent)===null||e===void 0||e.removeRenderer(this.id)}updateAttributes(e){Object.keys(e).forEach(n=>{this.element.setAttribute(n,e[n])})}}class Ri extends ai{constructor(e,n,s){if(super(e,n,s),!this.node.isLeaf){this.options.contentDOMElementTag?this.contentDOMElement=document.createElement(this.options.contentDOMElementTag):this.contentDOMElement=document.createElement(this.node.isInline?"span":"div"),this.contentDOMElement.dataset.nodeViewContentReact="",this.contentDOMElement.dataset.nodeViewWrapper="",this.contentDOMElement.style.whiteSpace="inherit";const r=this.dom.querySelector("[data-node-view-content]");if(!r)return;r.appendChild(this.contentDOMElement)}}mount(){const e={editor:this.editor,node:this.node,decorations:this.decorations,innerDecorations:this.innerDecorations,view:this.view,selected:!1,extension:this.extension,HTMLAttributes:this.HTMLAttributes,getPos:()=>this.getPos(),updateAttributes:(c={})=>this.updateAttributes(c),deleteNode:()=>this.deleteNode(),ref:j.createRef()};if(!this.component.displayName){const c=d=>d.charAt(0).toUpperCase()+d.substring(1);this.component.displayName=c(this.extension.name)}const r={onDragStart:this.onDragStart.bind(this),nodeViewContentRef:c=>{c&&this.contentDOMElement&&c.firstChild!==this.contentDOMElement&&(c.hasAttribute("data-node-view-wrapper")&&c.removeAttribute("data-node-view-wrapper"),c.appendChild(this.contentDOMElement))}},o=this.component,i=j.memo(c=>V.createElement(qn.Provider,{value:r},j.createElement(o,c)));i.displayName="ReactNodeView";let a=this.node.isInline?"span":"div";this.options.as&&(a=this.options.as);const{className:l=""}=this.options;this.handleSelectionUpdate=this.handleSelectionUpdate.bind(this),this.renderer=new _i(i,{editor:this.editor,props:e,as:a,className:`node-${this.node.type.name} ${l}`.trim()}),this.editor.on("selectionUpdate",this.handleSelectionUpdate),this.updateElementAttributes()}get dom(){var e;if(this.renderer.element.firstElementChild&&!(!((e=this.renderer.element.firstElementChild)===null||e===void 0)&&e.hasAttribute("data-node-view-wrapper")))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.contentDOMElement}handleSelectionUpdate(){const{from:e,to:n}=this.editor.state.selection,s=this.getPos();if(typeof s=="number")if(e<=s&&n>=s+this.node.nodeSize){if(this.renderer.props.selected)return;this.selectNode()}else{if(!this.renderer.props.selected)return;this.deselectNode()}}update(e,n,s){const r=o=>{this.renderer.updateProps(o),typeof this.options.attrs=="function"&&this.updateElementAttributes()};if(e.type!==this.node.type)return!1;if(typeof this.options.update=="function"){const o=this.node,i=this.decorations,a=this.innerDecorations;return this.node=e,this.decorations=n,this.innerDecorations=s,this.options.update({oldNode:o,oldDecorations:i,newNode:e,newDecorations:n,oldInnerDecorations:a,innerDecorations:s,updateProps:()=>r({node:e,decorations:n,innerDecorations:s})})}return e===this.node&&this.decorations===n&&this.innerDecorations===s||(this.node=e,this.decorations=n,this.innerDecorations=s,r({node:e,decorations:n,innerDecorations:s})),!0}selectNode(){this.renderer.updateProps({selected:!0}),this.renderer.element.classList.add("ProseMirror-selectednode")}deselectNode(){this.renderer.updateProps({selected:!1}),this.renderer.element.classList.remove("ProseMirror-selectednode")}destroy(){this.renderer.destroy(),this.editor.off("selectionUpdate",this.handleSelectionUpdate),this.contentDOMElement=null}updateElementAttributes(){if(this.options.attrs){let e={};if(typeof this.options.attrs=="function"){const n=this.editor.extensionManager.attributes,s=Wt(this.node,n);e=this.options.attrs({node:this.node,HTMLAttributes:s})}else e=this.options.attrs;this.renderer.updateAttributes(e)}}}function xc(t,e){return n=>n.editor.contentComponent?new Ri(t,n,e):{}}const Ni=t=>{if(!t.children.length)return;const e=t.querySelectorAll("span");e&&e.forEach(n=>{var s,r;const o=n.getAttribute("style"),i=(r=(s=n.parentElement)===null||s===void 0?void 0:s.closest("span"))===null||r===void 0?void 0:r.getAttribute("style");n.setAttribute("style",`${i};${o}`)})},Tc=nt.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!1}},parseHTML(){return[{tag:"span",getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&Ni(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",$(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({tr:t})=>{const{selection:e}=t;return t.doc.nodesBetween(e.from,e.to,(n,s)=>{if(n.isTextblock)return!0;n.marks.filter(r=>r.type===this.type).some(r=>Object.values(r.attrs).some(o=>!!o))||t.removeMark(s,s+n.nodeSize,this.type)}),!0}}}}),Cc=z.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var e;return(e=t.style.color)===null||e===void 0?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:e})=>e().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),Ii=U.create({name:"doc",topNode:!0,content:"block+"}),Oe="[\0-   ᠎ -\u2029 　]",$i=new RegExp(Oe),Hi=new RegExp(`${Oe}$`),Di=new RegExp(Oe,"g");function Bi(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function ji(t){return new q({key:new J("autolink"),appendTransaction:(e,n,s)=>{const r=e.some(c=>c.docChanged)&&!n.doc.eq(s.doc),o=e.some(c=>c.getMeta("preventAutolink"));if(!r||o)return;const{tr:i}=s,a=Eo(n.doc,[...e]);if(Ao(a).forEach(({newRange:c})=>{const d=So(s.doc,c,h=>h.isTextblock);let u,p;if(d.length>1)u=d[0],p=s.doc.textBetween(u.pos,u.pos+u.node.nodeSize,void 0," ");else if(d.length){const h=s.doc.textBetween(c.from,c.to," "," ");if(!Hi.test(h))return;u=d[0],p=s.doc.textBetween(u.pos,c.to,void 0," ")}if(u&&p){const h=p.split($i).filter(Boolean);if(h.length<=0)return!1;const y=h[h.length-1],m=u.pos+p.lastIndexOf(y);if(!y)return!1;const f=Es(y).map(g=>g.toObject(t.defaultProtocol));if(!Bi(f))return!1;f.filter(g=>g.isLink).map(g=>({...g,from:m+g.start+1,to:m+g.end+1})).filter(g=>s.schema.marks.code?!s.doc.rangeHasMark(g.from,g.to,s.schema.marks.code):!0).filter(g=>t.validate(g.value)).filter(g=>t.shouldAutoLink(g.value)).forEach(g=>{Te(g.from,g.to,s.doc).some(x=>x.mark.type===t.type)||i.addMark(g.from,g.to,t.type.create({href:g.href}))})}}),!!i.steps.length)return i}})}function Fi(t){return new q({key:new J("handleClickLink"),props:{handleClick:(e,n,s)=>{var r,o;if(s.button!==0||!e.editable)return!1;let i=s.target;const a=[];for(;i.nodeName!=="DIV";)a.push(i),i=i.parentNode;if(!a.find(p=>p.nodeName==="A"))return!1;const l=Hn(e.state,t.type.name),c=s.target,d=(r=c?.href)!==null&&r!==void 0?r:l.href,u=(o=c?.target)!==null&&o!==void 0?o:l.target;return c&&d?(window.open(d,u),!0):!1}}})}function zi(t){return new q({key:new J("handlePasteLink"),props:{handlePaste:(e,n,s)=>{const{state:r}=e,{selection:o}=r,{empty:i}=o;if(i)return!1;let a="";s.content.forEach(c=>{a+=c.textContent});const l=wn(a,{defaultProtocol:t.defaultProtocol}).find(c=>c.isLink&&c.value===a);return!a||!l?!1:t.editor.commands.setMark(t.type,{href:l.href})}}})}function mt(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(s=>{const r=typeof s=="string"?s:s.scheme;r&&n.push(r)}),!t||t.replace(Di,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}const Ac=nt.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){Be(t);return}Be(t.scheme,t.optionalSlashes)})},onDestroy(){ks()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!mt(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!mt(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!mt(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",$(this.options.HTMLAttributes,t),0]:["a",$(this.options.HTMLAttributes,{...t,href:""}),0]},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:s=>!!mt(s,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:s=>!!mt(s,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run():!1},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[wt({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:s}=this.options,r=wn(t).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:i=>!!mt(i,n),protocols:n,defaultProtocol:s}));r.length&&r.forEach(o=>e.push({text:o.value,data:{href:o.href},index:o.start}))}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)===null||e===void 0?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(ji({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:s=>this.options.isAllowedUri(s,{defaultValidate:r=>!!mt(r,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&t.push(Fi({type:this.type})),this.options.linkOnPaste&&t.push(zi({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),t}}),Ui=U.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",$(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Wi=U.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",$(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Oc=z.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new q({key:new J("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:s}=e,r=[];if(!n)return null;const o=this.editor.isEmpty;return t.descendants((i,a)=>{const l=s>=a&&s<=a+i.nodeSize,c=!i.isLeaf&&Zt(i);if((l||!this.options.showOnlyCurrent)&&c){const d=[this.options.emptyNodeClass];o&&d.push(this.options.emptyEditorClass);const u=ye.node(a,a+i.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:i,pos:a,hasAnchor:l}):this.options.placeholder});r.push(u)}return this.options.includeChildren}),be.create(t,r)}}})]}}),Vi=U.create({name:"text",group:"inline"}),Ki=t=>F({find:/--$/,replace:t??"—"}),qi=t=>F({find:/\.\.\.$/,replace:t??"…"}),Gi=t=>F({find:/(?:^|[\s{[(<'"\u2018\u201C])(")$/,replace:t??"“"}),Qi=t=>F({find:/"$/,replace:t??"”"}),Ji=t=>F({find:/(?:^|[\s{[(<'"\u2018\u201C])(')$/,replace:t??"‘"}),Xi=t=>F({find:/'$/,replace:t??"’"}),Yi=t=>F({find:/<-$/,replace:t??"←"}),Zi=t=>F({find:/->$/,replace:t??"→"}),ta=t=>F({find:/\(c\)$/,replace:t??"©"}),ea=t=>F({find:/\(tm\)$/,replace:t??"™"}),na=t=>F({find:/\(sm\)$/,replace:t??"℠"}),sa=t=>F({find:/\(r\)$/,replace:t??"®"}),ra=t=>F({find:/(?:^|\s)(1\/2)\s$/,replace:t??"½"}),oa=t=>F({find:/\+\/-$/,replace:t??"±"}),ia=t=>F({find:/!=$/,replace:t??"≠"}),aa=t=>F({find:/<<$/,replace:t??"«"}),la=t=>F({find:/>>$/,replace:t??"»"}),ca=t=>F({find:/\d+\s?([*x])\s?\d+$/,replace:t??"×"}),ua=t=>F({find:/\^2$/,replace:t??"²"}),da=t=>F({find:/\^3$/,replace:t??"³"}),pa=t=>F({find:/(?:^|\s)(1\/4)\s$/,replace:t??"¼"}),ha=t=>F({find:/(?:^|\s)(3\/4)\s$/,replace:t??"¾"}),Lc=z.create({name:"typography",addOptions(){return{closeDoubleQuote:"”",closeSingleQuote:"’",copyright:"©",ellipsis:"…",emDash:"—",laquo:"«",leftArrow:"←",multiplication:"×",notEqual:"≠",oneHalf:"½",oneQuarter:"¼",openDoubleQuote:"“",openSingleQuote:"‘",plusMinus:"±",raquo:"»",registeredTrademark:"®",rightArrow:"→",servicemark:"℠",superscriptThree:"³",superscriptTwo:"²",threeQuarters:"¾",trademark:"™"}},addInputRules(){const t=[];return this.options.emDash!==!1&&t.push(Ki(this.options.emDash)),this.options.ellipsis!==!1&&t.push(qi(this.options.ellipsis)),this.options.openDoubleQuote!==!1&&t.push(Gi(this.options.openDoubleQuote)),this.options.closeDoubleQuote!==!1&&t.push(Qi(this.options.closeDoubleQuote)),this.options.openSingleQuote!==!1&&t.push(Ji(this.options.openSingleQuote)),this.options.closeSingleQuote!==!1&&t.push(Xi(this.options.closeSingleQuote)),this.options.leftArrow!==!1&&t.push(Yi(this.options.leftArrow)),this.options.rightArrow!==!1&&t.push(Zi(this.options.rightArrow)),this.options.copyright!==!1&&t.push(ta(this.options.copyright)),this.options.trademark!==!1&&t.push(ea(this.options.trademark)),this.options.servicemark!==!1&&t.push(na(this.options.servicemark)),this.options.registeredTrademark!==!1&&t.push(sa(this.options.registeredTrademark)),this.options.oneHalf!==!1&&t.push(ra(this.options.oneHalf)),this.options.plusMinus!==!1&&t.push(oa(this.options.plusMinus)),this.options.notEqual!==!1&&t.push(ia(this.options.notEqual)),this.options.laquo!==!1&&t.push(aa(this.options.laquo)),this.options.raquo!==!1&&t.push(la(this.options.raquo)),this.options.multiplication!==!1&&t.push(ca(this.options.multiplication)),this.options.superscriptTwo!==!1&&t.push(ua(this.options.superscriptTwo)),this.options.superscriptThree!==!1&&t.push(da(this.options.superscriptThree)),this.options.oneQuarter!==!1&&t.push(pa(this.options.oneQuarter)),this.options.threeQuarters!==!1&&t.push(ha(this.options.threeQuarters)),t}}),Pc=nt.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",$(this.options.HTMLAttributes,t),0]},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),fa=z.create({name:"gapCursor",addProseMirrorPlugins(){return[Ds()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=L(M(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),_c=z.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const e=t.style.textAlign;return this.options.alignments.includes(e)?e:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>({commands:e})=>this.options.alignments.includes(t)?this.options.types.map(n=>e.updateAttributes(n,{textAlign:t})).every(n=>n):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(e=>t.resetAttributes(e,"textAlign")).every(e=>e),toggleTextAlign:t=>({editor:e,commands:n})=>this.options.alignments.includes(t)?e.isActive({textAlign:t})?n.unsetTextAlign():n.setTextAlign(t):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});function ge(t,e){return e?["width",`${Math.max(e,t)}px`]:["min-width",`${t}px`]}function nn(t,e,n,s,r,o){var i;let a=0,l=!0,c=e.firstChild;const d=t.firstChild;if(d!==null)for(let u=0,p=0;u<d.childCount;u+=1){const{colspan:h,colwidth:y}=d.child(u).attrs;for(let m=0;m<h;m+=1,p+=1){const f=r===p?o:y&&y[m],g=f?`${f}px`:"";if(a+=f||s,f||(l=!1),c){if(c.style.width!==g){const[x,w]=ge(s,f);c.style.setProperty(x,w)}c=c.nextSibling}else{const x=document.createElement("col"),[w,k]=ge(s,f);x.style.setProperty(w,k),e.appendChild(x)}}}for(;c;){const u=c.nextSibling;(i=c.parentNode)===null||i===void 0||i.removeChild(c),c=u}l?(n.style.width=`${a}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${a}px`)}class ma{constructor(e,n){this.node=e,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),nn(e,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!==this.node.type?!1:(this.node=e,nn(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return e.type==="attributes"&&(e.target===this.table||this.colgroup.contains(e.target))}}function ga(t,e,n,s){let r=0,o=!0;const i=[],a=t.firstChild;if(!a)return{};for(let u=0,p=0;u<a.childCount;u+=1){const{colspan:h,colwidth:y}=a.child(u).attrs;for(let m=0;m<h;m+=1,p+=1){const f=n===p?s:y&&y[m];r+=f||e,f||(o=!1);const[g,x]=ge(e,f);i.push(["col",{style:`${g}: ${x}`}])}}const l=o?`${r}px`:"",c=o?"":`${r}px`;return{colgroup:["colgroup",{},...i],tableWidth:l,tableMinWidth:c}}function sn(t,e){return t.createAndFill()}function ya(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;const e={};return Object.keys(t.nodes).forEach(n=>{const s=t.nodes[n];s.spec.tableRole&&(e[s.spec.tableRole]=s)}),t.cached.tableNodeTypes=e,e}function ba(t,e,n,s,r){const o=ya(t),i=[],a=[];for(let c=0;c<n;c+=1){const d=sn(o.cell);if(d&&a.push(d),s){const u=sn(o.header_cell);u&&i.push(u)}}const l=[];for(let c=0;c<e;c+=1)l.push(o.row.createChecked(null,s&&c===0?i:a));return o.table.createChecked(null,l)}function va(t){return t instanceof Mn}const jt=({editor:t})=>{const{selection:e}=t.state;if(!va(e))return!1;let n=0;const s=In(e.ranges[0].$from,o=>o.type.name==="table");return s?.node.descendants(o=>{if(o.type.name==="table")return!1;["tableCell","tableHeader"].includes(o.type.name)&&(n+=1)}),n===e.ranges.length?(t.commands.deleteTable(),!0):!1},Rc=U.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,renderWrapper:!1,handleWidth:5,cellMinWidth:25,View:ma,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:t,HTMLAttributes:e}){const{colgroup:n,tableWidth:s,tableMinWidth:r}=ga(t,this.options.cellMinWidth),o=["table",$(this.options.HTMLAttributes,e,{style:s?`width: ${s}`:`min-width: ${r}`}),n,["tbody",0]];return this.options.renderWrapper?["div",{class:"tableWrapper"},o]:o},addCommands(){return{insertTable:({rows:t=3,cols:e=3,withHeaderRow:n=!0}={})=>({tr:s,dispatch:r,editor:o})=>{const i=ba(o.schema,t,e,n);if(r){const a=s.selection.from+1;s.replaceSelectionWith(i).scrollIntoView().setSelection(Y.near(s.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:t,dispatch:e})=>$s(t,e),addColumnAfter:()=>({state:t,dispatch:e})=>Is(t,e),deleteColumn:()=>({state:t,dispatch:e})=>Ns(t,e),addRowBefore:()=>({state:t,dispatch:e})=>Rs(t,e),addRowAfter:()=>({state:t,dispatch:e})=>_s(t,e),deleteRow:()=>({state:t,dispatch:e})=>Ps(t,e),deleteTable:()=>({state:t,dispatch:e})=>Ls(t,e),mergeCells:()=>({state:t,dispatch:e})=>Fe(t,e),splitCell:()=>({state:t,dispatch:e})=>ze(t,e),toggleHeaderColumn:()=>({state:t,dispatch:e})=>Ue("column")(t,e),toggleHeaderRow:()=>({state:t,dispatch:e})=>Ue("row")(t,e),toggleHeaderCell:()=>({state:t,dispatch:e})=>Os(t,e),mergeOrSplit:()=>({state:t,dispatch:e})=>Fe(t,e)?!0:ze(t,e),setCellAttribute:(t,e)=>({state:n,dispatch:s})=>As(t,e)(n,s),goToNextCell:()=>({state:t,dispatch:e})=>je(1)(t,e),goToPreviousCell:()=>({state:t,dispatch:e})=>je(-1)(t,e),fixTables:()=>({state:t,dispatch:e})=>(e&&Cs(t),!0),setCellSelection:t=>({tr:e,dispatch:n})=>{if(n){const s=Mn.create(e.doc,t.anchorCell,t.headCell);e.setSelection(s)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:jt,"Mod-Backspace":jt,Delete:jt,"Mod-Delete":jt}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[xs({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],Ts({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(t){const e={name:t.name,options:t.options,storage:t.storage};return{tableRole:L(M(t,"tableRole",e))}}}),Nc=U.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?e.split(",").map(s=>parseInt(s,10)):null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:t}){return["td",$(this.options.HTMLAttributes,t),0]}}),Ic=U.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?e.split(",").map(s=>parseInt(s,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:t}){return["th",$(this.options.HTMLAttributes,t),0]}}),$c=U.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:t}){return["tr",$(this.options.HTMLAttributes,t),0]}}),wa=/^((?:https?:)?\/\/)?((?:www|m|music)\.)?((?:youtube\.com|youtu\.be|youtube-nocookie\.com))(\/(?:[\w-]+\?v=|embed\/|v\/)?)([\w-]+)(\S+)?$/,Ma=/^((?:https?:)?\/\/)?((?:www|m|music)\.)?((?:youtube\.com|youtu\.be|youtube-nocookie\.com))(\/(?:[\w-]+\?v=|embed\/|v\/)?)([\w-]+)(\S+)?$/g,Qn=t=>t.match(wa),Ea=(t,e)=>e?"https://www.youtube-nocookie.com/embed/videoseries?list=":t?"https://www.youtube-nocookie.com/embed/":"https://www.youtube.com/embed/",ka=t=>t.searchParams.has("v")?{id:t.searchParams.get("v")}:t.hostname==="youtu.be"||t.pathname.includes("shorts")||t.pathname.includes("live")?{id:t.pathname.split("/").pop()}:t.searchParams.has("list")?{id:t.searchParams.get("list"),isPlaylist:!0}:null,Sa=t=>{var e;const{url:n,allowFullscreen:s,autoplay:r,ccLanguage:o,ccLoadPolicy:i,controls:a,disableKBcontrols:l,enableIFrameApi:c,endTime:d,interfaceLanguage:u,ivLoadPolicy:p,loop:h,modestBranding:y,nocookie:m,origin:f,playlist:g,progressBarColor:x,startAt:w,rel:k}=t;if(!Qn(n))return null;if(n.includes("/embed/"))return n;const C=new URL(n),{id:T,isPlaylist:R}=(e=ka(C))!==null&&e!==void 0?e:{};if(!T)return null;const A=new URL(`${Ea(m,R)}${T}`);return C.searchParams.has("t")&&A.searchParams.set("start",C.searchParams.get("t").replaceAll("s","")),s===!1&&A.searchParams.set("fs","0"),r&&A.searchParams.set("autoplay","1"),o&&A.searchParams.set("cc_lang_pref",o),i&&A.searchParams.set("cc_load_policy","1"),a||A.searchParams.set("controls","0"),l&&A.searchParams.set("disablekb","1"),c&&A.searchParams.set("enablejsapi","1"),d&&A.searchParams.set("end",d.toString()),u&&A.searchParams.set("hl",u),p&&A.searchParams.set("iv_load_policy",p.toString()),h&&A.searchParams.set("loop","1"),y&&A.searchParams.set("modestbranding","1"),f&&A.searchParams.set("origin",f),g&&A.searchParams.set("playlist",g),w&&A.searchParams.set("start",w.toString()),x&&A.searchParams.set("color",x),k!==void 0&&A.searchParams.set("rel",k.toString()),A.toString()},Hc=U.create({name:"youtube",addOptions(){return{addPasteHandler:!0,allowFullscreen:!0,autoplay:!1,ccLanguage:void 0,ccLoadPolicy:void 0,controls:!0,disableKBcontrols:!1,enableIFrameApi:!1,endTime:0,height:480,interfaceLanguage:void 0,ivLoadPolicy:0,loop:!1,modestBranding:!1,HTMLAttributes:{},inline:!1,nocookie:!1,origin:"",playlist:"",progressBarColor:void 0,width:640,rel:1}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},start:{default:0},width:{default:this.options.width},height:{default:this.options.height}}},parseHTML(){return[{tag:"div[data-youtube-video] iframe"}]},addCommands(){return{setYoutubeVideo:t=>({commands:e})=>Qn(t.src)?e.insertContent({type:this.name,attrs:t}):!1}},addPasteRules(){return this.options.addPasteHandler?[ui({find:Ma,type:this.type,getAttributes:t=>({src:t.input})})]:[]},renderHTML({HTMLAttributes:t}){const e=Sa({url:t.src,allowFullscreen:this.options.allowFullscreen,autoplay:this.options.autoplay,ccLanguage:this.options.ccLanguage,ccLoadPolicy:this.options.ccLoadPolicy,controls:this.options.controls,disableKBcontrols:this.options.disableKBcontrols,enableIFrameApi:this.options.enableIFrameApi,endTime:this.options.endTime,interfaceLanguage:this.options.interfaceLanguage,ivLoadPolicy:this.options.ivLoadPolicy,loop:this.options.loop,modestBranding:this.options.modestBranding,nocookie:this.options.nocookie,origin:this.options.origin,playlist:this.options.playlist,progressBarColor:this.options.progressBarColor,startAt:t.start||0,rel:this.options.rel});return t.src=e,["div",{"data-youtube-video":""},["iframe",$(this.options.HTMLAttributes,{width:this.options.width,height:this.options.height,allowfullscreen:this.options.allowFullscreen,autoplay:this.options.autoplay,ccLanguage:this.options.ccLanguage,ccLoadPolicy:this.options.ccLoadPolicy,disableKBcontrols:this.options.disableKBcontrols,enableIFrameApi:this.options.enableIFrameApi,endTime:this.options.endTime,interfaceLanguage:this.options.interfaceLanguage,ivLoadPolicy:this.options.ivLoadPolicy,loop:this.options.loop,modestBranding:this.options.modestBranding,origin:this.options.origin,playlist:this.options.playlist,progressBarColor:this.options.progressBarColor,rel:this.options.rel},t)]]}}),xa=/(^|[^`])`([^`]+)`(?!`)/,Ta=/(^|[^`])`([^`]+)`(?!`)/g,Ca=nt.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",$(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[xt({find:xa,type:this.type})]},addPasteRules(){return[wt({find:Ta,type:this.type})]}}),Aa=/^\s*>\s$/,Oa=U.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",$(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Ot({find:Aa,type:this.type})]}}),La=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Pa=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,_a=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Ra=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Na=nt.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",$(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[xt({find:La,type:this.type}),xt({find:_a,type:this.type})]},addPasteRules(){return[wt({find:Pa,type:this.type}),wt({find:Ra,type:this.type})]}}),Ia="listItem",rn="textStyle",on=/^\s*([-+*])\s$/,$a=U.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",$(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Ia,this.editor.getAttributes(rn)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Ot({find:on,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Ot({find:on,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(rn),editor:this.editor})),[t]}}),Ha=/^```([a-z]+)?[\s\n]$/,Da=/^~~~([a-z]+)?[\s\n]$/,Jn=U.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,o=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(i=>i.startsWith(n)).map(i=>i.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",$(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:s,empty:r}=n;if(!r||s.parent.type!==this.type)return!1;const o=s.parentOffset===s.parent.nodeSize-2,i=s.parent.textContent.endsWith(`

`);return!o||!i?!1:t.chain().command(({tr:a})=>(a.delete(s.pos-2,s.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:s}=e,{$from:r,empty:o}=n;if(!o||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;const a=r.after();return a===void 0?!1:s.nodeAt(a)?t.commands.command(({tr:c})=>(c.setSelection(yt.near(s.resolve(a))),!0)):t.commands.exitCode()}}},addInputRules(){return[fe({find:Ha,type:this.type,getAttributes:t=>({language:t[1]})}),fe({find:Da,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new q({key:new J("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),s=e.clipboardData.getData("vscode-editor-data"),r=s?JSON.parse(s):void 0,o=r?.mode;if(!n||!o)return!1;const{tr:i,schema:a}=t.state,l=a.text(n.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:o},l)),i.selection.$from.parent.type!==this.type&&i.setSelection(Y.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),t.dispatch(i),!0}}})]}}),Ba=z.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Hs(this.options)]}}),ja=U.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",$(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:s})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:r,storedMarks:o}=n;if(r.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:a}=s.extensionManager,l=o||r.$to.parentOffset&&r.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:d})=>{if(d&&l&&i){const u=l.filter(p=>a.includes(p.type.name));c.ensureMarks(u)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Fa=U.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,$(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>fe({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),za=z.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>Fs(t,e),redo:()=>({state:t,dispatch:e})=>js(t,e)}},addProseMirrorPlugins(){return[Bs(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),Ua=U.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",$(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!li(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$from:s,$to:r}=n,o=t();return s.parentOffset===0?o.insertContentAt({from:Math.max(s.pos-1,0),to:r.pos},{type:this.name}):Dn(n)?o.insertContentAt(r.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:i,dispatch:a})=>{var l;if(a){const{$to:c}=i.selection,d=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?i.setSelection(Y.create(i.doc,c.pos+1)):c.nodeAfter.isBlock?i.setSelection(vt.create(i.doc,c.pos)):i.setSelection(Y.create(i.doc,c.pos));else{const u=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();u&&(i.insert(d,u),i.setSelection(Y.create(i.doc,d+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[jn({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),Wa=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Va=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Ka=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,qa=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Ga=nt.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",$(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[xt({find:Wa,type:this.type}),xt({find:Ka,type:this.type})]},addPasteRules(){return[wt({find:Va,type:this.type}),wt({find:qa,type:this.type})]}}),Qa="listItem",an="textStyle",ln=/^(\d+)\.\s$/,Ja=U.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",$(this.options.HTMLAttributes,n),0]:["ol",$(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Qa,this.editor.getAttributes(an)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Ot({find:ln,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Ot({find:ln,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(an)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),Xa=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Ya=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Za=nt.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",$(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[xt({find:Xa,type:this.type})]},addPasteRules(){return[wt({find:Ya,type:this.type})]}}),Dc=z.create({name:"starterKit",addExtensions(){const t=[];return this.options.bold!==!1&&t.push(Na.configure(this.options.bold)),this.options.blockquote!==!1&&t.push(Oa.configure(this.options.blockquote)),this.options.bulletList!==!1&&t.push($a.configure(this.options.bulletList)),this.options.code!==!1&&t.push(Ca.configure(this.options.code)),this.options.codeBlock!==!1&&t.push(Jn.configure(this.options.codeBlock)),this.options.document!==!1&&t.push(Ii.configure(this.options.document)),this.options.dropcursor!==!1&&t.push(Ba.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&t.push(fa.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&t.push(ja.configure(this.options.hardBreak)),this.options.heading!==!1&&t.push(Fa.configure(this.options.heading)),this.options.history!==!1&&t.push(za.configure(this.options.history)),this.options.horizontalRule!==!1&&t.push(Ua.configure(this.options.horizontalRule)),this.options.italic!==!1&&t.push(Ga.configure(this.options.italic)),this.options.listItem!==!1&&t.push(Ui.configure(this.options.listItem)),this.options.orderedList!==!1&&t.push(Ja.configure(this.options.orderedList)),this.options.paragraph!==!1&&t.push(Wi.configure(this.options.paragraph)),this.options.strike!==!1&&t.push(Za.configure(this.options.strike)),this.options.text!==!1&&t.push(Vi.configure(this.options.text)),t}}),tl=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Bc=U.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",$(this.options.HTMLAttributes,t)]},addCommands(){return{setImage:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addInputRules(){return[jn({find:tl,type:this.type,getAttributes:t=>{const[,,e,n,s]=t;return{src:n,alt:e,title:s}}})]}});function el(t){var e;const{char:n,allowSpaces:s,allowToIncludeChar:r,allowedPrefixes:o,startOfLine:i,$position:a}=t,l=s&&!r,c=ci(n),d=new RegExp(`\\s${c}$`),u=i?"^":"",p=r?"":c,h=l?new RegExp(`${u}${c}.*?(?=\\s${p}|$)`,"gm"):new RegExp(`${u}(?:^)?${c}[^\\s${p}]*`,"gm"),y=((e=a.nodeBefore)===null||e===void 0?void 0:e.isText)&&a.nodeBefore.text;if(!y)return null;const m=a.pos-y.length,f=Array.from(y.matchAll(h)).pop();if(!f||f.input===void 0||f.index===void 0)return null;const g=f.input.slice(Math.max(0,f.index-1),f.index),x=new RegExp(`^[${o?.join("")}\0]?$`).test(g);if(o!==null&&!x)return null;const w=m+f.index;let k=w+f[0].length;return l&&d.test(y.slice(k-1,k+1))&&(f[0]+=" ",k+=1),w<a.pos&&k>=a.pos?{range:{from:w,to:k},query:f[0].slice(n.length),text:f[0]}:null}const nl=new J("suggestion");function sl({pluginKey:t=nl,editor:e,char:n="@",allowSpaces:s=!1,allowToIncludeChar:r=!1,allowedPrefixes:o=[" "],startOfLine:i=!1,decorationTag:a="span",decorationClass:l="suggestion",decorationContent:c="",decorationEmptyClass:d="is-empty",command:u=()=>null,items:p=()=>[],render:h=()=>({}),allow:y=()=>!0,findSuggestionMatch:m=el}){let f;const g=h?.(),x=new q({key:t,view(){return{update:async(w,k)=>{var C,T,R,A,W,lt,ot;const B=(C=this.key)===null||C===void 0?void 0:C.getState(k),Z=(T=this.key)===null||T===void 0?void 0:T.getState(w.state),pt=B.active&&Z.active&&B.range.from!==Z.range.from,ht=!B.active&&Z.active,Rt=B.active&&!Z.active,b=!ht&&!Rt&&B.query!==Z.query,E=ht||pt&&b,P=b||pt,N=Rt||pt&&b;if(!E&&!P&&!N)return;const H=N&&!E?B:Z,tt=w.dom.querySelector(`[data-decoration-id="${H.decorationId}"]`);f={editor:e,range:H.range,query:H.query,text:H.text,items:[],command:et=>u({editor:e,range:H.range,props:et}),decorationNode:tt,clientRect:tt?()=>{var et;const{decorationId:Et}=(et=this.key)===null||et===void 0?void 0:et.getState(e.state),G=w.dom.querySelector(`[data-decoration-id="${Et}"]`);return G?.getBoundingClientRect()||null}:null},E&&((R=g?.onBeforeStart)===null||R===void 0||R.call(g,f)),P&&((A=g?.onBeforeUpdate)===null||A===void 0||A.call(g,f)),(P||E)&&(f.items=await p({editor:e,query:H.query})),N&&((W=g?.onExit)===null||W===void 0||W.call(g,f)),P&&((lt=g?.onUpdate)===null||lt===void 0||lt.call(g,f)),E&&((ot=g?.onStart)===null||ot===void 0||ot.call(g,f))},destroy:()=>{var w;f&&((w=g?.onExit)===null||w===void 0||w.call(g,f))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(w,k,C,T){const{isEditable:R}=e,{composing:A}=e.view,{selection:W}=w,{empty:lt,from:ot}=W,B={...k};if(B.composing=A,R&&(lt||e.view.composing)){(ot<k.range.from||ot>k.range.to)&&!A&&!k.composing&&(B.active=!1);const Z=m({char:n,allowSpaces:s,allowToIncludeChar:r,allowedPrefixes:o,startOfLine:i,$position:W.$from}),pt=`id_${Math.floor(Math.random()*4294967295)}`;Z&&y({editor:e,state:T,range:Z.range,isActive:k.active})?(B.active=!0,B.decorationId=k.decorationId?k.decorationId:pt,B.range=Z.range,B.query=Z.query,B.text=Z.text):B.active=!1}else B.active=!1;return B.active||(B.decorationId=null,B.range={from:0,to:0},B.query=null,B.text=null),B}},props:{handleKeyDown(w,k){var C;const{active:T,range:R}=x.getState(w.state);return T&&((C=g?.onKeyDown)===null||C===void 0?void 0:C.call(g,{view:w,event:k,range:R}))||!1},decorations(w){const{active:k,range:C,decorationId:T,query:R}=x.getState(w);if(!k)return null;const A=!R?.length,W=[l];return A&&W.push(d),be.create(w.doc,[ye.inline(C.from,C.to,{nodeName:a,class:W.join(" "),"data-decoration-id":T,"data-decoration-content":c})])}}});return x}function rl({editor:t,overrideSuggestionOptions:e,extensionName:n,char:s="@"}){const r=new J;return{editor:t,char:s,pluginKey:r,command:({editor:o,range:i,props:a})=>{var l,c,d;const u=o.view.state.selection.$to.nodeAfter;((l=u?.text)===null||l===void 0?void 0:l.startsWith(" "))&&(i.to+=1),o.chain().focus().insertContentAt(i,[{type:n,attrs:{...a,mentionSuggestionChar:s}},{type:"text",text:" "}]).run(),(d=(c=o.view.dom.ownerDocument.defaultView)===null||c===void 0?void 0:c.getSelection())===null||d===void 0||d.collapseToEnd()},allow:({state:o,range:i})=>{const a=o.doc.resolve(i.from),l=o.schema.nodes[n];return!!a.parent.type.contentMatch.matchType(l)},...e}}function Xn(t){return(t.options.suggestions.length?t.options.suggestions:[t.options.suggestion]).map(e=>rl({editor:t.editor,overrideSuggestionOptions:e,extensionName:t.name,char:e.char}))}function cn(t,e){const n=Xn(t),s=n.find(r=>r.char===e);return s||(n.length?n[0]:null)}const jc=U.create({name:"mention",priority:101,addOptions(){return{HTMLAttributes:{},renderText({node:t,suggestion:e}){var n,s;return`${(n=e?.char)!==null&&n!==void 0?n:"@"}${(s=t.attrs.label)!==null&&s!==void 0?s:t.attrs.id}`},deleteTriggerWithBackspace:!1,renderHTML({options:t,node:e,suggestion:n}){var s,r;return["span",$(this.HTMLAttributes,t.HTMLAttributes),`${(s=n?.char)!==null&&s!==void 0?s:"@"}${(r=e.attrs.label)!==null&&r!==void 0?r:e.attrs.id}`]},suggestions:[],suggestion:{}}},group:"inline",inline:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:t=>t.getAttribute("data-id"),renderHTML:t=>t.id?{"data-id":t.id}:{}},label:{default:null,parseHTML:t=>t.getAttribute("data-label"),renderHTML:t=>t.label?{"data-label":t.label}:{}},mentionSuggestionChar:{default:"@",parseHTML:t=>t.getAttribute("data-mention-suggestion-char"),renderHTML:t=>({"data-mention-suggestion-char":t.mentionSuggestionChar})}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:t,HTMLAttributes:e}){const n=cn(this,t.attrs.mentionSuggestionChar);if(this.options.renderLabel!==void 0)return console.warn("renderLabel is deprecated use renderText and renderHTML instead"),["span",$({"data-type":this.name},this.options.HTMLAttributes,e),this.options.renderLabel({options:this.options,node:t,suggestion:n})];const s={...this.options};s.HTMLAttributes=$({"data-type":this.name},this.options.HTMLAttributes,e);const r=this.options.renderHTML({options:s,node:t,suggestion:n});return typeof r=="string"?["span",$({"data-type":this.name},this.options.HTMLAttributes,e),r]:r},renderText({node:t}){const e={options:this.options,node:t,suggestion:cn(this,t.attrs.mentionSuggestionChar)};return this.options.renderLabel!==void 0?(console.warn("renderLabel is deprecated use renderText and renderHTML instead"),this.options.renderLabel(e)):this.options.renderText(e)},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:t,state:e})=>{let n=!1;const{selection:s}=e,{empty:r,anchor:o}=s;if(!r)return!1;e.doc.nodesBetween(o-1,o,(l,c)=>{if(l.type.name===this.name)return n=!0,t.insertText(this.options.deleteTriggerWithBackspace?"":this.options.suggestion.char||"",c,c+l.nodeSize),!1});let i=new kn,a=0;return e.doc.nodesBetween(o-1,o,(l,c)=>{if(l.type.name===this.name)return n=!0,i=l,a=c,!1}),n&&t.insertText(this.options.deleteTriggerWithBackspace?"":i.attrs.mentionSuggestionChar,a,a+i.nodeSize),n})}},addProseMirrorPlugins(){return Xn(this).map(sl)}});function ol(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Yn(t){return t instanceof Map?t.clear=t.delete=t.set=function(){throw new Error("map is read-only")}:t instanceof Set&&(t.add=t.clear=t.delete=function(){throw new Error("set is read-only")}),Object.freeze(t),Object.getOwnPropertyNames(t).forEach(e=>{const n=t[e],s=typeof n;(s==="object"||s==="function")&&!Object.isFrozen(n)&&Yn(n)}),t}class un{constructor(e){e.data===void 0&&(e.data={}),this.data=e.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function Zn(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function ct(t,...e){const n=Object.create(null);for(const s in t)n[s]=t[s];return e.forEach(function(s){for(const r in s)n[r]=s[r]}),n}const il="</span>",dn=t=>!!t.scope,al=(t,{prefix:e})=>{if(t.startsWith("language:"))return t.replace("language:","language-");if(t.includes(".")){const n=t.split(".");return[`${e}${n.shift()}`,...n.map((s,r)=>`${s}${"_".repeat(r+1)}`)].join(" ")}return`${e}${t}`};class ll{constructor(e,n){this.buffer="",this.classPrefix=n.classPrefix,e.walk(this)}addText(e){this.buffer+=Zn(e)}openNode(e){if(!dn(e))return;const n=al(e.scope,{prefix:this.classPrefix});this.span(n)}closeNode(e){dn(e)&&(this.buffer+=il)}value(){return this.buffer}span(e){this.buffer+=`<span class="${e}">`}}const pn=(t={})=>{const e={children:[]};return Object.assign(e,t),e};class Le{constructor(){this.rootNode=pn(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(e){this.top.children.push(e)}openNode(e){const n=pn({scope:e});this.add(n),this.stack.push(n)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(e){return this.constructor._walk(e,this.rootNode)}static _walk(e,n){return typeof n=="string"?e.addText(n):n.children&&(e.openNode(n),n.children.forEach(s=>this._walk(e,s)),e.closeNode(n)),e}static _collapse(e){typeof e!="string"&&e.children&&(e.children.every(n=>typeof n=="string")?e.children=[e.children.join("")]:e.children.forEach(n=>{Le._collapse(n)}))}}class cl extends Le{constructor(e){super(),this.options=e}addText(e){e!==""&&this.add(e)}startScope(e){this.openNode(e)}endScope(){this.closeNode()}__addSublanguage(e,n){const s=e.root;n&&(s.scope=`language:${n}`),this.add(s)}toHTML(){return new ll(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function Lt(t){return t?typeof t=="string"?t:t.source:null}function ts(t){return Mt("(?=",t,")")}function ul(t){return Mt("(?:",t,")*")}function dl(t){return Mt("(?:",t,")?")}function Mt(...t){return t.map(n=>Lt(n)).join("")}function pl(t){const e=t[t.length-1];return typeof e=="object"&&e.constructor===Object?(t.splice(t.length-1,1),e):{}}function Pe(...t){return"("+(pl(t).capture?"":"?:")+t.map(s=>Lt(s)).join("|")+")"}function es(t){return new RegExp(t.toString()+"|").exec("").length-1}function hl(t,e){const n=t&&t.exec(e);return n&&n.index===0}const fl=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function _e(t,{joinWith:e}){let n=0;return t.map(s=>{n+=1;const r=n;let o=Lt(s),i="";for(;o.length>0;){const a=fl.exec(o);if(!a){i+=o;break}i+=o.substring(0,a.index),o=o.substring(a.index+a[0].length),a[0][0]==="\\"&&a[1]?i+="\\"+String(Number(a[1])+r):(i+=a[0],a[0]==="("&&n++)}return i}).map(s=>`(${s})`).join(e)}const ml=/\b\B/,ns="[a-zA-Z]\\w*",Re="[a-zA-Z_]\\w*",ss="\\b\\d+(\\.\\d+)?",rs="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",os="\\b(0b[01]+)",gl="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",yl=(t={})=>{const e=/^#![ ]*\//;return t.binary&&(t.begin=Mt(e,/.*\b/,t.binary,/\b.*/)),ct({scope:"meta",begin:e,end:/$/,relevance:0,"on:begin":(n,s)=>{n.index!==0&&s.ignoreMatch()}},t)},Pt={begin:"\\\\[\\s\\S]",relevance:0},bl={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[Pt]},vl={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[Pt]},wl={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},te=function(t,e,n={}){const s=ct({scope:"comment",begin:t,end:e,contains:[]},n);s.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const r=Pe("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return s.contains.push({begin:Mt(/[ ]+/,"(",r,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),s},Ml=te("//","$"),El=te("/\\*","\\*/"),kl=te("#","$"),Sl={scope:"number",begin:ss,relevance:0},xl={scope:"number",begin:rs,relevance:0},Tl={scope:"number",begin:os,relevance:0},Cl={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[Pt,{begin:/\[/,end:/\]/,relevance:0,contains:[Pt]}]},Al={scope:"title",begin:ns,relevance:0},Ol={scope:"title",begin:Re,relevance:0},Ll={begin:"\\.\\s*"+Re,relevance:0},Pl=function(t){return Object.assign(t,{"on:begin":(e,n)=>{n.data._beginMatch=e[1]},"on:end":(e,n)=>{n.data._beginMatch!==e[1]&&n.ignoreMatch()}})};var Ft=Object.freeze({__proto__:null,APOS_STRING_MODE:bl,BACKSLASH_ESCAPE:Pt,BINARY_NUMBER_MODE:Tl,BINARY_NUMBER_RE:os,COMMENT:te,C_BLOCK_COMMENT_MODE:El,C_LINE_COMMENT_MODE:Ml,C_NUMBER_MODE:xl,C_NUMBER_RE:rs,END_SAME_AS_BEGIN:Pl,HASH_COMMENT_MODE:kl,IDENT_RE:ns,MATCH_NOTHING_RE:ml,METHOD_GUARD:Ll,NUMBER_MODE:Sl,NUMBER_RE:ss,PHRASAL_WORDS_MODE:wl,QUOTE_STRING_MODE:vl,REGEXP_MODE:Cl,RE_STARTERS_RE:gl,SHEBANG:yl,TITLE_MODE:Al,UNDERSCORE_IDENT_RE:Re,UNDERSCORE_TITLE_MODE:Ol});function _l(t,e){t.input[t.index-1]==="."&&e.ignoreMatch()}function Rl(t,e){t.className!==void 0&&(t.scope=t.className,delete t.className)}function Nl(t,e){e&&t.beginKeywords&&(t.begin="\\b("+t.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",t.__beforeBegin=_l,t.keywords=t.keywords||t.beginKeywords,delete t.beginKeywords,t.relevance===void 0&&(t.relevance=0))}function Il(t,e){Array.isArray(t.illegal)&&(t.illegal=Pe(...t.illegal))}function $l(t,e){if(t.match){if(t.begin||t.end)throw new Error("begin & end are not supported with match");t.begin=t.match,delete t.match}}function Hl(t,e){t.relevance===void 0&&(t.relevance=1)}const Dl=(t,e)=>{if(!t.beforeMatch)return;if(t.starts)throw new Error("beforeMatch cannot be used with starts");const n=Object.assign({},t);Object.keys(t).forEach(s=>{delete t[s]}),t.keywords=n.keywords,t.begin=Mt(n.beforeMatch,ts(n.begin)),t.starts={relevance:0,contains:[Object.assign(n,{endsParent:!0})]},t.relevance=0,delete n.beforeMatch},Bl=["of","and","for","in","not","or","if","then","parent","list","value"],jl="keyword";function is(t,e,n=jl){const s=Object.create(null);return typeof t=="string"?r(n,t.split(" ")):Array.isArray(t)?r(n,t):Object.keys(t).forEach(function(o){Object.assign(s,is(t[o],e,o))}),s;function r(o,i){e&&(i=i.map(a=>a.toLowerCase())),i.forEach(function(a){const l=a.split("|");s[l[0]]=[o,Fl(l[0],l[1])]})}}function Fl(t,e){return e?Number(e):zl(t)?0:1}function zl(t){return Bl.includes(t.toLowerCase())}const hn={},bt=t=>{console.error(t)},fn=(t,...e)=>{console.log(`WARN: ${t}`,...e)},kt=(t,e)=>{hn[`${t}/${e}`]||(console.log(`Deprecated as of ${t}. ${e}`),hn[`${t}/${e}`]=!0)},Kt=new Error;function as(t,e,{key:n}){let s=0;const r=t[n],o={},i={};for(let a=1;a<=e.length;a++)i[a+s]=r[a],o[a+s]=!0,s+=es(e[a-1]);t[n]=i,t[n]._emit=o,t[n]._multi=!0}function Ul(t){if(Array.isArray(t.begin)){if(t.skip||t.excludeBegin||t.returnBegin)throw bt("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),Kt;if(typeof t.beginScope!="object"||t.beginScope===null)throw bt("beginScope must be object"),Kt;as(t,t.begin,{key:"beginScope"}),t.begin=_e(t.begin,{joinWith:""})}}function Wl(t){if(Array.isArray(t.end)){if(t.skip||t.excludeEnd||t.returnEnd)throw bt("skip, excludeEnd, returnEnd not compatible with endScope: {}"),Kt;if(typeof t.endScope!="object"||t.endScope===null)throw bt("endScope must be object"),Kt;as(t,t.end,{key:"endScope"}),t.end=_e(t.end,{joinWith:""})}}function Vl(t){t.scope&&typeof t.scope=="object"&&t.scope!==null&&(t.beginScope=t.scope,delete t.scope)}function Kl(t){Vl(t),typeof t.beginScope=="string"&&(t.beginScope={_wrap:t.beginScope}),typeof t.endScope=="string"&&(t.endScope={_wrap:t.endScope}),Ul(t),Wl(t)}function ql(t){function e(i,a){return new RegExp(Lt(i),"m"+(t.case_insensitive?"i":"")+(t.unicodeRegex?"u":"")+(a?"g":""))}class n{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(a,l){l.position=this.position++,this.matchIndexes[this.matchAt]=l,this.regexes.push([l,a]),this.matchAt+=es(a)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const a=this.regexes.map(l=>l[1]);this.matcherRe=e(_e(a,{joinWith:"|"}),!0),this.lastIndex=0}exec(a){this.matcherRe.lastIndex=this.lastIndex;const l=this.matcherRe.exec(a);if(!l)return null;const c=l.findIndex((u,p)=>p>0&&u!==void 0),d=this.matchIndexes[c];return l.splice(0,c),Object.assign(l,d)}}class s{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(a){if(this.multiRegexes[a])return this.multiRegexes[a];const l=new n;return this.rules.slice(a).forEach(([c,d])=>l.addRule(c,d)),l.compile(),this.multiRegexes[a]=l,l}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(a,l){this.rules.push([a,l]),l.type==="begin"&&this.count++}exec(a){const l=this.getMatcher(this.regexIndex);l.lastIndex=this.lastIndex;let c=l.exec(a);if(this.resumingScanAtSamePosition()&&!(c&&c.index===this.lastIndex)){const d=this.getMatcher(0);d.lastIndex=this.lastIndex+1,c=d.exec(a)}return c&&(this.regexIndex+=c.position+1,this.regexIndex===this.count&&this.considerAll()),c}}function r(i){const a=new s;return i.contains.forEach(l=>a.addRule(l.begin,{rule:l,type:"begin"})),i.terminatorEnd&&a.addRule(i.terminatorEnd,{type:"end"}),i.illegal&&a.addRule(i.illegal,{type:"illegal"}),a}function o(i,a){const l=i;if(i.isCompiled)return l;[Rl,$l,Kl,Dl].forEach(d=>d(i,a)),t.compilerExtensions.forEach(d=>d(i,a)),i.__beforeBegin=null,[Nl,Il,Hl].forEach(d=>d(i,a)),i.isCompiled=!0;let c=null;return typeof i.keywords=="object"&&i.keywords.$pattern&&(i.keywords=Object.assign({},i.keywords),c=i.keywords.$pattern,delete i.keywords.$pattern),c=c||/\w+/,i.keywords&&(i.keywords=is(i.keywords,t.case_insensitive)),l.keywordPatternRe=e(c,!0),a&&(i.begin||(i.begin=/\B|\b/),l.beginRe=e(l.begin),!i.end&&!i.endsWithParent&&(i.end=/\B|\b/),i.end&&(l.endRe=e(l.end)),l.terminatorEnd=Lt(l.end)||"",i.endsWithParent&&a.terminatorEnd&&(l.terminatorEnd+=(i.end?"|":"")+a.terminatorEnd)),i.illegal&&(l.illegalRe=e(i.illegal)),i.contains||(i.contains=[]),i.contains=[].concat(...i.contains.map(function(d){return Gl(d==="self"?i:d)})),i.contains.forEach(function(d){o(d,l)}),i.starts&&o(i.starts,a),l.matcher=r(l),l}if(t.compilerExtensions||(t.compilerExtensions=[]),t.contains&&t.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return t.classNameAliases=ct(t.classNameAliases||{}),o(t)}function ls(t){return t?t.endsWithParent||ls(t.starts):!1}function Gl(t){return t.variants&&!t.cachedVariants&&(t.cachedVariants=t.variants.map(function(e){return ct(t,{variants:null},e)})),t.cachedVariants?t.cachedVariants:ls(t)?ct(t,{starts:t.starts?ct(t.starts):null}):Object.isFrozen(t)?ct(t):t}var Ql="11.10.0";class Jl extends Error{constructor(e,n){super(e),this.name="HTMLInjectionError",this.html=n}}const ue=Zn,mn=ct,gn=Symbol("nomatch"),Xl=7,cs=function(t){const e=Object.create(null),n=Object.create(null),s=[];let r=!0;const o="Could not find the language '{}', did you forget to load/include a language module?",i={disableAutodetect:!0,name:"Plain text",contains:[]};let a={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:cl};function l(b){return a.noHighlightRe.test(b)}function c(b){let E=b.className+" ";E+=b.parentNode?b.parentNode.className:"";const P=a.languageDetectRe.exec(E);if(P){const N=W(P[1]);return N||(fn(o.replace("{}",P[1])),fn("Falling back to no-highlight mode for this block.",b)),N?P[1]:"no-highlight"}return E.split(/\s+/).find(N=>l(N)||W(N))}function d(b,E,P){let N="",H="";typeof E=="object"?(N=b,P=E.ignoreIllegals,H=E.language):(kt("10.7.0","highlight(lang, code, ...args) has been deprecated."),kt("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),H=b,N=E),P===void 0&&(P=!0);const tt={code:N,language:H};ht("before:highlight",tt);const et=tt.result?tt.result:u(tt.language,tt.code,P);return et.code=tt.code,ht("after:highlight",et),et}function u(b,E,P,N){const H=Object.create(null);function tt(v,S){return v.keywords[S]}function et(){if(!O.keywords){Q.addText(D);return}let v=0;O.keywordPatternRe.lastIndex=0;let S=O.keywordPatternRe.exec(D),_="";for(;S;){_+=D.substring(v,S.index);const I=rt.case_insensitive?S[0].toLowerCase():S[0],X=tt(O,I);if(X){const[it,gs]=X;if(Q.addText(_),_="",H[I]=(H[I]||0)+1,H[I]<=Xl&&(It+=gs),it.startsWith("_"))_+=S[0];else{const ys=rt.classNameAliases[it]||it;st(S[0],ys)}}else _+=S[0];v=O.keywordPatternRe.lastIndex,S=O.keywordPatternRe.exec(D)}_+=D.substring(v),Q.addText(_)}function Et(){if(D==="")return;let v=null;if(typeof O.subLanguage=="string"){if(!e[O.subLanguage]){Q.addText(D);return}v=u(O.subLanguage,D,!0,De[O.subLanguage]),De[O.subLanguage]=v._top}else v=h(D,O.subLanguage.length?O.subLanguage:null);O.relevance>0&&(It+=v.relevance),Q.__addSublanguage(v._emitter,v.language)}function G(){O.subLanguage!=null?Et():et(),D=""}function st(v,S){v!==""&&(Q.startScope(S),Q.addText(v),Q.endScope())}function Ne(v,S){let _=1;const I=S.length-1;for(;_<=I;){if(!v._emit[_]){_++;continue}const X=rt.classNameAliases[v[_]]||v[_],it=S[_];X?st(it,X):(D=it,et(),D=""),_++}}function Ie(v,S){return v.scope&&typeof v.scope=="string"&&Q.openNode(rt.classNameAliases[v.scope]||v.scope),v.beginScope&&(v.beginScope._wrap?(st(D,rt.classNameAliases[v.beginScope._wrap]||v.beginScope._wrap),D=""):v.beginScope._multi&&(Ne(v.beginScope,S),D="")),O=Object.create(v,{parent:{value:O}}),O}function $e(v,S,_){let I=hl(v.endRe,_);if(I){if(v["on:end"]){const X=new un(v);v["on:end"](S,X),X.isMatchIgnored&&(I=!1)}if(I){for(;v.endsParent&&v.parent;)v=v.parent;return v}}if(v.endsWithParent)return $e(v.parent,S,_)}function ds(v){return O.matcher.regexIndex===0?(D+=v[0],1):(se=!0,0)}function ps(v){const S=v[0],_=v.rule,I=new un(_),X=[_.__beforeBegin,_["on:begin"]];for(const it of X)if(it&&(it(v,I),I.isMatchIgnored))return ds(S);return _.skip?D+=S:(_.excludeBegin&&(D+=S),G(),!_.returnBegin&&!_.excludeBegin&&(D=S)),Ie(_,v),_.returnBegin?0:S.length}function hs(v){const S=v[0],_=E.substring(v.index),I=$e(O,v,_);if(!I)return gn;const X=O;O.endScope&&O.endScope._wrap?(G(),st(S,O.endScope._wrap)):O.endScope&&O.endScope._multi?(G(),Ne(O.endScope,v)):X.skip?D+=S:(X.returnEnd||X.excludeEnd||(D+=S),G(),X.excludeEnd&&(D=S));do O.scope&&Q.closeNode(),!O.skip&&!O.subLanguage&&(It+=O.relevance),O=O.parent;while(O!==I.parent);return I.starts&&Ie(I.starts,v),X.returnEnd?0:S.length}function fs(){const v=[];for(let S=O;S!==rt;S=S.parent)S.scope&&v.unshift(S.scope);v.forEach(S=>Q.openNode(S))}let Nt={};function He(v,S){const _=S&&S[0];if(D+=v,_==null)return G(),0;if(Nt.type==="begin"&&S.type==="end"&&Nt.index===S.index&&_===""){if(D+=E.slice(S.index,S.index+1),!r){const I=new Error(`0 width match regex (${b})`);throw I.languageName=b,I.badRule=Nt.rule,I}return 1}if(Nt=S,S.type==="begin")return ps(S);if(S.type==="illegal"&&!P){const I=new Error('Illegal lexeme "'+_+'" for mode "'+(O.scope||"<unnamed>")+'"');throw I.mode=O,I}else if(S.type==="end"){const I=hs(S);if(I!==gn)return I}if(S.type==="illegal"&&_==="")return 1;if(ne>1e5&&ne>S.index*3)throw new Error("potential infinite loop, way more iterations than matches");return D+=_,_.length}const rt=W(b);if(!rt)throw bt(o.replace("{}",b)),new Error('Unknown language: "'+b+'"');const ms=ql(rt);let ee="",O=N||ms;const De={},Q=new a.__emitter(a);fs();let D="",It=0,ft=0,ne=0,se=!1;try{if(rt.__emitTokens)rt.__emitTokens(E,Q);else{for(O.matcher.considerAll();;){ne++,se?se=!1:O.matcher.considerAll(),O.matcher.lastIndex=ft;const v=O.matcher.exec(E);if(!v)break;const S=E.substring(ft,v.index),_=He(S,v);ft=v.index+_}He(E.substring(ft))}return Q.finalize(),ee=Q.toHTML(),{language:b,value:ee,relevance:It,illegal:!1,_emitter:Q,_top:O}}catch(v){if(v.message&&v.message.includes("Illegal"))return{language:b,value:ue(E),illegal:!0,relevance:0,_illegalBy:{message:v.message,index:ft,context:E.slice(ft-100,ft+100),mode:v.mode,resultSoFar:ee},_emitter:Q};if(r)return{language:b,value:ue(E),illegal:!1,relevance:0,errorRaised:v,_emitter:Q,_top:O};throw v}}function p(b){const E={value:ue(b),illegal:!1,relevance:0,_top:i,_emitter:new a.__emitter(a)};return E._emitter.addText(b),E}function h(b,E){E=E||a.languages||Object.keys(e);const P=p(b),N=E.filter(W).filter(ot).map(G=>u(G,b,!1));N.unshift(P);const H=N.sort((G,st)=>{if(G.relevance!==st.relevance)return st.relevance-G.relevance;if(G.language&&st.language){if(W(G.language).supersetOf===st.language)return 1;if(W(st.language).supersetOf===G.language)return-1}return 0}),[tt,et]=H,Et=tt;return Et.secondBest=et,Et}function y(b,E,P){const N=E&&n[E]||P;b.classList.add("hljs"),b.classList.add(`language-${N}`)}function m(b){let E=null;const P=c(b);if(l(P))return;if(ht("before:highlightElement",{el:b,language:P}),b.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",b);return}if(b.children.length>0&&(a.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(b)),a.throwUnescapedHTML))throw new Jl("One of your code blocks includes unescaped HTML.",b.innerHTML);E=b;const N=E.textContent,H=P?d(N,{language:P,ignoreIllegals:!0}):h(N);b.innerHTML=H.value,b.dataset.highlighted="yes",y(b,P,H.language),b.result={language:H.language,re:H.relevance,relevance:H.relevance},H.secondBest&&(b.secondBest={language:H.secondBest.language,relevance:H.secondBest.relevance}),ht("after:highlightElement",{el:b,result:H,text:N})}function f(b){a=mn(a,b)}const g=()=>{k(),kt("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function x(){k(),kt("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let w=!1;function k(){if(document.readyState==="loading"){w=!0;return}document.querySelectorAll(a.cssSelector).forEach(m)}function C(){w&&k()}typeof window<"u"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",C,!1);function T(b,E){let P=null;try{P=E(t)}catch(N){if(bt("Language definition for '{}' could not be registered.".replace("{}",b)),r)bt(N);else throw N;P=i}P.name||(P.name=b),e[b]=P,P.rawDefinition=E.bind(null,t),P.aliases&&lt(P.aliases,{languageName:b})}function R(b){delete e[b];for(const E of Object.keys(n))n[E]===b&&delete n[E]}function A(){return Object.keys(e)}function W(b){return b=(b||"").toLowerCase(),e[b]||e[n[b]]}function lt(b,{languageName:E}){typeof b=="string"&&(b=[b]),b.forEach(P=>{n[P.toLowerCase()]=E})}function ot(b){const E=W(b);return E&&!E.disableAutodetect}function B(b){b["before:highlightBlock"]&&!b["before:highlightElement"]&&(b["before:highlightElement"]=E=>{b["before:highlightBlock"](Object.assign({block:E.el},E))}),b["after:highlightBlock"]&&!b["after:highlightElement"]&&(b["after:highlightElement"]=E=>{b["after:highlightBlock"](Object.assign({block:E.el},E))})}function Z(b){B(b),s.push(b)}function pt(b){const E=s.indexOf(b);E!==-1&&s.splice(E,1)}function ht(b,E){const P=b;s.forEach(function(N){N[P]&&N[P](E)})}function Rt(b){return kt("10.7.0","highlightBlock will be removed entirely in v12.0"),kt("10.7.0","Please use highlightElement now."),m(b)}Object.assign(t,{highlight:d,highlightAuto:h,highlightAll:k,highlightElement:m,highlightBlock:Rt,configure:f,initHighlighting:g,initHighlightingOnLoad:x,registerLanguage:T,unregisterLanguage:R,listLanguages:A,getLanguage:W,registerAliases:lt,autoDetection:ot,inherit:mn,addPlugin:Z,removePlugin:pt}),t.debugMode=function(){r=!1},t.safeMode=function(){r=!0},t.versionString=Ql,t.regex={concat:Mt,lookahead:ts,either:Pe,optional:dl,anyNumberOfTimes:ul};for(const b in Ft)typeof Ft[b]=="object"&&Yn(Ft[b]);return Object.assign(t,Ft),t},Tt=cs({});Tt.newInstance=()=>cs({});var Yl=Tt;Tt.HighlightJS=Tt;Tt.default=Tt;var Zl=ol(Yl);function us(t,e=[]){return t.map(n=>{const s=[...e,...n.properties?n.properties.className:[]];return n.children?us(n.children,s):{text:n.value,classes:s}}).flat()}function yn(t){return t.value||t.children||[]}function tc(t){return!!Zl.getLanguage(t)}function bn({doc:t,name:e,lowlight:n,defaultLanguage:s}){const r=[];return pe(t,o=>o.type.name===e).forEach(o=>{var i;let a=o.pos+1;const l=o.node.attrs.language||s,c=n.listLanguages(),d=l&&(c.includes(l)||tc(l)||!((i=n.registered)===null||i===void 0)&&i.call(n,l))?yn(n.highlight(l,o.node.textContent)):yn(n.highlightAuto(o.node.textContent));us(d).forEach(u=>{const p=a+u.text.length;if(u.classes.length){const h=ye.inline(a,p,{class:u.classes.join(" ")});r.push(h)}a=p})}),be.create(t,r)}function ec(t){return typeof t=="function"}function nc({name:t,lowlight:e,defaultLanguage:n}){if(!["highlight","highlightAuto","listLanguages"].every(r=>ec(e[r])))throw Error("You should provide an instance of lowlight to use the code-block-lowlight extension");const s=new q({key:new J("lowlight"),state:{init:(r,{doc:o})=>bn({doc:o,name:t,lowlight:e,defaultLanguage:n}),apply:(r,o,i,a)=>{const l=i.selection.$head.parent.type.name,c=a.selection.$head.parent.type.name,d=pe(i.doc,p=>p.type.name===t),u=pe(a.doc,p=>p.type.name===t);return r.docChanged&&([l,c].includes(t)||u.length!==d.length||r.steps.some(p=>p.from!==void 0&&p.to!==void 0&&d.some(h=>h.pos>=p.from&&h.pos+h.node.nodeSize<=p.to)))?bn({doc:r.doc,name:t,lowlight:e,defaultLanguage:n}):o.map(r.mapping,r.doc)}},props:{decorations(r){return s.getState(r)}}});return s}const Fc=Jn.extend({addOptions(){var t;return{...(t=this.parent)===null||t===void 0?void 0:t.call(this),lowlight:{},languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},addProseMirrorPlugins(){var t;return[...((t=this.parent)===null||t===void 0?void 0:t.call(this))||[],nc({name:this.name,lowlight:this.options.lowlight,defaultLanguage:this.options.defaultLanguage})]}});export{bc as B,Fc as C,Ii as D,vc as E,Ec as F,fa as G,Fa as H,Bc as I,Ac as L,jc as M,Sc as N,Oc as P,xc as R,Dc as S,Tc as T,Pc as U,Hc as Y,_i as a,kc as b,Cc as c,Wi as d,Vi as e,Lc as f,Ca as g,Rc as h,$c as i,Ic as j,Nc as k,_c as l,$ as m,Ui as n,Mc as o,wc as u};
